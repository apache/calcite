<?xml version="1.0" ?>
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<Root>
    <TestCase name="testAggregateCaseToFilter">
        <Resource name="sql">
            <![CDATA[select
 sum(sal) as sum_sal,
 count(distinct case
       when job = 'CLERK'
       then deptno else null end) as count_distinct_clerk,
 sum(case when deptno = 10 then sal end) as sum_sal_d10,
 sum(case when deptno = 20 then sal else 0 end) as sum_sal_d20,
 sum(case when deptno = 30 then 1 else 0 end) as count_d30,
 count(case when deptno = 40 then 'x' end) as count_d40,
 count(case when deptno = 20 then 1 end) as count_d20
from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], SUM_SAL=[SUM(_0)], COUNT_DISTINCT_CLERK=[COUNT(DISTINCT _1)], SUM_SAL_D10=[SUM(_2)], SUM_SAL_D20=[SUM(_3)], COUNT_D30=[SUM(_4)], COUNT_D40=[COUNT(_5)], COUNT_D20=[COUNT(_6)])
  LogicalProject(SAL=[_5], _f1=[CASE(=(_2, 'CLERK'), _7, null:INTEGER)], _f2=[CASE(=(_7, 10), _5, null:INTEGER)], _f3=[CASE(=(_7, 20), _5, 0)], _f4=[CASE(=(_7, 30), 1, 0)], _f5=[CASE(=(_7, 40), 'x', null:CHAR(1))], _f6=[CASE(=(_7, 20), 1, null:INTEGER)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SUM_SAL=[_0], COUNT_DISTINCT_CLERK=[_1], SUM_SAL_D10=[_2], SUM_SAL_D20=[_3], COUNT_D30=[CAST(_4):INTEGER], COUNT_D40=[_5], COUNT_D20=[_6])
  LogicalAggregate(group=[{}], SUM_SAL=[SUM(_0)], COUNT_DISTINCT_CLERK=[COUNT(DISTINCT _7) FILTER _8], SUM_SAL_D10=[SUM(_9) FILTER _10], SUM_SAL_D20=[SUM(_11) FILTER _12], COUNT_D30=[COUNT() FILTER _13], COUNT_D40=[COUNT() FILTER _14], COUNT_D20=[COUNT() FILTER _15])
    LogicalProject(SAL=[_5], _f1=[CASE(=(_2, 'CLERK'), _7, null:INTEGER)], _f2=[CASE(=(_7, 10), _5, null:INTEGER)], _f3=[CASE(=(_7, 20), _5, 0)], _f4=[CASE(=(_7, 30), 1, 0)], _f5=[CASE(=(_7, 40), 'x', null:CHAR(1))], _f6=[CASE(=(_7, 20), 1, null:INTEGER)], DEPTNO=[_7], _f8=[=(_2, 'CLERK')], SAL0=[_5], _f10=[=(_7, 10)], SAL1=[_5], _f12=[=(_7, 20)], _f13=[=(_7, 30)], _f14=[=(_7, 40)], _f15=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateExtractProjectRule">
        <Resource name="sql">
            <![CDATA[select sum(sal)
from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_5)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
  LogicalProject(SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateExtractProjectRuleWithFilter">
        <Resource name="sql">
            <![CDATA[select sum(sal) filter (where empno = 40)
from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0) FILTER _1])
  LogicalProject(SAL=[_5], _f1=[=(_0, 40)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateExtractProjectRuleWithGroupingSets">
        <Resource name="sql">
            <![CDATA[select empno, deptno, sum(sal)
from emp
group by grouping sets ((empno, deptno),(deptno),(empno))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 7}], groups=[[{0, 7}, {0}, {7}]], EXPR_2=[SUM(_5)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 2}], groups=[[{0, 2}, {0}, {2}]], EXPR_2=[SUM(_1)])
  LogicalProject(EMPNO=[_0], SAL=[_5], DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateExtractProjectRuleWithGroupingSets2">
        <Resource name="sql">
            <![CDATA[select empno, deptno, sum(empno)
from emp
group by grouping sets ((empno, deptno),(deptno),(empno))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 7}], groups=[[{0, 7}, {0}, {7}]], EXPR_2=[SUM(_0)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {1}]], EXPR_2=[SUM(_0)])
  LogicalProject(EMPNO=[_0], DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceNot">
        <Resource name="sql">
            <![CDATA[select *
from (select (case when sal > 1000 then null else false end) as caseCol from emp)
where NOT(caseCol)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(CASECOL=[_0])
  LogicalFilter(condition=[NOT(_0)])
    LogicalProject(CASECOL=[CASE(>(_5, 1000), null, false)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(CASECOL=[_0])
  LogicalFilter(condition=[NOT(_0)])
    LogicalProject(CASECOL=[AND(>(_5, 1000), null)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceNestedCaseWhen">
        <Resource name="sql">
            <![CDATA[select sal
from emp
where case when (sal = 1000) then
(case when sal = 1000 then null else 1 end is null) else
(case when sal = 2000 then null else 1 end is null) end is true]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[OR(=(_5, 1000), AND(=(_5, 2000), <>(_5, 1000)))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[IS TRUE(CASE(=(_5, 1000), IS NULL(CASE(=(_5, 1000), null:INTEGER, 1)), IS NULL(CASE(=(_5, 2000), null:INTEGER, 1))))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceOrCaseWhen">
        <Resource name="sql">
            <![CDATA[select sal
from emp
where case when sal = 1000 then null else 1 end is null
OR case when sal = 2000 then null else 1 end is null]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[OR(=(_5, 1000), =(_5, 2000))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[OR(IS NULL(CASE(=(_5, 1000), null:INTEGER, 1)), IS NULL(CASE(=(_5, 2000), null:INTEGER, 1)))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceNullableCase">
        <Resource name="sql">
            <![CDATA[SELECT CASE WHEN 1=2 THEN cast((values(1)) as integer) ELSE 2 end from (values(1))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(2):INTEGER])
  LogicalJoin(condition=[true], joinType=[left])
    LogicalValues(tuples=[[{ 1 }]])
    LogicalValues(tuples=[[{ 1 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(2):INTEGER])
  LogicalJoin(condition=[true], joinType=[left])
    LogicalValues(tuples=[[{ 1 }]])
    LogicalValues(tuples=[[{ 1 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWindowInParenthesis">
        <Resource name="sql">
            <![CDATA[select count(*) over (w), count(*) over w
from emp
window w as (partition by empno order by empno)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_9], EXPR_1=[_9])
  LogicalWindow(window#0=[window(partition {0} order by [0] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT()])])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[COUNT() OVER (PARTITION BY _0 ORDER BY _0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], EXPR_1=[COUNT() OVER (PARTITION BY _0 ORDER BY _0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testIsNullPushDown">
        <Resource name="sql">
            <![CDATA[select empno, deptno, w_count from (
  select empno, deptno, count(empno) over (w) w_count
  from emp
  window w as (partition by deptno order by empno)
) sub_query where w_count is null]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], DEPTNO=[_1], W_COUNT=[_2])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], DEPTNO=[_1], W_COUNT=[_2])
  LogicalFilter(condition=[IS NULL(_2)])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], _2=[_9])
      LogicalWindow(window#0=[window(partition {7} order by [0] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT(_0)])])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testIsNullPushDown2">
        <Resource name="sql">
            <![CDATA[select empno, deptno, w_count from (
  select empno, deptno, count(empno) over (ROWS BETWEEN 10 PRECEDING AND 1 PRECEDING) w_count
  from emp
) sub_query where w_count is null]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], DEPTNO=[_1], W_COUNT=[_2])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], DEPTNO=[_1], W_COUNT=[_2])
  LogicalFilter(condition=[IS NULL(_2)])
    LogicalWindow(window#0=[window(partition {} order by [] rows between _2 PRECEDING and _3 PRECEDING aggs [COUNT(_0)])])
      LogicalProject(EMPNO=[_0], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectToWindowRuleForMultipleWindows">
        <Resource name="sql">
            <![CDATA[select
 count(*) over(partition by empno order by sal) as count1,
 count(*) over(partition by deptno order by sal) as count2,
 sum(deptno) over(partition by empno order by sal) as sum1,
 sum(deptno) over(partition by deptno order by sal) as sum2
from emp]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(_0=[_9], _1=[_11], _2=[_10], _3=[_12])
  LogicalWindow(window#0=[window(partition {0} order by [5] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT(), SUM(_7)])], window#1=[window(partition {7} order by [5] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT(), SUM(_7)])])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(COUNT1=[COUNT() OVER (PARTITION BY _0 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], COUNT2=[COUNT() OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], SUM1=[SUM(_7) OVER (PARTITION BY _0 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], SUM2=[SUM(_7) OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testUnionToDistinctRule">
        <Resource name="sql">
            <![CDATA[select * from dept union select * from dept]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalProject(DEPTNO=[_0], NAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_0], NAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[false])
  LogicalProject(DEPTNO=[_0], NAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(DEPTNO=[_0], NAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testUnionMergeRule">
        <Resource name="sql">
            <![CDATA[select * from (
select * from (
  select name, deptno from dept
  union all
  select name, deptno from
  (
    select name, deptno, count(1) from dept group by name, deptno
    union all
    select name, deptno, count(1) from dept group by name, deptno
  ) subq
) a
union all
select name, deptno from dept
) aa
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(NAME=[_0], DEPTNO=[_1])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
      LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(NAME=[_0], DEPTNO=[_1])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
      LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_0], DEPTNO=[_1])
  LogicalUnion(all=[true])
    LogicalProject(NAME=[_0], DEPTNO=[_1])
      LogicalUnion(all=[true])
        LogicalProject(NAME=[_1], DEPTNO=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(NAME=[_0], DEPTNO=[_1])
          LogicalUnion(all=[true])
            LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
              LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
            LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
              LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMinusMergeRule">
        <Resource name="sql">
            <![CDATA[select * from (
select * from (
  select name, deptno from
  (
    select name, deptno, count(1) from dept group by name, deptno
    except all
    select name, deptno, 1 from dept
  ) subq
  except all
  select name, deptno from
  (
    select name, deptno, 1 from dept
    except all
    select name, deptno, count(1) from dept group by name, deptno
  ) subq2
) a
except all
select name, deptno from dept
) aa
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalMinus(all=[true])
  LogicalProject(NAME=[_0], DEPTNO=[_1])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
      LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(NAME=[_0], DEPTNO=[_1])
    LogicalProject(NAME=[_1], DEPTNO=[_0], EXPR_2=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalMinus(all=[true])
    LogicalProject(NAME=[_0], DEPTNO=[_1])
      LogicalProject(NAME=[_1], DEPTNO=[_0], EXPR_2=[1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_0], DEPTNO=[_1])
      LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
        LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_0], DEPTNO=[_1])
  LogicalMinus(all=[true])
    LogicalProject(NAME=[_0], DEPTNO=[_1])
      LogicalMinus(all=[true])
        LogicalProject(NAME=[_0], DEPTNO=[_1])
          LogicalMinus(all=[true])
            LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
              LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
            LogicalProject(NAME=[_1], DEPTNO=[_0], EXPR_2=[1])
              LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(NAME=[_0], DEPTNO=[_1])
          LogicalMinus(all=[true])
            LogicalProject(NAME=[_1], DEPTNO=[_0], EXPR_2=[1])
              LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
            LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
              LogicalProject(NAME=[_1], DEPTNO=[_0], _f2=[1])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExtractJoinFilterRule">
        <Resource name="sql">
            <![CDATA[select 1 from emp inner join dept on emp.deptno=dept.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[=(_7, _9)])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testNotPushExpression">
        <Resource name="sql">
            <![CDATA[select 1 from emp inner join dept
on emp.deptno=dept.deptno and emp.ename is not null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[AND(=(_7, _9), IS NOT NULL(_1))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[AND(=(_7, _9), IS NOT NULL(_1))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAddRedundantSemiJoinRule">
        <Resource name="sql">
            <![CDATA[select 1 from emp inner join dept on emp.deptno = dept.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
    LogicalJoin(condition=[=(_7, _9)], joinType=[semi])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAll">
        <Resource name="sql">
            <![CDATA[select * from emp e1
  where e1.empno > ALL (select deptno from dept)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[NOT(<= SOME(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
}))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[NOT(CAST(OR(AND(IS TRUE(<=(_0, _9)), <>(_10, 0)), AND(>(_10, _11), null, <>(_10, 0), IS NOT TRUE(<=(_0, _9))), AND(<=(_0, _9), <>(_10, 0), IS NOT TRUE(<=(_0, _9)), <=(_10, _11)))):BOOLEAN NOT NULL)])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{}], m=[MAX(_0)], c=[COUNT()], d=[COUNT(_0)])
          LogicalProject(DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[NOT(CAST(OR(AND(IS TRUE(<=(_0, _9)), <>(_10, 0)), AND(>(_10, _11), null, <>(_10, 0), IS NOT TRUE(<=(_0, _9))), AND(<=(_0, _9), <>(_10, 0), IS NOT TRUE(<=(_0, _9)), <=(_10, _11)))):BOOLEAN NOT NULL)])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{}], m=[MAX(_0)], c=[COUNT()], d=[COUNT(_0)])
          LogicalProject(DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAnyInProjectNonNullable">
        <Resource name="sql">
            <![CDATA[select name, deptno > ANY (
  select deptno from emp)
from dept]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_1], EXPR_1=[> SOME(_0, {
LogicalProject(DEPTNO=[_7])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(NAME=[_1], EXPR_1=[CAST(OR(AND(IS TRUE(>(_0, _2)), <>(_3, 0)), AND(>(_3, _4), null, <>(_3, 0), IS NOT TRUE(>(_0, _2))), AND(>(_0, _2), <>(_3, 0), IS NOT TRUE(>(_0, _2)), <=(_3, _4)))):BOOLEAN NOT NULL])
  LogicalJoin(condition=[true], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{}], m=[MIN(_0)], c=[COUNT()], d=[COUNT(_0)])
      LogicalProject(DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_1], EXPR_1=[CAST(OR(AND(IS TRUE(>(_0, _2)), <>(_3, 0)), AND(>(_3, _4), null, <>(_3, 0), IS NOT TRUE(>(_0, _2))), AND(>(_0, _2), <>(_3, 0), IS NOT TRUE(>(_0, _2)), <=(_3, _4)))):BOOLEAN NOT NULL])
  LogicalJoin(condition=[true], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{}], m=[MIN(_0)], c=[COUNT()], d=[COUNT(_0)])
      LogicalProject(DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAnyInProjectNullable">
        <Resource name="sql">
            <![CDATA[select deptno, name = ANY (
  select mgr from emp)
from dept]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[IN(_1, {
LogicalProject(MGR=[_3])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[OR(AND(IS NOT NULL(_5), <>(_2, 0)), AND(<(_3, _2), null, <>(_2, 0), IS NULL(_5)))])
  LogicalJoin(condition=[=(_1, _4)], joinType=[left])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
        LogicalProject(MGR=[_3])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(MGR=[_3], i=[true])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[OR(AND(IS NOT NULL(_5), <>(_2, 0)), AND(<(_3, _2), null, <>(_2, 0), IS NULL(_5)))])
  LogicalJoin(condition=[=(_1, _4)], joinType=[left])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
        LogicalProject(MGR=[_3])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(MGR=[_3], i=[true])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCasePushIsAlwaysWorking">
        <Resource name="sql">
            <![CDATA[select empno from emp where case when sal > 1000 then empno else sal end = 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[=(CASE(>(_5, 1000), _0, _5), 1)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(AND(>(_5, 1000), =(_0, 1)), =(_5, 1))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCorrelationScalarAggAndFilter">
        <Resource name="sql">
            <![CDATA[SELECT e1.empno
FROM emp e1, dept d1 where e1.deptno = d1.deptno
and e1.deptno < 10 and d1.deptno < 15
and e1.sal > (select avg(sal) from emp e2 where e1.empno = e2.empno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[AND(=(_0, _4), >(_1, _5))], joinType=[inner])
    LogicalJoin(condition=[=(_2, _3)], joinType=[inner])
      LogicalFilter(condition=[<(_2, 10)])
        LogicalProject(EMPNO=[_0], SAL=[_5], DEPTNO=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[<(_0, 15)])
        LogicalProject(DEPTNO=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0}], EXPR_0=[AVG(_1)])
      LogicalProject(EMPNO=[_0], SAL=[_5])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCustomDecorrelate">
        <Resource name="Comparing Plans from LogicalCorrelate and CustomCorrelate">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10], EMPNO0=[CAST(_11):INTEGER], EXPR_0=[CAST(_12):INTEGER])
    LogicalJoin(condition=[AND(=(_0, _11), >(_5, _12))], joinType=[inner])
      LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
        LogicalFilter(condition=[<(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalFilter(condition=[<(_0, 15)])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalAggregate(group=[{0}], EXPR_0=[AVG(_1)])
        LogicalProject(EMPNO=[_0], SAL=[_5])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateExists">
        <Resource name="sql">
            <![CDATA[select * from sales.emp
where EXISTS (
  select * from emp e where emp.deptno = e.deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[EXISTS({
LogicalFilter(condition=[=(_cor0.DEPTNO, _7)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], _f1=[true])
      LogicalAggregate(group=[{0}])
        LogicalProject(DEPTNO=[_7], i=[true])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}])
        LogicalProject(i=[true])
          LogicalFilter(condition=[=(_cor0.DEPTNO, _7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateTwoExists">
        <Resource name="sql">
            <![CDATA[select * from sales.emp
where EXISTS (
  select * from emp e where emp.deptno = e.deptno)
AND NOT EXISTS (
  select * from emp ee where ee.job = emp.job AND ee.sal=34)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[AND(EXISTS({
LogicalFilter(condition=[=(_cor0.DEPTNO, _7)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), NOT(EXISTS({
LogicalFilter(condition=[AND(=(_2, _cor0.JOB), =(_5, 34))])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[IS NULL(_10)])
      LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{2}])
        LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{7}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{0}])
            LogicalProject(i=[true])
              LogicalFilter(condition=[=(_cor0.DEPTNO, _7)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}])
          LogicalProject(i=[true])
            LogicalFilter(condition=[AND(=(_2, _cor0.JOB), =(_5, 34))])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[IS NULL(_12)])
    LogicalJoin(condition=[=(_2, _11)], joinType=[left])
      LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_0], _f1=[true])
          LogicalAggregate(group=[{0}])
            LogicalProject(DEPTNO=[_7], i=[true])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(JOB=[_0], _f1=[true])
        LogicalAggregate(group=[{0}])
          LogicalProject(JOB=[_2], i=[true])
            LogicalFilter(condition=[=(_5, 34)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateUncorrelatedInAndCorrelatedExists">
        <Resource name="sql">
            <![CDATA[select * from sales.emp
WHERE job in (
  select job from emp ee where ee.sal=34)AND EXISTS (
  select * from emp e where emp.deptno = e.deptno)
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[AND(IN(_2, {
LogicalProject(JOB=[_2])
  LogicalFilter(condition=[=(_5, 34)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), EXISTS({
LogicalFilter(condition=[=(_cor0.DEPTNO, _7)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{7}])
      LogicalJoin(condition=[=(_2, _9)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}])
          LogicalProject(JOB=[_2])
            LogicalFilter(condition=[=(_5, 34)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}])
        LogicalProject(i=[true])
          LogicalFilter(condition=[=(_cor0.DEPTNO, _7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalJoin(condition=[=(_7, _10)], joinType=[inner])
    LogicalJoin(condition=[=(_2, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}])
        LogicalProject(JOB=[_2])
          LogicalFilter(condition=[=(_5, 34)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], _f1=[true])
      LogicalAggregate(group=[{0}])
        LogicalProject(DEPTNO=[_7], i=[true])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateTwoIn">
        <Resource name="sql">
            <![CDATA[select sal
from sales.emp
where empno IN (
  select deptno from dept where emp.job = dept.name)
AND empno IN (
  select empno from emp e where emp.ename = e.ename)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[AND(IN(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[=(_cor0.JOB, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
}), IN(_0, {
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[=(_cor0.ENAME, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_0, _10)])
      LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{1}])
        LogicalFilter(condition=[=(_0, _9)])
          LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{2}])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
            LogicalProject(DEPTNO=[_0])
              LogicalFilter(condition=[=(_cor0.JOB, _1)])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(EMPNO=[_0])
          LogicalFilter(condition=[=(_cor0.ENAME, _1)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[AND(=(_1, _12), =(_0, _11))], joinType=[inner])
    LogicalJoin(condition=[AND(=(_2, _10), =(_0, _9))], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(EMPNO=[_0], ENAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateTwoScalar">
        <Resource name="sql">
            <![CDATA[select deptno,
  (select min(1) from emp where empno > d.deptno) as i0,
  (select min(0) from emp
    where deptno = d.deptno and ename = 'SMITH') as i1
from dept as d]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], I0=[$SCALAR_QUERY({
LogicalAggregate(group=[{}], EXPR_0=[MIN(_0)])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[>(_0, _cor0.DEPTNO)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], I1=[$SCALAR_QUERY({
LogicalAggregate(group=[{}], EXPR_0=[MIN(_0)])
  LogicalProject(_f0=[0])
    LogicalFilter(condition=[AND(=(_7, _cor1.DEPTNO), =(_1, 'SMITH'))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(DEPTNO=[_0], I0=[_2], I1=[_3])
  LogicalJoin(condition=[true], joinType=[left])
    LogicalJoin(condition=[true], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalAggregate(group=[{}], EXPR_0=[MIN(_0)])
        LogicalProject(_f0=[1])
          LogicalFilter(condition=[>(_0, _cor0.DEPTNO)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{}], EXPR_0=[MIN(_0)])
      LogicalProject(_f0=[0])
        LogicalFilter(condition=[AND(=(_7, _cor1.DEPTNO), =(_1, 'SMITH'))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCount3">
        <Resource name="sql">
            <![CDATA[select count(distinct deptno), sum(sal) from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_2])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT(DISTINCT _0)], EXPR_1=[SUM(_1)])
    LogicalProject(DEPTNO=[_7], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_2])
  LogicalProject(DEPTNO=[_0], EXPR_0=[_1], EXPR_1=[CAST(_2):INTEGER NOT NULL])
    LogicalAggregate(group=[{0}], EXPR_0=[COUNT(_0) FILTER _2], EXPR_1=[MIN(_1) FILTER _2])
      LogicalProject(DEPTNO=[_0], EXPR_1=[_1], $g_0=[=(_2, 0)])
        LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], $g=[GROUPING(_0)])
          LogicalProject(DEPTNO=[_7], SAL=[_5])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctNonDistinctAggregatesWithGrouping1">
        <Resource name="sql">
            <![CDATA[SELECT deptno,
  SUM(deptno), SUM(DISTINCT sal), MAX(deptno), MAX(comm)
FROM emp
GROUP BY deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_0)], EXPR_2=[SUM(DISTINCT _1)], EXPR_3=[MAX(_0)], EXPR_4=[MAX(_2)])
  LogicalProject(DEPTNO=[_7], SAL=[_5], COMM=[_6])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_2)], EXPR_2=[SUM(_1)], EXPR_3=[MAX(_3)], EXPR_4=[MAX(_4)])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[SUM(_0)], EXPR_3=[MAX(_0)], EXPR_4=[MAX(_2)])
    LogicalProject(DEPTNO=[_7], SAL=[_5], COMM=[_6])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctNonDistinctAggregatesWithGrouping2">
        <Resource name="sql">
            <![CDATA[SELECT deptno, COUNT(deptno), SUM(DISTINCT sal)
FROM emp
GROUP BY deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT()], EXPR_2=[SUM(DISTINCT _1)])
  LogicalProject(DEPTNO=[_7], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[$SUM0(_2)], EXPR_2=[SUM(_1)])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[COUNT()])
    LogicalProject(DEPTNO=[_7], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctNonDistinctTwoAggregatesWithGrouping">
        <Resource name="sql">
            <![CDATA[SELECT deptno, SUM(comm), MIN(comm), SUM(DISTINCT sal)
FROM emp
GROUP BY deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)], EXPR_3=[SUM(DISTINCT _2)])
  LogicalProject(DEPTNO=[_7], COMM=[_6], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_2)], EXPR_2=[MIN(_3)], EXPR_3=[SUM(_1)])
  LogicalAggregate(group=[{0, 2}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)])
    LogicalProject(DEPTNO=[_7], COMM=[_6], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctWithGrouping">
        <Resource name="sql">
            <![CDATA[SELECT sal, SUM(comm), MIN(comm), SUM(DISTINCT sal)
FROM emp
GROUP BY sal]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)], EXPR_3=[SUM(DISTINCT _0)])
  LogicalProject(SAL=[_5], COMM=[_6])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_2)], EXPR_3=[SUM(_0)])
  LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)])
    LogicalProject(SAL=[_5], COMM=[_6])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testRemoveDistinctOnAgg">
        <Resource name="sql">
            <![CDATA[SELECT empno, SUM(distinct sal), MIN(sal), MIN(distinct sal), MAX(distinct sal), bit_and(distinct sal), bit_or(sal), count(distinct sal) from sales.emp group by empno, deptno
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_2], EXPR_2=[_3], EXPR_3=[_3], EXPR_4=[_4], EXPR_5=[_5], EXPR_6=[_6], EXPR_7=[_7])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[SUM(DISTINCT _2)], EXPR_2=[MIN(_2)], EXPR_4=[MAX(_2)], EXPR_5=[BIT_AND(_2)], EXPR_6=[BIT_OR(_2)], EXPR_7=[COUNT(DISTINCT _2)])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_5], EXPR_2=[_5], EXPR_3=[_5], EXPR_4=[_5], EXPR_5=[_5], EXPR_6=[_5], EXPR_7=[1:BIGINT])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMultipleDistinctWithGrouping">
        <Resource name="sql">
            <![CDATA[SELECT sal, SUM(comm), AVG(DISTINCT comm), SUM(DISTINCT sal)
FROM emp
GROUP BY sal]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[AVG(DISTINCT _1)], EXPR_3=[SUM(DISTINCT _0)])
  LogicalProject(SAL=[_5], COMM=[_6])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_0], EXPR_1=[_1], EXPR_2=[_3], EXPR_3=[_5])
  LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _4)], joinType=[inner])
    LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _2)], joinType=[inner])
      LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
        LogicalProject(SAL=[_5], COMM=[_6])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}], EXPR_2=[AVG(_1)])
        LogicalAggregate(group=[{0, 1}])
          LogicalProject(SAL=[_5], COMM=[_6])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_3=[SUM(_0)])
      LogicalAggregate(group=[{0}])
        LogicalProject(SAL=[_0])
          LogicalProject(SAL=[_5], COMM=[_6])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctWithMultipleInputs">
        <Resource name="sql">
            <![CDATA[SELECT deptno, SUM(comm), MIN(comm), COUNT(DISTINCT sal, comm)
FROM emp
GROUP BY deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)], EXPR_3=[COUNT(DISTINCT _2, _1)])
  LogicalProject(DEPTNO=[_7], COMM=[_6], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_3)], EXPR_2=[MIN(_4)], EXPR_3=[COUNT(_2, _1)])
  LogicalAggregate(group=[{0, 1, 2}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)])
    LogicalProject(DEPTNO=[_7], COMM=[_6], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctWithMultipleInputsAndGroupby">
        <Resource name="sql">
            <![CDATA[SELECT deptno, SUM(comm), MIN(comm), COUNT(DISTINCT sal, deptno, comm)
FROM emp
GROUP BY deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)], EXPR_3=[COUNT(DISTINCT _2, _0, _1)])
  LogicalProject(DEPTNO=[_7], COMM=[_6], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_3)], EXPR_2=[MIN(_4)], EXPR_3=[COUNT(_2, _0, _1)])
  LogicalAggregate(group=[{0, 1, 2}], EXPR_1=[SUM(_1)], EXPR_2=[MIN(_1)])
    LogicalProject(DEPTNO=[_7], COMM=[_6], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyAggregate">
        <Resource name="sql">
            <![CDATA[select sum(empno) from emp where false group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1])
  LogicalAggregate(group=[{0}], EXPR_0=[SUM(_1)])
    LogicalValues(tuples=[[]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyAggregateEmptyKey">
        <Resource name="sql">
            <![CDATA[select sum(empno) from emp where false]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyAggregateEmptyKeyWithAggregateValuesRule">
        <Resource name="sql">
            <![CDATA[select count(*), sum(empno) from emp where false]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()], EXPR_1=[SUM(_0)])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[{ 0, null }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyIntersect">
        <Resource name="sql">
            <![CDATA[select * from (values (30, 3))intersect
select *
from (values (10, 1), (30, 3)) as t (x, y) where x > 50
intersect
select * from (values (30, 3))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalIntersect(all=[false])
  LogicalIntersect(all=[false])
    LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
      LogicalValues(tuples=[[{ 30, 3 }]])
    LogicalProject(X=[_0], Y=[_1])
      LogicalFilter(condition=[>(_0, 50)])
        LogicalValues(tuples=[[{ 10, 1 }, { 30, 3 }]])
  LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
    LogicalValues(tuples=[[{ 30, 3 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterThroughOuterJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d left outer join sales.emp e on d.deptno = e.deptno where d.name = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
ProjectRel(EXPR_0=[1])
  FilterRel(condition=[=(_1, 'Charlie')])
    JoinRel(condition=[=(_0, _9)], joinType=[left])
      TableAccessRel(table=[[CATALOG, SALES, DEPT]])
      TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(EXPR_0=[1])
  JoinRel(condition=[=(_0, _9)], joinType=[left])
    FilterRel(condition=[=(_1, 'Charlie')])
      TableAccessRel(table=[[CATALOG, SALES, DEPT]])
    TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinReduceConstants">
        <Resource name="sql">
            <![CDATA[select e1.sal
from (select * from emp where deptno = 200) as e1
where e1.deptno in (
  select e2.deptno from emp e2 where e2.sal = 100)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_0])
  LogicalJoin(condition=[=(_1, _2)], joinType=[semi])
    LogicalFilter(condition=[=(_1, 200)])
      LogicalProject(SAL=[_5], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_1])
      LogicalFilter(condition=[=(_0, 100)])
        LogicalProject(SAL=[_5], DEPTNO=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_0])
  LogicalJoin(condition=[=(200, _2)], joinType=[semi])
    LogicalFilter(condition=[=(_1, 200)])
      LogicalProject(SAL=[_5], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_1])
      LogicalFilter(condition=[=(_0, 100)])
        LogicalProject(SAL=[_5], DEPTNO=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFullOuterJoinSimplificationToLeftOuter">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d full outer join sales.emp e
on d.deptno = e.deptno
where d.name = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[=(_1, 'Charlie')])
    LogicalJoin(condition=[=(_0, _9)], joinType=[full])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalProject(DEPTNO=[CAST(_0):INTEGER], NAME=[CAST(_1):VARCHAR(10)], EMPNO=[_2], ENAME=[_3], JOB=[_4], MGR=[_5], HIREDATE=[_6], SAL=[_7], COMM=[_8], DEPTNO0=[_9], SLACKER=[_10])
    LogicalJoin(condition=[=(_0, _9)], joinType=[left])
      LogicalFilter(condition=[=(_1, 'Charlie')])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFullOuterJoinSimplificationToRightOuter">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d full outer join sales.emp e
on d.deptno = e.deptno
where e.sal > 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[>(_7, 100)])
    LogicalJoin(condition=[=(_0, _9)], joinType=[full])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[CAST(_2):INTEGER], ENAME=[CAST(_3):VARCHAR(20)], JOB=[CAST(_4):VARCHAR(10)], MGR=[_5], HIREDATE=[CAST(_6):TIMESTAMP(0)], SAL=[CAST(_7):INTEGER], COMM=[CAST(_8):INTEGER], DEPTNO0=[CAST(_9):INTEGER], SLACKER=[CAST(_10):BOOLEAN])
    LogicalJoin(condition=[=(_0, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalFilter(condition=[>(_5, 100)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFullOuterJoinSimplificationToInner">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d full outer join sales.emp e
on d.deptno = e.deptno
where d.name = 'Charlie' and e.sal > 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[AND(=(_1, 'Charlie'), >(_7, 100))])
    LogicalJoin(condition=[=(_0, _9)], joinType=[full])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalProject(DEPTNO=[CAST(_0):INTEGER], NAME=[CAST(_1):VARCHAR(10)], EMPNO=[CAST(_2):INTEGER], ENAME=[CAST(_3):VARCHAR(20)], JOB=[CAST(_4):VARCHAR(10)], MGR=[_5], HIREDATE=[CAST(_6):TIMESTAMP(0)], SAL=[CAST(_7):INTEGER], COMM=[CAST(_8):INTEGER], DEPTNO0=[CAST(_9):INTEGER], SLACKER=[CAST(_10):BOOLEAN])
    LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
      LogicalFilter(condition=[=(_1, 'Charlie')])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalFilter(condition=[>(_5, 100)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testLeftOuterJoinSimplificationToInner">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d left outer join sales.emp e
on d.deptno = e.deptno
where e.sal > 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[>(_7, 100)])
    LogicalJoin(condition=[=(_0, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[CAST(_2):INTEGER], ENAME=[CAST(_3):VARCHAR(20)], JOB=[CAST(_4):VARCHAR(10)], MGR=[_5], HIREDATE=[CAST(_6):TIMESTAMP(0)], SAL=[CAST(_7):INTEGER], COMM=[CAST(_8):INTEGER], DEPTNO0=[CAST(_9):INTEGER], SLACKER=[CAST(_10):BOOLEAN])
    LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalFilter(condition=[>(_5, 100)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testRightOuterJoinSimplificationToInner">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d right outer join sales.emp e
on d.deptno = e.deptno
where d.name = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[=(_1, 'Charlie')])
    LogicalJoin(condition=[=(_0, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalProject(DEPTNO=[CAST(_0):INTEGER], NAME=[CAST(_1):VARCHAR(10)], EMPNO=[_2], ENAME=[_3], JOB=[_4], MGR=[_5], HIREDATE=[_6], SAL=[_7], COMM=[_8], DEPTNO0=[_9], SLACKER=[_10])
    LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
      LogicalFilter(condition=[=(_1, 'Charlie')])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterThroughSemiJoin">
        <Resource name="sql">
            <![CDATA[select * from (
  select * from dept where dept.deptno in (
    select emp.deptno from emp))R
where R.deptno <=10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1])
  LogicalFilter(condition=[<=(_0, 10)])
    LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalFilter(condition=[<=(_0, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastAgg">
        <Resource name="sql">
            <![CDATA[select dname, c from
(select name dname, count(*) as c from dept group by name) t
 where dname = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DNAME=[_0], C=[_1])
  LogicalFilter(condition=[=(_0, 'Charlie')])
    LogicalAggregate(group=[{0}], C=[COUNT()])
      LogicalProject(DNAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DNAME=[_0], C=[_1])
  LogicalAggregate(group=[{0}], C=[COUNT()])
    LogicalFilter(condition=[=(_0, 'Charlie')])
      LogicalProject(DNAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastAggWithGroupingSets1">
        <Resource name="sql">
            <![CDATA[select ddeptno, dname, c from
             (select deptno ddeptno, name dname, count(*) as c
             from dept group by rollup(deptno,name)) t
              where dname = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DDEPTNO=[_0], DNAME=[_1], C=[_2])
  LogicalProject(DDEPTNO=[_0], DNAME=[_1], C=[_2])
    LogicalFilter(condition=[=(_1, 'Charlie')])
      LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], C=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DDEPTNO=[_0], DNAME=[_1], C=[_2])
  LogicalProject(DDEPTNO=[CASE(_2, null, _0)], DNAME=[CASE(_3, null, _1)], C=[_4])
    LogicalFilter(condition=[=(CASE(_3, null, _1), 'Charlie')])
      LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], indicator=[true], C=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastAggWithGroupingSets2">
        <Resource name="sql">
            <![CDATA[select dname, ddeptno, c from
             (select name dname, deptno ddeptno, count(*) as c
             from dept group by grouping sets ((name,deptno),(name))) t
              where dname = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DNAME=[_0], DDEPTNO=[_1], C=[_2])
  LogicalFilter(condition=[=(_0, 'Charlie')])
    LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}]], C=[COUNT()])
      LogicalProject(DNAME=[_1], DDEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DNAME=[_0], DDEPTNO=[_1], C=[_2])
  LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}]], C=[COUNT()])
    LogicalFilter(condition=[=(_0, 'Charlie')])
      LogicalProject(DNAME=[_1], DDEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceAverage">
        <Resource name="sql">
            <![CDATA[select name, max(name), avg(deptno), min(name)
from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_0)], EXPR_2=[AVG(_1)], EXPR_3=[MIN(_0)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], EXPR_2=[CAST(/(_2, _3)):INTEGER NOT NULL], EXPR_3=[_4])
  LogicalAggregate(group=[{0}], EXPR_1=[MAX(_0)], agg#1=[$SUM0(_1)], agg#2=[COUNT()], EXPR_3=[MIN(_0)])
    LogicalProject(NAME=[_1], DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastFilter">
        <Resource name="sql">
            <![CDATA[select empno + deptno from emp where sal = 10 * comm
and upper(ename) = 'FOO']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_0, _7)])
  LogicalFilter(condition=[AND(=(_5, *(10, _6)), =(UPPER(_1), 'FOO'))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[+(_0, _4)])
  LogicalFilter(condition=[AND(=(_2, *(10, _3)), =(UPPER(_1), 'FOO'))])
    LogicalProject(EMPNO=[_0], ENAME=[_1], SAL=[_5], COMM=[_6], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastJoin">
        <Resource name="sql">
            <![CDATA[select e.sal + b.comm from emp e inner join bonus b
on e.ename = b.ename and e.deptno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_5, _12)])
  LogicalJoin(condition=[AND(=(_1, _9), =(_7, 10))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[+(_1, _4)])
  LogicalJoin(condition=[AND(=(_0, _3), _2)], joinType=[inner])
    LogicalProject(ENAME=[_1], SAL=[_5], ==[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ENAME=[_0], COMM=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastInnerJoinStrong">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from emp e inner join bonus b on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), *(-1, _5), _5)])
      LogicalJoin(condition=[=(_1, _9)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_1])
      LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), *(-1, _5), _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastInnerJoin">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e inner join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), 11, *(-1, _5))])
      LogicalJoin(condition=[=(_1, _9)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_1])
      LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), 11, *(-1, _5))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastLeftJoin">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e left outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), 11, *(-1, _5))])
      LogicalJoin(condition=[=(_1, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_1])
      LogicalJoin(condition=[=(_0, _2)], joinType=[left])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), 11, *(-1, _5))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastLeftJoinSwap">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from bonus b left outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_9, 11), 11, *(-1, _9))])
      LogicalJoin(condition=[=(_5, _0)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(_2, 11, _3)])
      LogicalJoin(condition=[=(_1, _0)], joinType=[left])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalProject(ENAME=[_1], <=[<(_5, 11)], *=[*(-1, _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastLeftJoinSwapStrong">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from bonus b left outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_9, 11), *(-1, _9), _9)])
      LogicalJoin(condition=[=(_5, _0)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_2])
      LogicalJoin(condition=[=(_1, _0)], joinType=[left])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), *(-1, _5), _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastLeftJoinStrong">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
            from bonus b left outer join emp e on e.ename = b.ename group by
            case when e.sal < 11 then -1 * e.sal else e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_9, 11), *(-1, _9), _9)])
      LogicalJoin(condition=[=(_5, _0)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_2])
      LogicalJoin(condition=[=(_1, _0)], joinType=[left])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), *(-1, _5), _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastRightJoin">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e right outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), 11, *(-1, _5))])
      LogicalJoin(condition=[=(_1, _9)], joinType=[right])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(_1, 11, _2)])
      LogicalJoin(condition=[=(_0, _3)], joinType=[right])
        LogicalProject(ENAME=[_1], <=[<(_5, 11)], *=[*(-1, _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastRightJoinStrong">
        <Resource name="sql">
            <![CDATA[select count(*),
 case when e.sal < 11 then -1 * e.sal else e.sal end
from emp e right outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), *(-1, _5), _5)])
      LogicalJoin(condition=[=(_1, _9)], joinType=[right])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_1])
      LogicalJoin(condition=[=(_0, _2)], joinType=[right])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), *(-1, _5), _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastRightJoinSwap">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from bonus b right outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_9, 11), 11, *(-1, _9))])
      LogicalJoin(condition=[=(_5, _0)], joinType=[right])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_2])
      LogicalJoin(condition=[=(_1, _0)], joinType=[right])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), 11, *(-1, _5))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastRightJoinSwapStrong">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from bonus b right outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_9, 11), *(-1, _9), _9)])
      LogicalJoin(condition=[=(_5, _0)], joinType=[right])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_2])
      LogicalJoin(condition=[=(_1, _0)], joinType=[right])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), *(-1, _5), _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastFullJoin">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e full outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), 11, *(-1, _5))])
      LogicalJoin(condition=[=(_1, _9)], joinType=[full])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(_1, 11, _2)])
      LogicalJoin(condition=[=(_0, _3)], joinType=[full])
        LogicalProject(ENAME=[_1], <=[<(_5, 11)], *=[*(-1, _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastFullJoinStrong">
        <Resource name="sql">
            <![CDATA[select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from emp e full outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[CASE(<(_5, 11), *(-1, _5), _5)])
      LogicalJoin(condition=[=(_1, _9)], joinType=[full])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_0])
  LogicalAggregate(group=[{0}], EXPR_0=[COUNT()])
    LogicalProject(EXPR_1=[_1])
      LogicalJoin(condition=[=(_0, _2)], joinType=[full])
        LogicalProject(ENAME=[_1], CASE=[CASE(<(_5, 11), *(-1, _5), _5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(ENAME=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectWithOverPastJoin1">
        <Resource name="sql">
            <![CDATA[select e.sal + b.comm,
count(e.empno) over (partition by e.deptno)
from emp e join bonus b
on e.ename = b.ename and e.deptno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_5, _12)], EXPR_1=[COUNT(_0) OVER (PARTITION BY _7 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalJoin(condition=[AND(=(_1, _9), =(_7, 10))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[+(_2, _6)], EXPR_1=[COUNT(_0) OVER (PARTITION BY _3 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalJoin(condition=[AND(=(_1, _5), _4)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], SAL=[_5], DEPTNO=[_7], ==[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ENAME=[_0], COMM=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectWithOverPastJoin2">
        <Resource name="sql">
            <![CDATA[select e.sal + b.comm,
count(b.sal) over (partition by b.job)
from emp e join bonus b
on e.ename = b.ename and e.deptno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_5, _12)], EXPR_1=[COUNT(_11) OVER (PARTITION BY _10 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalJoin(condition=[AND(=(_1, _9), =(_7, 10))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[+(_1, _6)], EXPR_1=[COUNT(_5) OVER (PARTITION BY _4 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalJoin(condition=[AND(=(_0, _3), _2)], joinType=[inner])
    LogicalProject(ENAME=[_1], SAL=[_5], ==[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ENAME=[_0], JOB=[_1], SAL=[_2], COMM=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectWithOverPastJoin3">
        <Resource name="sql">
            <![CDATA[select e.sal + b.comm,
sum(b.sal + b.sal + 100) over (partition by b.job)
from emp e join bonus b
on e.ename = b.ename and e.deptno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_5, _12)], EXPR_1=[SUM(+(+(_11, _11), 100)) OVER (PARTITION BY _10 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalJoin(condition=[AND(=(_1, _9), =(_7, 10))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[+(_1, _5)], EXPR_1=[SUM(_6) OVER (PARTITION BY _4 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalJoin(condition=[AND(=(_0, _3), _2)], joinType=[inner])
    LogicalProject(ENAME=[_1], SAL=[_5], ==[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ENAME=[_0], JOB=[_1], COMM=[_3], +=[+(+(_2, _2), 100)])
      LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastSetOp">
        <Resource name="sql">
            <![CDATA[select sal from
(select * from emp e1 union all select * from emp e2)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalUnion(all=[true])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(SAL=[_5])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(SAL=[_5])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushJoinThroughUnionOnLeft">
        <Resource name="sql">
            <![CDATA[select r1.sal from
(select * from emp e1 union all select * from emp e2) r1,
emp r2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[true], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalUnion(all=[true])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushJoinThroughUnionOnRight">
        <Resource name="sql">
            <![CDATA[select r1.sal from
emp r1,
(select * from emp e1 union all select * from emp e2) r2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[true], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalUnion(all=[true])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushJoinThroughUnionOnRightDoesNotMatchSemiJoin">
        <Resource name="sql">
            <![CDATA[select r1.sal from emp r1 where r1.deptno in (select deptno from dept d1 where deptno > 100 union all select deptno from dept d2 where deptno > 20)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[=(_7, _8)], joinType=[semi])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[>(_0, 100)])
          LogicalTableScan(table=[[scott, DEPT]])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[>(_0, 20)])
          LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[=(_7, _8)], joinType=[semi])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[>(_0, 100)])
          LogicalTableScan(table=[[scott, DEPT]])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[>(_0, 20)])
          LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushJoinThroughUnionOnRightDoesNotMatchAntiJoin">
        <Resource name="sql">
            <![CDATA[select r1.sal from emp r1 where r1.deptno not in (select deptno from dept d1 where deptno < 10 union all select deptno from dept d2 where deptno > 20)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[=(_7, _8)], joinType=[anti])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[<(_0, 10)])
          LogicalTableScan(table=[[scott, DEPT]])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[>(_0, 20)])
          LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[=(_7, _8)], joinType=[anti])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[<(_0, 10)])
          LogicalTableScan(table=[[scott, DEPT]])
      LogicalProject(DEPTNO=[_0])
        LogicalFilter(condition=[>(_0, 20)])
          LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstants">
        <Resource name="sql">
            <![CDATA[select 1+2, d.deptno+(3+4), (5+6)+d.deptno, cast(null as integer), coalesce(2,null), row(7+8) from dept d inner join emp e on d.deptno = e.deptno + (5-5) where d.deptno=(7+8) and d.deptno=(8+7) and d.deptno=coalesce(2,null)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(1, 2)], EXPR_1=[+(_0, +(3, 4))], EXPR_2=[+(+(5, 6), _0)], EXPR_3=[null:INTEGER], EXPR_4=[CASE(IS NOT NULL(2), 2, null:INTEGER)], EXPR_5=[ROW(+(7, 8))])
  LogicalFilter(condition=[AND(=(_0, +(7, 8)), =(_0, +(8, 7)), =(_0, CASE(IS NOT NULL(2), 2, null:INTEGER)))])
    LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[_2], ENAME=[_3], JOB=[_4], MGR=[_5], HIREDATE=[_6], SAL=[_7], COMM=[_8], DEPTNO0=[_9], SLACKER=[_10])
      LogicalJoin(condition=[=(_0, _11)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, -(5, 5))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[3], EXPR_1=[22], EXPR_2=[26], EXPR_3=[null:INTEGER], EXPR_4=[CAST(2):INTEGER], EXPR_5=[ROW(15)])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDup">
        <Resource name="sql">
            <![CDATA[select d.deptno from dept d where d.deptno=7 and d.deptno=8]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[AND(=(_0, 7), =(_0, 8))])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDup3">
        <Resource name="sql">
            <![CDATA[select d.deptno from dept d where d.deptno<>7 or d.deptno<>8]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[OR(<>(_0, 7), <>(_0, 8))])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDup3Null">
        <Resource name="sql">
            <![CDATA[select e.empno from emp e where e.mgr<>7 or e.mgr<>8]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(<>(_3, 7), <>(_3, 8))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_3)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDupNot">
        <Resource name="sql">
            <![CDATA[select d.deptno from dept d where not(d.deptno=7 and d.deptno=8)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[NOT(AND(=(_0, 7), =(_0, 8)))])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDupNotNull">
        <Resource name="sql">
            <![CDATA[select e.empno from emp e where not(e.mgr=7 and e.mgr=8)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[NOT(AND(=(_3, 7), =(_3, 8)))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_3)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDupNot2">
        <Resource name="sql">
            <![CDATA[select d.deptno from dept d where not(d.deptno=7 and d.name='foo' and d.deptno=8)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[NOT(AND(=(_0, 7), =(_1, 'foo'), =(_0, 8)))])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDupNot2Null">
        <Resource name="sql">
            <![CDATA[select e.empno from emp e where not(e.mgr=7 and e.deptno=8 and e.mgr=8)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[NOT(AND(=(_3, 7), =(_7, 8), =(_3, 8)))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(IS NOT NULL(_3), <>(_7, 8))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsEliminatesFilter">
        <Resource name="sql">
            <![CDATA[select * from (values (1,2)) where 1 + 2 > 3 + CAST(NULL AS INTEGER)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
  LogicalFilter(condition=[>(+(1, 2), +(3, null))])
    LogicalValues(tuples=[[{ 1, 2 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAlreadyFalseEliminatesFilter">
        <Resource name="sql">
            <![CDATA[select * from (values (1,2)) where false]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
  LogicalFilter(condition=[false])
    LogicalValues(tuples=[[{ 1, 2 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyMinus">
        <Resource name="sql">
            <![CDATA[select * from (values (30, 3)) as t (x, y)
where x > 30
except
select * from (values (20, 2))
except
select * from (values (40, 4))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalMinus(all=[false])
  LogicalMinus(all=[false])
    LogicalProject(X=[_0], Y=[_1])
      LogicalFilter(condition=[>(_0, 30)])
        LogicalValues(tuples=[[{ 30, 3 }]])
    LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
      LogicalValues(tuples=[[{ 20, 2 }]])
  LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
    LogicalValues(tuples=[[{ 40, 4 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyMinus2">
        <Resource name="sql">
            <![CDATA[select * from (values (30, 3)) as t (x, y)
except
select * from (values (20, 2)) as t (x, y) where x > 30
except
select * from (values (40, 4))
except
select * from (values (50, 5)) as t (x, y) where x > 50]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalMinus(all=[false])
  LogicalMinus(all=[false])
    LogicalMinus(all=[false])
      LogicalProject(X=[_0], Y=[_1])
        LogicalValues(tuples=[[{ 30, 3 }]])
      LogicalProject(X=[_0], Y=[_1])
        LogicalFilter(condition=[>(_0, 30)])
          LogicalValues(tuples=[[{ 20, 2 }]])
    LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
      LogicalValues(tuples=[[{ 40, 4 }]])
  LogicalProject(X=[_0], Y=[_1])
    LogicalFilter(condition=[>(_0, 50)])
      LogicalValues(tuples=[[{ 50, 5 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalMinus(all=[false])
  LogicalProject(X=[_0], Y=[_1])
    LogicalValues(tuples=[[{ 30, 3 }]])
  LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
    LogicalValues(tuples=[[{ 40, 4 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyProject">
        <Resource name="sql">
            <![CDATA[select z + x from (
  select x + y as z, x from (
    select * from (values (10, 1), (30, 3)) as t (x, y)
    where x + y > 50))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(+(_0, _1), _0)])
  LogicalFilter(condition=[>(+(_0, _1), 50)])
    LogicalValues(tuples=[[{ 10, 1 }, { 30, 3 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyProject2">
        <Resource name="sql">
            <![CDATA[select z + x from (
  select x + y as z, x from (
    select * from (values (10, 1), (30, 3)) as t (x, y)
    where x + y > 50))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(+(_0, _1), _0)])
  LogicalFilter(condition=[>(+(_0, _1), 50)])
    LogicalValues(tuples=[[{ 10, 1 }, { 30, 3 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceValuesUnderFilter">
        <Resource name="sql">
            <![CDATA[select a, b from (values (10, 'x'), (20, 'y')) as t(a, b) where a < 15]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(A=[_0], B=[_1])
  LogicalFilter(condition=[<(_0, 15)])
    LogicalValues(tuples=[[{ 10, 'x' }, { 20, 'y' }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(A=[_0], B=[_1])
  LogicalValues(tuples=[[{ 10, 'x' }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceValuesUnderProject">
        <Resource name="sql">
            <![CDATA[select a + b from (values (10, 1), (20, 3)) as t(a, b)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_0, _1)])
  LogicalValues(tuples=[[{ 10, 1 }, { 20, 3 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[{ 11 }, { 23 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceValuesUnderProjectFilter">
        <Resource name="sql">
            <![CDATA[select a + b as x, b, a
from (values (10, 1), (30, 7), (20, 3)) as t(a, b)
where a - b < 21]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(X=[+(_0, _1)], B=[_1], A=[_0])
  LogicalFilter(condition=[<(-(_0, _1), 21)])
    LogicalValues(tuples=[[{ 10, 1 }, { 30, 7 }, { 20, 3 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[{ 11, 1, 10 }, { 23, 3, 20 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceValuesNull">
        <Resource name="sql">
            <![CDATA[insert into EMPNULLABLES(EMPNO, ENAME, JOB) (select 0, 'null', NULL)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalTableModify(table=[[CATALOG, SALES, EMPNULLABLES]], operation=[INSERT], flattened=[false])
  LogicalProject(EMPNO=[0], ENAME=['null'], JOB=[null:VARCHAR(10)], MGR=[null:INTEGER], HIREDATE=[null:TIMESTAMP(0)], SAL=[null:INTEGER], COMM=[null:INTEGER], DEPTNO=[null:INTEGER], SLACKER=[null:BOOLEAN])
    LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalTableModify(table=[[CATALOG, SALES, EMPNULLABLES]], operation=[INSERT], flattened=[false])
  LogicalValues(tuples=[[{ 0, 'null', null, null, null, null, null, null, null }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceValuesToEmpty">
        <Resource name="sql">
            <![CDATA[select a + b as x, b, a from (values (10, 1), (30, 7)) as t(a, b)
where a - b < 0]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(X=[+(_0, _1)], B=[_1], A=[_0])
  LogicalFilter(condition=[<(-(_0, _1), 0)])
    LogicalValues(tuples=[[{ 10, 1 }, { 30, 7 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyFilterProjectUnion">
        <Resource name="sql">
            <![CDATA[select * from (
select * from (values (10, 1), (30, 3)) as t (x, y)
union all
select * from (values (20, 2))
)
where x + y > 30]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(X=[_0], Y=[_1])
  LogicalFilter(condition=[>(+(_0, _1), 30)])
    LogicalUnion(all=[true])
      LogicalProject(X=[_0], Y=[_1])
        LogicalValues(tuples=[[{ 10, 1 }, { 30, 3 }]])
      LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
        LogicalValues(tuples=[[{ 20, 2 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(X=[_0], Y=[_1])
  LogicalValues(tuples=[[{ 30, 3 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCasts">
        <Resource name="sql">
            <![CDATA[select cast(d.name as varchar(128)), cast(e.empno as integer)
from dept as d inner join emp as e
on cast(d.deptno as integer) = cast(e.deptno as integer)
where cast(e.job as varchar(1)) = 'Manager']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(_1):VARCHAR(128) NOT NULL], EXPR_1=[_2])
  LogicalFilter(condition=[=(CAST(CAST(_4):VARCHAR(1) NOT NULL):VARCHAR(7) NOT NULL, 'Manager')])
    LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[_3], ENAME=[_4], JOB=[_5], MGR=[_6], HIREDATE=[_7], SAL=[_8], COMM=[_9], DEPTNO1=[_10], SLACKER=[_11])
      LogicalJoin(condition=[=(_2, _12)], joinType=[inner])
        LogicalProject(DEPTNO=[_0], NAME=[_1], DEPTNO0=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(_1):VARCHAR(128) NOT NULL], EXPR_1=[_2])
  LogicalFilter(condition=[=(CAST(CAST(_4):VARCHAR(1) NOT NULL):VARCHAR(7) NOT NULL, 'Manager')])
    LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[_3], ENAME=[_4], JOB=[_5], MGR=[_6], HIREDATE=[_7], SAL=[_8], COMM=[_9], DEPTNO1=[_10], SLACKER=[_11])
      LogicalJoin(condition=[=(_2, _12)], joinType=[inner])
        LogicalProject(DEPTNO=[_0], NAME=[_1], DEPTNO0=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,sum(empno),count(*) from (select * from emp as e1 union all select * from emp as e2) group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
AggregateRel(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[COUNT()])
  ProjectRel(ENAME=[_1], EMPNO=[_0])
    UnionRel(all=[true])
      ProjectRel(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        TableAccessRel(table=[[CATALOG, SALES, EMP]])
      ProjectRel(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(ENAME=[_0], EXPR_1=[_1], EXPR_2=[CAST(_2):BIGINT NOT NULL])
  AggregateRel(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[SUM(_2)])
    UnionRel(all=[true])
      AggregateRel(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[COUNT()])
        ProjectRel(ENAME=[_1], EMPNO=[_0])
          ProjectRel(EMPNO=[_0], ENAME=[_1])
            ProjectRel(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
              TableAccessRel(table=[[CATALOG, SALES, EMP]])
      AggregateRel(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[COUNT()])
        ProjectRel(ENAME=[_1], EMPNO=[_0])
          ProjectRel(EMPNO=[_0], ENAME=[_1])
            ProjectRel(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
              TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCastAndConsts">
        <Resource name="sql">
            <![CDATA[select * from emp
where cast((empno + (10/2)) as int) = 13]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[=(CAST(+(_0, /(10, 2))):INTEGER NOT NULL, 13)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[=(+(_0, 5), 13)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsCalc">
        <Resource name="sql">
            <![CDATA[select * from (
  select upper(substring(x FROM 1 FOR 2) || substring(x FROM 3)) as u,
      substring(x FROM 1 FOR 1) as s
  from (
    select 'table' as x from (values (true))
    union
    select 'view' from (values (true))
    union
    select 'foreign table' from (values (true))
  )
) where u = 'TABLE']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(U=[_0], S=[_1])
  LogicalFilter(condition=[=(_0, 'TABLE')])
    LogicalProject(U=[UPPER(||(SUBSTRING(_0, 1, 2), SUBSTRING(_0, 3)))], S=[SUBSTRING(_0, 1, 1)])
      LogicalUnion(all=[false])
        LogicalUnion(all=[false])
          LogicalProject(X=['table'])
            LogicalValues(tuples=[[{ true }]])
          LogicalProject(EXPR_0=['view'])
            LogicalValues(tuples=[[{ true }]])
        LogicalProject(EXPR_0=['foreign table'])
          LogicalValues(tuples=[[{ true }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalCalc(expr#0=[{inputs}], expr#1=['TABLE        ':VARCHAR(26)], expr#2=['t':VARCHAR(13)], U=[_t1], S=[_t2])
  LogicalValues(tuples=[[{ true }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstants2">
        <Resource name="sql">
            <![CDATA[select p1 is not distinct from p0
from (values (2, cast(null as integer))) as t(p0, p1)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[false])
  LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[false])
  LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsProjectNullable">
        <Resource name="sql">
            <![CDATA[select mgr from emp where mgr=10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(MGR=[_3])
  LogicalFilter(condition=[=(_3, 10)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(MGR=[CAST(10):INTEGER])
  LogicalFilter(condition=[=(_3, 10)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyJoin">
        <Resource name="sql">
            <![CDATA[select * from (
select * from emp where false) as e
join dept as d on e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[false])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyJoinRight">
        <Resource name="sql">
            <![CDATA[select * from (
  select * from emp where false) e
right join dept d on e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalJoin(condition=[=(_7, _9)], joinType=[right])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[false])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalJoin(condition=[=(_7, _9)], joinType=[right])
    LogicalValues(tuples=[[]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyJoinLeft">
        <Resource name="sql">
            <![CDATA[select * from (
  select * from emp where false) e
left join dept d on e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[false])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptyLimitZero">
        <Resource name="sql">
            <![CDATA[select * from emp order by deptno limit 0]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
SortRel(sort0=[_7], dir0=[Ascending], fetch=[0])
  ProjectRel(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
EmptyRel
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptySort">
        <Resource name="sql">
            <![CDATA[select * from emp where false order by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_7], dir0=[ASC])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[false])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_7], dir0=[ASC])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEmptySortLimitZero">
        <Resource name="sql">
            <![CDATA[select * from emp order by deptno limit 0]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_7], dir0=[ASC], fetch=[0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandWhereComparisonCorrelated">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp as e
where sal = (
  select max(sal) from sales.emp e2 where e2.empno = e.empno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[=(_5, $SCALAR_QUERY({
LogicalAggregate(group=[{}], EXPR_0=[MAX(_0)])
  LogicalProject(SAL=[_5])
    LogicalFilter(condition=[=(_0, _cor0.EMPNO)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_5, _9)])
      LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{0}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{}], EXPR_0=[MAX(_0)])
          LogicalProject(SAL=[_5])
            LogicalFilter(condition=[=(_0, _cor0.EMPNO)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCustomColumnResolvingInNonCorrelatedSubQuery">
        <Resource name="sql">
            <![CDATA[select *
from struct.t t1
where c0 in (
  select f1.c0 from struct.t t2)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
  LogicalFilter(condition=[IN(_4, {
LogicalProject(C0=[_5])
  LogicalTableScan(table=[[CATALOG, STRUCT, T]])
})])
    LogicalTableScan(table=[[CATALOG, STRUCT, T]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
  LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
    LogicalJoin(condition=[=(_4, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, STRUCT, T]])
      LogicalAggregate(group=[{0}])
        LogicalProject(C0=[_5])
          LogicalTableScan(table=[[CATALOG, STRUCT, T]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCustomColumnResolvingInCorrelatedSubQuery">
        <Resource name="sql">
            <![CDATA[select *
from struct.t t1
where c0 = (
  select max(f1.c0) from struct.t t2 where t1.k0 = t2.k0)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
  LogicalFilter(condition=[=(_4, $SCALAR_QUERY({
LogicalAggregate(group=[{}], EXPR_0=[MAX(_0)])
  LogicalProject("F1"."C0"=[_5])
    LogicalFilter(condition=[=(_cor0."K0", _0)])
      LogicalTableScan(table=[[CATALOG, STRUCT, T]])
}))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, STRUCT, T]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
  LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
    LogicalFilter(condition=[=(_4, _9)])
      LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{0}])
        LogicalTableScan(table=[[CATALOG, STRUCT, T]])
        LogicalAggregate(group=[{}], EXPR_0=[MAX(_0)])
          LogicalProject("F1"."C0"=[_5])
            LogicalFilter(condition=[=(_cor0."K0", _0)])
              LogicalTableScan(table=[[CATALOG, STRUCT, T]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCustomColumnResolvingInCorrelatedSubQuery2">
        <Resource name="sql">
            <![CDATA[select *
from struct.t t1
where c0 in (
  select f1.c0 from struct.t t2 where t1.c2 = t2.c2)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
  LogicalFilter(condition=[IN(_4, {
LogicalProject(C0=[_5])
  LogicalFilter(condition=[=(_cor0."F1"."C2", _7)])
    LogicalTableScan(table=[[CATALOG, STRUCT, T]])
})], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, STRUCT, T]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
  LogicalProject("K0"=[_0], "C1"=[_1], "F1"."A0"=[_2], "F2"."A0"=[_3], "F0"."C0"=[_4], "F1"."C0"=[_5], "F0"."C1"=[_6], "F1"."C2"=[_7], "F2"."C3"=[_8])
    LogicalFilter(condition=[=(_4, _9)])
      LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{7}])
        LogicalTableScan(table=[[CATALOG, STRUCT, T]])
        LogicalAggregate(group=[{0}])
          LogicalProject(C0=[_5])
            LogicalFilter(condition=[=(_cor0."F1"."C2", _7)])
              LogicalTableScan(table=[[CATALOG, STRUCT, T]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateAggWithConstantGroupKey">
        <Resource name="sql">
            <![CDATA[SELECT * FROM emp A where sal in
(SELECT max(sal) FROM emp B where A.mgr = B.empno group by deptno, 'abc')]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{3, 5}])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[=(_cor0.SAL, _0)])
      LogicalAggregate(group=[{0}])
        LogicalProject(EXPR_0=[_2])
          LogicalAggregate(group=[{0, 1}], EXPR_0=[MAX(_2)])
            LogicalProject(DEPTNO=[_7], _f1=['abc'], SAL=[_5])
              LogicalFilter(condition=[=(_cor0.MGR, _0)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{3, 5}])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[=(_cor0.SAL, _0)])
      LogicalAggregate(group=[{0}])
        LogicalProject(EXPR_0=[_2])
          LogicalAggregate(group=[{0, 1}], EXPR_0=[MAX(_2)])
            LogicalProject(DEPTNO=[_7], _f1=['abc'], SAL=[_5])
              LogicalFilter(condition=[=(_cor0.MGR, _0)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalJoin(condition=[AND(=(_3, _10), =(_5, _9))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(EXPR_0=[_2], EMPNO=[_1])
        LogicalAggregate(group=[{0, 1}], EXPR_0=[MAX(_3)])
          LogicalProject(DEPTNO=[_7], EMPNO=[_0], _f1=['abc'], SAL=[_5])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateAggWithMultiParamsAggCall">
        <Resource name="sql">
            <![CDATA[SELECT * FROM (SELECT MYAGG(sal, 1) AS c FROM emp) as m,
 LATERAL TABLE(ramp(m.c)) AS T(s)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(C=[_0], S=[_1])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{0}])
    LogicalAggregate(group=[{}], C=[MYAGG(_0, _1)])
      LogicalProject(SAL=[_5], _f1=[1])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableFunctionScan(invocation=[RAMP(_cor0.C)], rowType=[RecordType(INTEGER I)])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(C=[_0], S=[_1])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{0}])
    LogicalAggregate(group=[{}], C=[MYAGG(_0, _1)])
      LogicalProject(SAL=[_5], _f1=[1])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableFunctionScan(invocation=[RAMP(_cor0.C)], rowType=[RecordType(INTEGER I)])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelateAggWithMultiParamsAggCall2">
        <Resource name="sql">
            <![CDATA[SELECT * FROM (SELECT MYAGG(sal, 1) AS c FROM emp group by empno, 'abc') as m,
 LATERAL TABLE(ramp(m.c)) AS T(s)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(C=[_0], S=[_1])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{0}])
    LogicalProject(C=[_2])
      LogicalAggregate(group=[{0, 1}], C=[MYAGG(_2, _3)])
        LogicalProject(EMPNO=[_0], _f1=['abc'], SAL=[_5], _f3=[1])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableFunctionScan(invocation=[RAMP(_cor0.C)], rowType=[RecordType(INTEGER I)])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(C=[_0], S=[_1])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{0}])
    LogicalProject(C=[_2])
      LogicalAggregate(group=[{0, 1}], C=[MYAGG(_2, _3)])
        LogicalProject(EMPNO=[_0], _f1=['abc'], SAL=[_5], _f3=[1])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableFunctionScan(invocation=[RAMP(_cor0.C)], rowType=[RecordType(INTEGER I)])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExtractYearMonthToRange">
        <Resource name="sql">
            <![CDATA[select *
from sales.emp_b as e
where extract(year from birthdate) = 2014and extract(month from birthdate) = 4]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], BIRTHDATE=[_9])
  LogicalFilter(condition=[AND(=(EXTRACT(FLAG(YEAR), _9), 2014), =(EXTRACT(FLAG(MONTH), _9), 4))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP_B]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], BIRTHDATE=[_9])
  LogicalFilter(condition=[AND(>=(_9, 2014-04-01), <(_9, 2014-05-01))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP_B]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExtractYearToRange">
        <Resource name="sql">
            <![CDATA[select *
from sales.emp_b as e
where extract(year from birthdate) = 2014]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], BIRTHDATE=[_9])
  LogicalFilter(condition=[=(EXTRACT(FLAG(YEAR), _9), 2014)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP_B]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], BIRTHDATE=[_9])
  LogicalFilter(condition=[AND(>=(_9, 2014-01-01), <(_9, 2015-01-01))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP_B]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFilterProjectTranspose">
        <Resource name="sql">
            <![CDATA[SELECT e.empno
FROM emp as e
WHERE exists (
  SELECT *
  FROM (
    SELECT deptno * 2 AS twiceDeptno
    FROM dept) AS d
  WHERE e.deptno = d.twiceDeptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_9)])
    LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{}], agg#0=[MIN(_0)])
        LogicalProject(_f0=[true])
          LogicalFilter(condition=[=(_cor0.DEPTNO, _0)])
            LogicalProject(TWICEDEPTNO=[*(_0, 2)])
              LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_9)])
    LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{}], agg#0=[MIN(_0)])
        LogicalProject(_f0=[true])
          LogicalProject(TWICEDEPTNO=[*(_0, 2)])
            LogicalFilter(condition=[=(_cor0.DEPTNO, *(_0, 2))])
              LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFilterProjectTransposePreventedByCorrelation">
        <Resource name="sql">
            <![CDATA[SELECT e.empno
FROM emp as e
WHERE exists (
  SELECT *
  FROM (
    SELECT deptno * 2 AS twiceDeptno
    FROM dept) AS d
  WHERE e.deptno = d.twiceDeptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_9)])
    LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{}], agg#0=[MIN(_0)])
        LogicalProject(_f0=[true])
          LogicalFilter(condition=[=(_cor0.DEPTNO, _0)])
            LogicalProject(TWICEDEPTNO=[*(_0, 2)])
              LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFilterRemoveIsNotDistinctFromRule">
        <Resource name="planBefore">
            <![CDATA[
LogicalFilter(condition=[IS NOT DISTINCT FROM(_7, 20)])
  LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalFilter(condition=[=(_7, 20)])
  LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testInferringPredicatesWithNotOperatorInJoinCondition">
        <Resource name="sql">
            <![CDATA[select * from sales.emp d
join sales.emp e on e.deptno = d.deptno and d.deptno not in (4, 6)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], EMPNO0=[_9], ENAME0=[_10], JOB0=[_11], MGR0=[_12], HIREDATE0=[_13], SAL0=[_14], COMM0=[_15], DEPTNO0=[_16], SLACKER0=[_17])
  LogicalJoin(condition=[AND(=(_16, _7), NOT(OR(=(_7, 4), =(_7, 6))))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], EMPNO0=[_9], ENAME0=[_10], JOB0=[_11], MGR0=[_12], HIREDATE0=[_13], SAL0=[_14], COMM0=[_15], DEPTNO0=[_16], SLACKER0=[_17])
  LogicalJoin(condition=[=(_16, _7)], joinType=[inner])
    LogicalFilter(condition=[AND(<>(_7, 4), <>(_7, 6))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[AND(<>(_7, 4), <>(_7, 6))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testIntersectToDistinct">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
intersect
select * from emp where deptno = 20
intersect
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalIntersect(all=[false])
  LogicalIntersect(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[=(_9, 3)])
    LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
      LogicalUnion(all=[true])
        LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
          LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
            LogicalFilter(condition=[=(_7, 10)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
          LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
            LogicalFilter(condition=[=(_7, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
          LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
            LogicalFilter(condition=[=(_7, 30)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testIntersectToDistinctAll">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
intersect
select * from emp where deptno = 20
intersect all
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalIntersect(all=[true])
  LogicalIntersect(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalIntersect(all=[true])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_9, 2)])
      LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
        LogicalUnion(all=[true])
          LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
            LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
              LogicalFilter(condition=[=(_7, 10)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8}], agg#0=[COUNT()])
            LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
              LogicalFilter(condition=[=(_7, 20)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinPushTransitivePredicatesRule">
        <Resource name="sql">
            <![CDATA[select d.deptno from sales.emp d where d.deptno
IN (select e.deptno from sales.emp e where e.deptno = d.deptno or e.deptno = 4)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{7}])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[=(_cor0.DEPTNO, _0)])
      LogicalAggregate(group=[{0}])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[OR(=(_7, _cor0.DEPTNO), =(_7, 4))])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinPushTransitivePredicatesRule2">
        <Resource name="sql">
            <![CDATA[select n1.SAL
from EMPNULLABLES_20 n1
where n1.SAL IN (
  select n2.SAL
  from EMPNULLABLES_20 n2
  where n1.SAL = n2.SAL or n1.SAL = 4)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[=(_5, _9)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
      LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
        LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
    LogicalFilter(condition=[=(_1, _0)])
      LogicalAggregate(group=[{0, 1}])
        LogicalProject(SAL=[_5], SAL0=[_8])
          LogicalJoin(condition=[OR(=(_8, _5), =(_8, 4))], joinType=[inner])
            LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
              LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
                LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
            LogicalAggregate(group=[{0}])
              LogicalProject(SAL=[_5])
                LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
                  LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[=(_5, _9)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
      LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
        LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
    LogicalFilter(condition=[=(_1, _0)])
      LogicalAggregate(group=[{0, 1}])
        LogicalProject(SAL=[_5], SAL0=[_8])
          LogicalJoin(condition=[OR(=(_8, _5), =(_8, 4))], joinType=[inner])
            LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
              LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
                LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
            LogicalAggregate(group=[{0}])
              LogicalProject(SAL=[_5])
                LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
                  LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeIntersect">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
intersect
select * from emp where deptno = 20
intersect
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalIntersect(all=[false])
  LogicalIntersect(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalIntersect(all=[false])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeMinus">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
except
select * from emp where deptno = 20
except
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalMinus(all=[false])
  LogicalMinus(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalMinus(all=[false])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeMinusRightDeep">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
except
select * from (
  select * from emp where deptno = 20
  except
  select * from emp where deptno = 30)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalMinus(all=[false])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalMinus(all=[false])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_7, 20)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_7, 30)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeSetOpMixed">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
union
select * from emp where deptno = 20
intersect
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[false])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalIntersect(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 30)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeUnion">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
union all
select * from emp where deptno = 20
union all
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalUnion(all=[true])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeUnionAll">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
union all
select * from emp where deptno = 20
union all
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalUnion(all=[true])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeUnionDistinct">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
union distinct
select * from emp where deptno = 20
union
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[false])
  LogicalUnion(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[false])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeUnionMixed">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
union
select * from emp where deptno = 20
union all
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalUnion(all=[false])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeUnionMixed2">
        <Resource name="sql">
            <![CDATA[select * from emp where deptno = 10
union all
select * from emp where deptno = 20
union
select * from emp where deptno = 30
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[false])
  LogicalUnion(all=[true])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_7, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[false])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 20)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_7, 30)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testNestedAggregates">
        <Resource name="sql">
            <![CDATA[SELECT
  avg(sum(sal) + 2 * min(empno) + 3 * avg(empno))
  over (partition by deptno)
from emp
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(/(SUM(+(+(_1, *(2, _2)), *(3, _3))) OVER (PARTITION BY _0 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), COUNT(+(+(_1, *(2, _2)), *(3, _3))) OVER (PARTITION BY _0 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING))):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], agg#0=[SUM(_1)], agg#1=[MIN(_2)], agg#2=[AVG(_2)])
    LogicalProject(DEPTNO=[_7], SAL=[_5], EMPNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(/(_2, _3)):INTEGER NOT NULL])
  LogicalWindow(window#0=[window(partition {0} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [SUM(_1), COUNT(_1)])])
    LogicalProject(DEPTNO=[_0], _1=[+(+(_1, *(2, _2)), *(3, _3))])
      LogicalAggregate(group=[{0}], agg#0=[SUM(_1)], agg#1=[MIN(_2)], agg#2=[AVG(_2)])
        LogicalProject(DEPTNO=[_7], SAL=[_5], EMPNO=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testNoOversimplificationBelowIsNull">
        <Resource name="sql">
            <![CDATA[select * from emp where ( (empno=1 and mgr=1) or (empno=null and mgr=1) ) is null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[IS NULL(OR(AND(=(_0, 1), =(_3, 1)), AND(=(_0, null), =(_3, 1))))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[IS NULL(OR(AND(=(_0, 1), =(_3, 1)), AND(null, =(_3, 1))))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testOrAlwaysTrue">
        <Resource name="sql">
            <![CDATA[select * from EMPNULLABLES_20
where sal is null or sal is not null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_7])
  LogicalFilter(condition=[OR(IS NULL(_5), IS NOT NULL(_5))])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
      LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
        LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_7])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
    LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
      LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testOrAlwaysTrue2">
        <Resource name="sql">
            <![CDATA[select * from EMPNULLABLES_20
where sal is not null or sal is null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_7])
  LogicalFilter(condition=[OR(IS NOT NULL(_5), IS NULL(_5))])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
      LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
        LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_7])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], SLACKER=[_8])
    LogicalFilter(condition=[AND(=(_7, 20), >(_5, 1000))])
      LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWindowFunctionOnAggregations">
        <Resource name="sql">
            <![CDATA[SELECT
  min(empno),
  sum(sal),
  sum(sum(sal))
    over (partition by min(empno) order by sum(sal))
from emp
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_2], EXPR_2=[SUM(_2) OVER (PARTITION BY _1 ORDER BY _2 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
  LogicalAggregate(group=[{0}], EXPR_0=[MIN(_1)], EXPR_1=[SUM(_2)])
    LogicalProject(DEPTNO=[_7], EMPNO=[_0], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_2], _2=[_3])
  LogicalWindow(window#0=[window(partition {1} order by [2] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [SUM(_2)])])
    LogicalAggregate(group=[{0}], EXPR_0=[MIN(_1)], EXPR_1=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], EMPNO=[_0], SAL=[_5])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumConstantThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename, sum(u) from
(select *, 2 u from emp as e1 union all
 select *, 3 u from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalProject(ENAME=[_1], U=[_9])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
      LogicalProject(ENAME=[_1], U=[2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
      LogicalProject(ENAME=[_1], U=[3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumNullConstantThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename, sum(u) from
(select *, cast(null as integer) u from emp as e1 union all
 select *, cast(null as integer) u from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalProject(ENAME=[_1], U=[_9])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
      LogicalProject(ENAME=[_1], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
      LogicalProject(ENAME=[_1], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumNullableThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename, sum(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
group by ename
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalProject(ENAME=[_1], MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
      LogicalProject(ENAME=[_1], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
      LogicalProject(ENAME=[_1], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumNullableNOGBYThroughUnion">
        <Resource name="sql">
            <![CDATA[select sum(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
  LogicalProject(MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
      LogicalProject(MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)])
      LogicalProject(MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushCountStarThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,count(*) from
(select * from emp as e1 union all
 select * from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
  LogicalProject(ENAME=[_1])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[$SUM0(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
      LogicalProject(ENAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
      LogicalProject(ENAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushCountNullableThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,count(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(_1)])
  LogicalProject(ENAME=[_1], MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[$SUM0(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT(_1)])
      LogicalProject(ENAME=[_1], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT(_1)])
      LogicalProject(ENAME=[_1], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushMaxNullableThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,max(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_1)])
  LogicalProject(ENAME=[_1], MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[MAX(_1)])
      LogicalProject(ENAME=[_1], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[MAX(_1)])
      LogicalProject(ENAME=[_1], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushMinThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,min(empno) from
            (select * from emp as e1 union all
            select * from emp as e2)
            group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MIN(_1)])
  LogicalProject(ENAME=[_1], EMPNO=[_0])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MIN(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[MIN(_1)])
      LogicalProject(ENAME=[_1], EMPNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[MIN(_1)])
      LogicalProject(ENAME=[_1], EMPNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAvgThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,avg(empno) from
(select * from emp as e1 union all
 select * from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[AVG(_1)])
  LogicalProject(ENAME=[_1], EMPNO=[_0])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[AVG(_1)])
  LogicalUnion(all=[true])
    LogicalProject(ENAME=[_1], EMPNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ENAME=[_1], EMPNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumCountStarThroughUnion">
        <Resource name="sql">
            <![CDATA[select ename,sum(empno),count(*),min(deptno),max(empno) from
(select * from emp as e1 union all
 select * from emp as e2)
group by ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[COUNT()], EXPR_3=[MIN(_2)], EXPR_4=[MAX(_1)])
  LogicalProject(ENAME=[_1], EMPNO=[_0], DEPTNO=[_7])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[$SUM0(_2)], EXPR_3=[MIN(_3)], EXPR_4=[MAX(_4)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[COUNT()], EXPR_3=[MIN(_2)], EXPR_4=[MAX(_1)])
      LogicalProject(ENAME=[_1], EMPNO=[_0], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)], EXPR_2=[COUNT()], EXPR_3=[MIN(_2)], EXPR_4=[MAX(_1)])
      LogicalProject(ENAME=[_1], EMPNO=[_0], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumConstantGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, sum(u) from
(select *, 2 u from emp as e1 union all
 select *, 3 u from emp as e2)
group by rollup(deptno,job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], U=[_9])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], U=[2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], U=[3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumNullConstantGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, sum(u) from
(select *, cast(null as integer) u from emp as e1 union all
 select *, cast(null as integer) u from emp as e2)
group by rollup(deptno,job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], U=[_9])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], U=[null:INTEGER])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumNullableGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, sum(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
group by rollup(deptno, job)
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushCountStarGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, count(*) from
(select * from emp as e1 union all
 select * from emp as e2)
group by rollup(deptno, job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[COUNT()])
  LogicalProject(DEPTNO=[_7], JOB=[_2])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[$SUM0(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
      LogicalProject(DEPTNO=[_7], JOB=[_2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT()])
      LogicalProject(DEPTNO=[_7], JOB=[_2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushCountNullableGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, count(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
group by rollup(deptno, job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[COUNT(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[$SUM0(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[COUNT(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushMaxNullableGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, max(mgr) from
(select * from emp as e1 union all
 select * from emp as e2)
group by rollup(deptno, job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[MAX(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[MAX(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[MAX(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[MAX(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushMinGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, min(empno) from
            (select * from emp as e1 union all
            select * from emp as e2)
            group by rollup(deptno, job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[MIN(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[MIN(_2)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[MIN(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[MIN(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAvgGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job, avg(empno) from
(select * from emp as e1 union all
 select * from emp as e2)
group by rollup(deptno, job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[AVG(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[AVG(_2)])
  LogicalUnion(all=[true])
    LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSumCountStarGroupingSetsThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno,job,sum(empno),count(*),min(deptno),max(empno) from
(select * from emp as e1 union all
 select * from emp as e2)
group by rollup(deptno,job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)], EXPR_3=[COUNT()], EXPR_4=[MIN(_0)], EXPR_5=[MAX(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[SUM(_2)], EXPR_3=[$SUM0(_3)], EXPR_4=[MIN(_4)], EXPR_5=[MAX(_5)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)], EXPR_3=[COUNT()], EXPR_4=[MIN(_0)], EXPR_5=[MAX(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}], EXPR_2=[SUM(_2)], EXPR_3=[COUNT()], EXPR_4=[MIN(_0)], EXPR_5=[MAX(_2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], EMPNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushCountFilterThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, count(*) filter (where job = 'CLERK')
from (
  select * from emp where deptno = 10
  union all
  select * from emp where deptno > 20)
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT() FILTER _1])
  LogicalProject(DEPTNO=[_7], _f1=[=(_2, 'CLERK')])
    LogicalUnion(all=[true])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[>(_7, 20)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[$SUM0(_1)])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT() FILTER _1])
      LogicalProject(DEPTNO=[_7], _f1=[=(_2, 'CLERK')])
        LogicalFilter(condition=[=(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT() FILTER _1])
      LogicalProject(DEPTNO=[_7], _f1=[=(_2, 'CLERK')])
        LogicalFilter(condition=[>(_7, 20)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullFilterThroughAggregate">
        <Resource name="sql">
            <![CDATA[select ename, sal, deptno from (  select ename, sal, deptno  from emp  where sal > 5000)group by ename, sal, deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1, 2}])
  LogicalFilter(condition=[>(_1, 5000)])
    LogicalProject(ENAME=[_1], SAL=[_5], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalFilter(condition=[>(_1, 5000)])
  LogicalAggregate(group=[{0, 1, 2}])
    LogicalProject(ENAME=[_1], SAL=[_5], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullFilterThroughAggregateGroupingSets">
        <Resource name="sql">
            <![CDATA[select ename, sal, deptno from (  select ename, sal, deptno  from emp  where sal > 5000)group by rollup(ename, sal, deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1, 2}], groups=[[{0, 1, 2}, {0, 1}, {0}, {}]])
  LogicalFilter(condition=[>(_1, 5000)])
    LogicalProject(ENAME=[_1], SAL=[_5], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1, 2}], groups=[[{0, 1, 2}, {0, 1}, {0}, {}]])
  LogicalFilter(condition=[>(_1, 5000)])
    LogicalAggregate(group=[{0, 1, 2}])
      LogicalProject(ENAME=[_1], SAL=[_5], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughConstLast">
        <Resource name="sql">
            <![CDATA[select deptno, max(mgr) from (
  select *, 4 as four, 2+3 as two_plus_three, deptno+42 as deptno42 from emp
) group by deptno, four]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_2])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[MAX(_2)])
    LogicalProject(DEPTNO=[_7], FOUR=[4], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_2)])
  LogicalProject(DEPTNO=[_7], FOUR=[4], MGR=[_3])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregateSimpleNonNullable">
        <Resource name="sql">
            <![CDATA[select deptno, max(ename) from (
  select *, 4 as four, 2+3 as two_plus_three, deptno+42 as deptno42 from emp
) group by deptno, four]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_2])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[MAX(_2)])
    LogicalProject(DEPTNO=[_7], FOUR=[4], ENAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_2)])
  LogicalProject(DEPTNO=[_7], FOUR=[4], ENAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregatePermuted">
        <Resource name="sql">
            <![CDATA[select deptno, max(mgr) from (
  select *, 4 as four, 2+3 as two_plus_three, deptno+42 as deptno42 from emp
) group by deptno, four, two_plus_three, deptno42]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_4])
  LogicalAggregate(group=[{0, 1, 2, 3}], EXPR_1=[MAX(_4)])
    LogicalProject(DEPTNO=[_7], FOUR=[4], TWO_PLUS_THREE=[+(2, 3)], DEPTNO42=[+(_7, 42)], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_2])
  LogicalAggregate(group=[{0, 3}], EXPR_1=[MAX(_4)])
    LogicalProject(DEPTNO=[_7], FOUR=[4], TWO_PLUS_THREE=[+(2, 3)], DEPTNO42=[+(_7, 42)], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregatePermutedConstFirst">
        <Resource name="sql">
            <![CDATA[select deptno, max(mgr) from (
  select *, 4 as four, 2+3 as two_plus_three, deptno+42 as deptno42 from emp
) group by four, deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_1], EXPR_1=[_2])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[MAX(_2)])
    LogicalProject(FOUR=[4], DEPTNO=[_7], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[MAX(_2)])
  LogicalProject(FOUR=[4], DEPTNO=[_7], MGR=[_3])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregatePermutedConstGroupBy">
        <Resource name="sql">
            <![CDATA[select deptno, max(mgr) from (
  select *, 4 as four, 2+3 as two_plus_three, deptno+42 as deptno42 from emp
) group by 42+24, deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_1], EXPR_1=[_2])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[MAX(_2)])
    LogicalProject(_f0=[+(42, 24)], DEPTNO=[_7], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[MAX(_2)])
  LogicalProject(_f0=[+(42, 24)], DEPTNO=[_7], MGR=[_3])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregateConstGroupBy">
        <Resource name="sql">
            <![CDATA[select 4, 2+3, max(mgr) from (
  select *, 4 as four, 2+3 as two_plus_three, deptno+42 as deptno42 from emp
) group by 4, 2+3]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], EXPR_2=[MAX(_2)])
  LogicalProject(EXPR_0=[4], EXPR_1=[+(2, 3)], MGR=[_3])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[+(2, 3)], EXPR_2=[_1])
  LogicalAggregate(group=[{0}], EXPR_2=[MAX(_2)])
    LogicalProject(EXPR_0=[4], EXPR_1=[+(2, 3)], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregateAllConst">
        <Resource name="sql">
            <![CDATA[select 4, 2+3, max(five) from (
  select *, 4 as four, 2+3 as two_plus_three, 5 as five, deptno+42 as deptno42 from emp
) group by 4, 2+3]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], EXPR_2=[MAX(_2)])
  LogicalProject(EXPR_0=[4], EXPR_1=[+(2, 3)], FIVE=[5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[+(2, 3)], EXPR_2=[_1])
  LogicalAggregate(group=[{0}], EXPR_2=[MAX(_2)])
    LogicalProject(EXPR_0=[4], EXPR_1=[+(2, 3)], FIVE=[5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughAggregateAllLiterals">
        <Resource name="sql">
            <![CDATA[select 4, 2+3, max(5) from (
  select *, 4 as four, 2+3 as two_plus_three, 5 as five, deptno+42 as deptno42 from emp
) group by 4, 2+3]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], EXPR_2=[MAX(_2)])
  LogicalProject(EXPR_0=[4], EXPR_1=[+(2, 3)], _f2=[5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[+(2, 3)], EXPR_2=[_1])
  LogicalAggregate(group=[{0}], EXPR_2=[MAX(_2)])
    LogicalProject(EXPR_0=[4], EXPR_1=[+(2, 3)], _f2=[5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughUnion">
        <Resource name="sql">
            <![CDATA[select 2, deptno, job from emp as e1
union all
select 2, deptno, job from emp as e2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(EXPR_0=[2], DEPTNO=[_7], JOB=[_2])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EXPR_0=[2], DEPTNO=[_7], JOB=[_2])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[2], DEPTNO=[_0], JOB=[_1])
  LogicalUnion(all=[true])
    LogicalProject(DEPTNO=[_7], JOB=[_2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_7], JOB=[_2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughUnion2">
        <Resource name="sql">
            <![CDATA[select 2, deptno, job from emp as e1
union all
select 1, deptno, job from emp as e2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(EXPR_0=[2], DEPTNO=[_7], JOB=[_2])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EXPR_0=[1], DEPTNO=[_7], JOB=[_2])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantThroughUnion3">
        <Resource name="sql">
            <![CDATA[select 2, 3 from emp as e1
union all
select 2, 3 from emp as e2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(EXPR_0=[2], EXPR_1=[3])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EXPR_0=[2], EXPR_1=[3])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[2], EXPR_1=[3])
  LogicalUnion(all=[true])
    LogicalProject(EXPR_0=[2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EXPR_0=[2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testConvertMultiJoinRule">
        <Resource name="sql">
            <![CDATA[select e1.ename from emp e1, dept d, emp e2
where e1.deptno = d.deptno and d.deptno = e2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_9, _18))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  MultiJoin(joinFilter=[AND(=(_9, _18), =(_7, _9))], isFullOuterJoin=[false], joinTypes=[[INNER, INNER, INNER]], outerJoinConditions=[[NULL, NULL, NULL]], projFields=[[ALL, ALL, ALL]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testManyFiltersOnTopOfMultiJoinShouldCollapse">
        <Resource name="sql">
            <![CDATA[select * from (select * from emp e1 left outer join dept d
on e1.deptno = d.deptno
where d.deptno > 3) where ename LIKE 'bar']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalFilter(condition=[LIKE(_1, 'bar')])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
      LogicalFilter(condition=[>(_9, 3)])
        LogicalJoin(condition=[=(_7, _9)], joinType=[left])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[INNER, LEFT]], outerJoinConditions=[[NULL, =(_7, _9)]], projFields=[[{0, 1, 2, 3, 4, 5, 6, 7, 8}, {0, 1}]], postJoinFilter=[AND(LIKE(_1, 'bar'), >(_9, 3))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testRemoveSemiJoinWithFilter">
        <Resource name="sql">
            <![CDATA[select e.ename from emp e, dept d
where e.deptno = d.deptno and e.ename = 'foo']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_1, 'foo'))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
    LogicalFilter(condition=[=(_1, 'foo')])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testRemoveSemiJoinRight">
        <Resource name="sql">
            <![CDATA[select e1.ename from emp e1, dept d, emp e2
where e1.deptno = d.deptno and d.deptno = e2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_9, _18))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_9, _18)], joinType=[inner], semiJoinDone=[true])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeFilterWithJoinCondition">
        <Resource name="sql">
            <![CDATA[select d.name as dname,e.ename as ename
 from emp e inner join dept d
 on e.deptno=d.deptno
 where d.name='Propane']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DNAME=[_10], ENAME=[_1])
  LogicalFilter(condition=[=(_10, 'Propane')])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalCalc(expr#0..10=[{inputs}], expr#11=[=(_t7, _t9)], expr#12=['Propane':VARCHAR(10)], expr#13=[=(_t10, _t12)], expr#14=[AND(_t11, _t13)], DNAME=[_t10], ENAME=[_t1], _condition=[_t14])
  LogicalJoin(condition=[true], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testConvertMultiJoinRuleOuterJoins">
        <Resource name="sql">
            <![CDATA[select * from     (select * from         (select * from             (select * from A right outer join B on a = b)             left outer join             (select * from C full outer join D on c = d)            on a = c and b = d)         right outer join         (select * from             (select * from E full outer join F on e = f)             right outer join             (select * from G left outer join H on g = h)             on e = g and f = h)         on a = e and b = f and c = g and d = h)     inner join     (select * from I inner join J on i = j)     on a = i and h = j]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(A=[_0], B=[_1], C=[_2], D=[_3], E=[_4], F=[_5], G=[_6], H=[_7], I=[_8], J=[_9])
  LogicalJoin(condition=[AND(=(_0, _8), =(_7, _9))], joinType=[inner])
    LogicalProject(A=[_0], B=[_1], C=[_2], D=[_3], E=[_4], F=[_5], G=[_6], H=[_7])
      LogicalJoin(condition=[AND(=(_0, _4), =(_1, _5), =(_2, _6), =(_3, _7))], joinType=[right])
        LogicalProject(A=[_0], B=[_1], C=[_2], D=[_3])
          LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[left])
            LogicalProject(A=[_0], B=[_1])
              LogicalJoin(condition=[=(_0, _1)], joinType=[right])
                LogicalTableScan(table=[[CATALOG, SALES, A]])
                LogicalTableScan(table=[[CATALOG, SALES, B]])
            LogicalProject(C=[_0], D=[_1])
              LogicalJoin(condition=[=(_0, _1)], joinType=[full])
                LogicalTableScan(table=[[CATALOG, SALES, C]])
                LogicalTableScan(table=[[CATALOG, SALES, D]])
        LogicalProject(E=[_0], F=[_1], G=[_2], H=[_3])
          LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[right])
            LogicalProject(E=[_0], F=[_1])
              LogicalJoin(condition=[=(_0, _1)], joinType=[full])
                LogicalTableScan(table=[[CATALOG, SALES, E]])
                LogicalTableScan(table=[[CATALOG, SALES, F]])
            LogicalProject(G=[_0], H=[_1])
              LogicalJoin(condition=[=(_0, _1)], joinType=[left])
                LogicalTableScan(table=[[CATALOG, SALES, G]])
                LogicalTableScan(table=[[CATALOG, SALES, H]])
    LogicalProject(I=[_0], J=[_1])
      LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, I]])
        LogicalTableScan(table=[[CATALOG, SALES, J]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
MultiJoin(joinFilter=[AND(=(_0, _8), =(_7, _9), =(_8, _9))], isFullOuterJoin=[false], joinTypes=[[INNER, INNER, INNER]], outerJoinConditions=[[NULL, NULL, NULL]], projFields=[[ALL, ALL, ALL]])
  MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[RIGHT, INNER]], outerJoinConditions=[[AND(=(_0, _4), =(_1, _5), =(_2, _6), =(_3, _7)), NULL]], projFields=[[ALL, ALL]])
    MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[INNER, LEFT]], outerJoinConditions=[[NULL, AND(=(_0, _2), =(_1, _3))]], projFields=[[ALL, ALL]])
      MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[RIGHT, INNER]], outerJoinConditions=[[=(_0, _1), NULL]], projFields=[[ALL, ALL]])
        LogicalTableScan(table=[[CATALOG, SALES, A]])
        LogicalTableScan(table=[[CATALOG, SALES, B]])
      MultiJoin(joinFilter=[=(_0, _1)], isFullOuterJoin=[true], joinTypes=[[INNER, INNER]], outerJoinConditions=[[NULL, NULL]], projFields=[[ALL, ALL]])
        LogicalTableScan(table=[[CATALOG, SALES, C]])
        LogicalTableScan(table=[[CATALOG, SALES, D]])
    MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[RIGHT, INNER]], outerJoinConditions=[[AND(=(_0, _2), =(_1, _3)), NULL]], projFields=[[ALL, ALL]])
      MultiJoin(joinFilter=[=(_0, _1)], isFullOuterJoin=[true], joinTypes=[[INNER, INNER]], outerJoinConditions=[[NULL, NULL]], projFields=[[ALL, ALL]])
        LogicalTableScan(table=[[CATALOG, SALES, E]])
        LogicalTableScan(table=[[CATALOG, SALES, F]])
      MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[INNER, LEFT]], outerJoinConditions=[[NULL, =(_0, _1)]], projFields=[[ALL, ALL]])
        LogicalTableScan(table=[[CATALOG, SALES, G]])
        LogicalTableScan(table=[[CATALOG, SALES, H]])
  LogicalTableScan(table=[[CATALOG, SALES, I]])
  LogicalTableScan(table=[[CATALOG, SALES, J]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSemiJoinPastJoinRuleLeft">
        <Resource name="sql">
            <![CDATA[select e1.ename from emp e1, dept d, emp e2
where e1.deptno = d.deptno and e1.empno = e2.empno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_0, _11))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_0, _11)], joinType=[inner], semiJoinDone=[true])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
      LogicalJoin(condition=[=(_0, _9)], joinType=[semi])
        LogicalJoin(condition=[=(_7, _9)], joinType=[semi])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSemiJoinPastJoinRuleRight">
        <Resource name="sql">
            <![CDATA[select e1.ename from emp e1, dept d, emp e2
where e1.deptno = d.deptno and d.deptno = e2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_9, _18))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_9, _18)], joinType=[inner], semiJoinDone=[true])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
      LogicalJoin(condition=[=(_7, _9)], joinType=[semi])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalJoin(condition=[=(_0, _9)], joinType=[semi])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testRemoveSemiJoin">
        <Resource name="sql">
            <![CDATA[select e.ename from emp e, dept d
where e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[=(_7, _9)])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSemiJoinPastProject">
        <Resource name="sql">
            <![CDATA[select e.* from
(select ename, trim(job), sal * 2, deptno from emp) e, dept d
where e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_0], EXPR_1=[_1], EXPR_2=[_2], DEPTNO=[_3])
  LogicalFilter(condition=[=(_3, _4)])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalProject(ENAME=[_1], EXPR_1=[TRIM(FLAG(BOTH), ' ', _2)], EXPR_2=[*(_5, 2)], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_0], EXPR_1=[_1], EXPR_2=[_2], DEPTNO=[_3])
  LogicalJoin(condition=[=(_3, _4)], joinType=[inner], semiJoinDone=[true])
    LogicalProject(ENAME=[_1], EXPR_1=[TRIM(FLAG(BOTH), ' ', _2)], EXPR_2=[*(_5, 2)], DEPTNO=[_7])
      LogicalJoin(condition=[=(_7, _9)], joinType=[semi])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSemiJoinPastFilter">
        <Resource name="sql">
            <![CDATA[select e.ename from emp e, dept d
where e.deptno = d.deptno and e.ename = 'foo']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_1, 'foo'))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
    LogicalFilter(condition=[=(_1, 'foo')])
      LogicalJoin(condition=[=(_7, _9)], joinType=[semi])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testRemoveSemiJoinRightWithFilter">
        <Resource name="sql">
            <![CDATA[select e1.ename from emp e1, dept d, emp e2
where e1.deptno = d.deptno and d.deptno = e2.deptno
and d.name = 'foo']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[AND(=(_7, _9), =(_9, _18), =(_10, 'foo'))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalJoin(condition=[=(_9, _18)], joinType=[inner], semiJoinDone=[true])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner], semiJoinDone=[true])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[=(_1, 'foo')])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testHeterogeneousConversion">
        <Resource name="sql">
            <![CDATA[select upper(ename) from emp union all
select lower(ename) from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(EXPR_0=[UPPER(_1)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EXPR_0=[LOWER(_1)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalCalc(expr#0..8=[{inputs}], expr#9=[UPPER(_t1)], EXPR_0=[_t9])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalProject(EXPR_0=[LOWER(_1)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastAggFour">
        <Resource name="sql">
            <![CDATA[select emp.deptno, count(*) from emp where emp.sal > '12'
group by emp.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[$SUM0(_2)])
  LogicalFilter(condition=[>(_0, CAST('12'):INTEGER NOT NULL)])
    LogicalAggregate(group=[{5, 7}], EXPR_1=[COUNT()])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[$SUM0(_2)])
  LogicalAggregate(group=[{5, 7}], EXPR_1=[COUNT()])
    LogicalFilter(condition=[>(_5, 12)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectPastFilter2">
        <Resource name="sql">
            <![CDATA[select count(*)
from emp
where case when mgr < 10 then true else false end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[0])
    LogicalFilter(condition=[CASE(<(_3, 10), true, false)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[0])
    LogicalFilter(condition=[<(_0, 10)])
      LogicalProject(MGR=[_3])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
inner join sales.emp e on d.deptno = e.deptno where e.deptno > 7]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceProject">
        <Resource name="sql">
            <![CDATA[select 1 from (select * from sales.emp where deptno > 7) d
inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceAggregate">
        <Resource name="sql">
            <![CDATA[select 1 from (select deptno, count(*) from sales.emp where deptno > 7
group by deptno) d inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 7)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
    LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 7)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceUnion">
        <Resource name="sql">
            <![CDATA[select 1 from
(select deptno from sales.emp where deptno > 7
union all select deptno from sales.emp where deptno > 10) d
inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 7)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 7)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[OR(>(_7, 7), >(_7, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceJoin3way">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
inner join sales.emp e on d.deptno = e.deptno
inner join sales.emp f on e.deptno = f.deptno
where d.deptno > 7]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_16, _25)], joinType=[inner])
    LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_16, _25)], joinType=[inner])
    LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceUnionAlwaysTrue">
        <Resource name="sql">
            <![CDATA[select d.deptno, e.deptno from
(select deptno from sales.emp where deptno < 4) d
inner join
(select deptno from sales.emp where deptno > 7
union all select deptno from sales.emp) e
on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], DEPTNO0=[_1])
  LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
    LogicalProject(DEPTNO=[_7])
      LogicalFilter(condition=[<(_7, 4)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalUnion(all=[true])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 7)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], DEPTNO0=[_1])
  LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
    LogicalProject(DEPTNO=[_7])
      LogicalFilter(condition=[<(_7, 4)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[<(_0, 4)])
      LogicalUnion(all=[true])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceJoin3wayAgg">
        <Resource name="sql">
            <![CDATA[select 1 from
(select deptno, count(*) from sales.emp where deptno > 7 group by deptno) d
inner join sales.emp e on d.deptno = e.deptno
inner join sales.emp f on e.deptno = f.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_9, _18)], joinType=[inner])
    LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
      LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_9, _18)], joinType=[inner])
    LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
      LogicalAggregate(group=[{0}], EXPR_1=[COUNT()])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceLeftOuterJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
left outer join sales.emp e on d.deptno = e.deptno
where d.deptno > 7 and e.deptno > 9]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[>(_16, 9)])
    LogicalJoin(condition=[=(_7, _16)], joinType=[left])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[>(_16, 9)])
    LogicalJoin(condition=[=(_7, _16)], joinType=[left])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceRightOuterJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
right outer join sales.emp e on d.deptno = e.deptno
where d.deptno > 7 and e.deptno > 9]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[>(_7, 7)])
    LogicalJoin(condition=[=(_7, _16)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[>(_7, 9)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[>(_7, 7)])
    LogicalJoin(condition=[=(_7, _16)], joinType=[right])
      LogicalFilter(condition=[>(_7, 9)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[>(_7, 9)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceFullOuterJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d full outer join sales.emp e
on d.deptno = e.deptno  where d.deptno > 7 and e.deptno > 9]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[AND(>(_7, 7), >(_16, 9))])
    LogicalJoin(condition=[=(_7, _16)], joinType=[full])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalFilter(condition=[AND(>(_7, 7), >(_16, 9))])
    LogicalJoin(condition=[=(_7, _16)], joinType=[full])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferencePreventProjectPullUp">
        <Resource name="sql">
            <![CDATA[select 1 from (select comm as deptno from sales.emp where deptno > 7) d
inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalProject(DEPTNO=[_6])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalProject(DEPTNO=[_6])
      LogicalFilter(condition=[>(_7, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferencePullUpThruAlias">
        <Resource name="sql">
            <![CDATA[select 1 from (select comm as deptno from sales.emp where comm > 7) d
inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalProject(DEPTNO=[_6])
      LogicalFilter(condition=[>(_6, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalProject(DEPTNO=[_6])
      LogicalFilter(condition=[>(_6, 7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceConjunctInPullUp">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
inner join sales.emp e on d.deptno = e.deptno
where d.deptno in (7, 9) or d.deptno > 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[OR(=(_7, 7), =(_7, 9), >(_7, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[OR(=(_7, 7), =(_7, 9), >(_7, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[OR(=(_7, 7), =(_7, 9), >(_7, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceNoPullUpExprs">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
inner join sales.emp e on d.deptno = e.deptno
where d.deptno in (7, 9) or d.comm > 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[OR(=(_7, 7), =(_7, 9), >(_6, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[OR(=(_7, 7), =(_7, 9), >(_6, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceUnion3way">
        <Resource name="sql">
            <![CDATA[select 1 from
(select deptno from sales.emp where deptno > 7
union all
select deptno from sales.emp where deptno > 10
union all
select deptno from sales.emp where deptno > 1) d
inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalUnion(all=[true])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 10)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 1)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _8)], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalUnion(all=[true])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 7)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_7])
          LogicalFilter(condition=[>(_7, 10)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 1)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[OR(>(_7, 7), >(_7, 10), >(_7, 1))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceUnion3wayOr">
        <Resource name="sql">
            <![CDATA[select 1 from
(select empno, deptno from sales.emp where deptno > 7 or empno < 10
union all
select empno, deptno from sales.emp where deptno > 10 or empno < deptno
union all
select empno, deptno from sales.emp where deptno > 1) d
inner join sales.emp e on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_1, _9)], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalUnion(all=[true])
        LogicalProject(EMPNO=[_0], DEPTNO=[_7])
          LogicalFilter(condition=[OR(>(_7, 7), <(_0, 10))])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(EMPNO=[_0], DEPTNO=[_7])
          LogicalFilter(condition=[OR(>(_7, 10), <(_0, _7))])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 1)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_1, _9)], joinType=[inner])
    LogicalUnion(all=[true])
      LogicalUnion(all=[true])
        LogicalProject(EMPNO=[_0], DEPTNO=[_7])
          LogicalFilter(condition=[OR(>(_7, 7), <(_0, 10))])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(EMPNO=[_0], DEPTNO=[_7])
          LogicalFilter(condition=[OR(>(_7, 10), <(_0, _7))])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_0], DEPTNO=[_7])
        LogicalFilter(condition=[>(_7, 1)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceConstantEquiPredicate">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
inner join sales.emp e on d.deptno = e.deptno  where 1 = 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceConstantPredicate">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d inner join sales.emp e on d.deptno = e.deptno  where 2 > 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
ProjectRel(EXPR_0=[1])
  JoinRel(condition=[=(_7, _16)], joinType=[inner])
    FilterRel(condition=[>(2, 1)])
      TableAccessRel(table=[[CATALOG, SALES, EMP]])
    TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(EXPR_0=[1])
  JoinRel(condition=[=(_7, _16)], joinType=[inner])
    FilterRel(condition=[>(2, 1)])
      TableAccessRel(table=[[CATALOG, SALES, EMP]])
    TableAccessRel(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testTransitiveInferenceComplexPredicate">
        <Resource name="sql">
            <![CDATA[select 1 from sales.emp d
inner join sales.emp e on d.deptno = e.deptno
where d.deptno > 7 and e.sal = e.deptno and d.comm = d.deptno
and d.comm + d.deptno > d.comm/2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[AND(>(_7, 7), =(_6, _7), >(+(_6, _7), /(_6, 2)))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[=(_5, _7)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
    LogicalFilter(condition=[AND(>(_7, 7), =(_6, _7), >(+(_6, _7), /(_6, 2)))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[>(_7, 7)])
      LogicalFilter(condition=[=(_5, _7)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantIntoProject">
        <Resource name="sql">
            <![CDATA[select deptno, deptno + 1, empno + deptno
from sales.emp where deptno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7], EXPR_1=[+(_7, 1)], EXPR_2=[+(_0, _7)])
  LogicalFilter(condition=[=(_7, 10)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[10], EXPR_1=[11], EXPR_2=[+(_0, 10)])
  LogicalFilter(condition=[=(_7, 10)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantIntoFilter">
        <Resource name="sql">
            <![CDATA[select * from (select * from sales.emp where deptno = 10)
where deptno + 5 > empno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[>(+(_7, 5), _0)])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[>(15, _0)])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin1">
        <Resource name="sql">
            <![CDATA[select e.ename
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
group by e.ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin10">
        <Resource name="sql">
            <![CDATA[select count(e.ename)
from (select * from sales.emp where empno = 10) as e
left outer join sales.emp as d on e.job = d.job
group by e.ename,d.mgr]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_2])
  LogicalAggregate(group=[{1, 12}], EXPR_0=[COUNT()])
    LogicalJoin(condition=[=(_2, _11)], joinType=[left])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_0, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin11">
        <Resource name="sql">
            <![CDATA[select e.empno,d.deptno
from (select * from sales.emp where empno = 10) as e
left outer join sales.dept as d on e.empno < d.deptno
group by e.empno,d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 9}])
  LogicalJoin(condition=[<(_0, _9)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin12">
        <Resource name="sql">
            <![CDATA[select e.job
from (select * from sales.emp where ename = 'A') as e
right outer join sales.dept as d on e.job = d.name
group by e.job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[right])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalJoin(condition=[=(_0, _1)], joinType=[right])
    LogicalAggregate(group=[{2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin13">
        <Resource name="sql">
            <![CDATA[select e.job
from (select * from sales.emp where ename = 'A') as e
full outer join sales.dept as d on e.job = d.name
group by e.job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[full])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalJoin(condition=[=(_0, _1)], joinType=[full])
    LogicalAggregate(group=[{2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin14">
        <Resource name="sql">
            <![CDATA[select e.mgr, d.mgr
from sales.emp as e
full outer join sales.emp as d on e.mgr = d.mgr
group by d.mgr, e.mgr]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(MGR=[_1], MGR0=[_0])
  LogicalProject(MGR0=[_1], MGR=[_0])
    LogicalAggregate(group=[{3, 12}])
      LogicalJoin(condition=[=(_3, _12)], joinType=[full])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(MGR=[_1], MGR0=[_0])
  LogicalProject(MGR0=[_1], MGR=[_0])
    LogicalAggregate(group=[{0, 1}])
      LogicalJoin(condition=[=(_0, _1)], joinType=[full])
        LogicalAggregate(group=[{3}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{3}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin15">
        <Resource name="sql">
            <![CDATA[select e.ename, d.mgr
from (select * from sales.emp where ename = 'A') as e
full outer join sales.emp as d on e.job = d.job
group by e.ename,d.mgr]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1, 12}])
  LogicalJoin(condition=[=(_2, _11)], joinType=[full])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 3}])
  LogicalJoin(condition=[=(_1, _2)], joinType=[full])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{2, 3}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin16">
        <Resource name="sql">
            <![CDATA[select e.job
from (select * from sales.emp where ename = 'A') as e
full outer join sales.dept as d on e.job = d.name
and e.deptno + e.empno = d.deptno + 5
group by e.job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2}])
  LogicalJoin(condition=[AND(=(_2, _11), =(_9, _12))], joinType=[full])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[full])
    LogicalAggregate(group=[{2, 9}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin2">
        <Resource name="sql">
            <![CDATA[select d.ename
from (select * from sales.emp where ename = 'A') as e
left outer join sales.emp as d on e.job = d.job
group by d.ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{10}])
  LogicalJoin(condition=[=(_2, _11)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}])
  LogicalJoin(condition=[=(_0, _2)], joinType=[left])
    LogicalAggregate(group=[{2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1, 2}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin3">
        <Resource name="sql">
            <![CDATA[select e.ename, d.mgr
from (select * from sales.emp where ename = 'A') as e
left outer join sales.emp as d on e.job = d.job
group by e.ename,d.mgr]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1, 12}])
  LogicalJoin(condition=[=(_2, _11)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 3}])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{2, 3}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin4">
        <Resource name="sql">
            <![CDATA[select e.job
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
group by e.job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_0])
  LogicalJoin(condition=[=(_0, _1)], joinType=[left])
    LogicalAggregate(group=[{2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin5">
        <Resource name="sql">
            <![CDATA[select d.name
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
group by d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{10}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}])
  LogicalJoin(condition=[=(_0, _1)], joinType=[left])
    LogicalAggregate(group=[{2}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin6">
        <Resource name="sql">
            <![CDATA[select e.job,d.name
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
group by e.job,d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2, 10}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalJoin(condition=[=(_0, _1)], joinType=[left])
  LogicalAggregate(group=[{2}])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalAggregate(group=[{1}])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin7">
        <Resource name="sql">
            <![CDATA[select e.job
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
and e.deptno + e.empno = d.deptno + 5
group by e.job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2}])
  LogicalJoin(condition=[AND(=(_2, _11), =(_9, _12))], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[left])
    LogicalAggregate(group=[{2, 9}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin8">
        <Resource name="sql">
            <![CDATA[select d.name
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
and e.deptno + e.empno = d.deptno + 5
group by d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{11}])
  LogicalJoin(condition=[AND(=(_2, _11), =(_9, _12))], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{2}])
  LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[left])
    LogicalAggregate(group=[{2, 9}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughOuterJoin9">
        <Resource name="sql">
            <![CDATA[select e.job, d.name
from (select * from sales.emp where ename = 'A') as e
left outer join sales.dept as d on e.job = d.name
and e.deptno + e.empno = d.deptno + 5
group by e.job, d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2, 11}])
  LogicalJoin(condition=[AND(=(_2, _11), =(_9, _12))], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 2}])
  LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[left])
    LogicalAggregate(group=[{2, 9}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSimplifyFilter">
        <Resource name="sql">
            <![CDATA[select * from (select * from sales.emp where deptno > 10)
where empno > 3 and deptno > 5]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[AND(>(_0, 3), >(_7, 5))])
      LogicalFilter(condition=[>(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[>(_0, 3)])
      LogicalFilter(condition=[>(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantIntoJoin">
        <Resource name="sql">
            <![CDATA[select * from (select * from sales.emp where empno = 10) as e
left join sales.dept as d on e.empno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalJoin(condition=[=(_0, _9)], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalJoin(condition=[true], joinType=[left])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[=(_0, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullConstantIntoJoin2">
        <Resource name="sql">
            <![CDATA[select * from (select * from sales.emp where empno = 10) as e
join sales.dept as d on e.empno = d.deptno and e.deptno + e.empno = d.deptno + 5]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_10], NAME=[_11])
  LogicalJoin(condition=[AND(=(_0, _10), =(_9, _12))], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[10], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[10], NAME=[_11])
  LogicalJoin(condition=[=(_9, 15)], joinType=[inner])
    LogicalProject(EMPNO=[10], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, 10)])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[10], NAME=[_1], _f2=[15])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testStrengthenJoinType">
        <Resource name="sql">
            <![CDATA[select *
from dept left join emp on dept.deptno = emp.deptno
where emp.deptno is not null and emp.sal > 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[_2], ENAME=[_3], JOB=[_4], MGR=[_5], HIREDATE=[_6], SAL=[_7], COMM=[_8], DEPTNO0=[_9], SLACKER=[_10])
  LogicalFilter(condition=[AND(IS NOT NULL(_9), >(_7, 100))])
    LogicalJoin(condition=[=(_0, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[_2], ENAME=[_3], JOB=[_4], MGR=[_5], HIREDATE=[_6], SAL=[_7], COMM=[_8], DEPTNO0=[_9], SLACKER=[_10])
  LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[CAST(_2):INTEGER], ENAME=[CAST(_3):VARCHAR(20)], JOB=[CAST(_4):VARCHAR(10)], MGR=[_5], HIREDATE=[CAST(_6):TIMESTAMP(0)], SAL=[CAST(_7):INTEGER], COMM=[CAST(_8):INTEGER], DEPTNO0=[CAST(_9):INTEGER], SLACKER=[CAST(_10):BOOLEAN])
    LogicalJoin(condition=[=(_0, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalFilter(condition=[>(_5, 100)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCanNotPushAntiJoinConditionsToLeft">
        <Resource name="sql">
            <![CDATA[select * from emp
where emp.deptno not in
(select dept.deptno from dept where emp.deptno > 20)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[AND(IS NOT DISTINCT FROM(_7, _8), >(_0, 20))], joinType=[anti])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCanNotPushAntiJoinConditionsToRight">
        <Resource name="sql">
            <![CDATA[select * from emp
where emp.deptno
not in (select dept.deptno from dept where dept.dname = 'ddd')]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[AND(IS NOT DISTINCT FROM(_7, _8), =(_9, 'ddd'))], joinType=[anti])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushSemiJoinConditionsToLeft">
        <Resource name="sql">
            <![CDATA[select * from emp
where emp.deptno
in (select dept.deptno from dept where emp.empno > 20)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[AND(IS NOT DISTINCT FROM(_7, _8), >(_0, 20))], joinType=[semi])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalTableScan(table=[[scott, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinRuleExists">
        <Resource name="sql">
            <![CDATA[select * from dept where exists (
  select * from emp
  where emp.deptno = dept.deptno
  and emp.sal > 100)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1])
  LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0}])
      LogicalProject(DEPTNO=[_7], _f0=[true])
        LogicalFilter(condition=[>(_5, 100)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(DEPTNO=[_7], _f0=[true])
    LogicalFilter(condition=[>(_5, 100)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinTrim">
        <Resource name="sql">
            <![CDATA[select s.deptno from (select * from dept where exists (
  select * from emp
  where emp.deptno = dept.deptno
  and emp.sal > 100)) s join customer.account on s.deptno = account.acctno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
    LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(DEPTNO=[_7], _f0=[true])
        LogicalFilter(condition=[>(_5, 100)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, CUSTOMER, ACCOUNT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
    LogicalJoin(condition=[=(_0, _1)], joinType=[semi])
      LogicalProject(DEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(DEPTNO=[_1])
        LogicalFilter(condition=[>(_0, 100)])
          LogicalProject(SAL=[_5], DEPTNO=[_7])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ACCTNO=[_0])
      LogicalTableScan(table=[[CATALOG, CUSTOMER, ACCOUNT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCastInAggregateReduceFunctions">
        <Resource name="sql">
            <![CDATA[select name, stddev_pop(deptno), avg(deptno),
stddev_samp(deptno),var_pop(deptno), var_samp(deptno)
from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[STDDEV_POP(_1)], EXPR_2=[AVG(_1)], EXPR_3=[STDDEV_SAMP(_1)], EXPR_4=[VAR_POP(_1)], EXPR_5=[VAR_SAMP(_1)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[CAST(POWER(/(-(_1, /(*(_2, _2), _3)), _3), 0.5:DECIMAL(2, 1))):INTEGER NOT NULL], EXPR_2=[CAST(/(_2, _3)):INTEGER NOT NULL], EXPR_3=[CAST(POWER(/(-(_1, /(*(_2, _2), _3)), CASE(=(_3, 1), null:BIGINT, -(_3, 1))), 0.5:DECIMAL(2, 1))):INTEGER NOT NULL], EXPR_4=[CAST(/(-(_1, /(*(_2, _2), _3)), _3)):INTEGER NOT NULL], EXPR_5=[CAST(/(-(_1, /(*(_2, _2), _3)), CASE(=(_3, 1), null:BIGINT, -(_3, 1)))):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], agg#0=[$SUM0(_2)], agg#1=[$SUM0(_1)], agg#2=[COUNT()])
    LogicalProject(NAME=[_0], DEPTNO=[_1], _f2=[*(_1, _1)])
      LogicalProject(NAME=[_1], DEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateProjectMerge">
        <Resource name="sql">
            <![CDATA[select x, sum(z), y from (
  select deptno as x, empno as y, sal as z, sal * 2 as zz
  from emp)
group by x, y]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(X=[_0], EXPR_1=[_2], Y=[_1])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[SUM(_2)])
    LogicalProject(X=[_7], Y=[_0], Z=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(X=[_0], EXPR_1=[_2], Y=[_1])
  LogicalProject(DEPTNO=[_1], EMPNO=[_0], EXPR_1=[_2])
    LogicalAggregate(group=[{0, 7}], EXPR_1=[SUM(_5)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateGroupingSetsProjectMerge">
        <Resource name="sql">
            <![CDATA[select x, sum(z), y from (
  select deptno as x, empno as y, sal as z, sal * 2 as zz
  from emp)
group by rollup(x, y)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(X=[_0], EXPR_1=[_2], Y=[_1])
  LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_1=[SUM(_2)])
    LogicalProject(X=[_7], Y=[_0], Z=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(X=[_0], EXPR_1=[_2], Y=[_1])
  LogicalProject(DEPTNO=[_1], EMPNO=[_0], EXPR_1=[_2])
    LogicalAggregate(group=[{0, 7}], groups=[[{0, 7}, {7}, {}]], EXPR_1=[SUM(_5)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullAggregateThroughUnion">
        <Resource name="sql">
            <![CDATA[select deptno, job from (select deptno, job from emp as e1 group by deptno,job  union all select deptno, job from emp as e2 group by deptno,job) group by deptno,job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], JOB=[_2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], JOB=[_2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalProject(DEPTNO=[_7], JOB=[_2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_7], JOB=[_2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullAggregateThroughUnion2">
        <Resource name="sql">
            <![CDATA[select deptno, job from (select deptno, job from emp as e1 group by deptno,job  union all select deptno, job from emp as e2 group by deptno,job) group by deptno,job]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], JOB=[_2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], JOB=[_2])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalProject(DEPTNO=[_7], JOB=[_2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_7], JOB=[_2])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullAggregateThroughUnionAndAddProjects">
        <Resource name="sql">
            <![CDATA[select job, deptno from (select job, deptno from emp as e1 group by job, deptno  union all select job, deptno from emp as e2 group by job, deptno) group by job, deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(JOB=[_2], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(JOB=[_2], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalProject(JOB=[_2], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(JOB=[_2], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullAggregateThroughUnionWithAlias">
        <Resource name="sql">
            <![CDATA[select job, c from (select job, deptno c from emp as e1 group by job, deptno  union all select job, deptno from emp as e2 group by job, deptno) group by job, c]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalUnion(all=[true])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(JOB=[_2], C=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(JOB=[_2], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalProject(JOB=[_0], C=[_1])
    LogicalUnion(all=[true])
      LogicalAggregate(group=[{2, 7}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(JOB=[_2], DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectWindowTransposeRule">
        <Resource name="sql">
            <![CDATA[select count(empno) over(), deptno from emp]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_2], DEPTNO=[_1])
  LogicalWindow(window#0=[window(partition {} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT(_0)])])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[COUNT(_0) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], DEPTNO=[_7])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectWindowTransposeRuleWithConstants">
        <Resource name="sql">
            <![CDATA[select col1, col2
from (
  select empno,
    sum(100) over (partition by  deptno order by sal) as col1,
  sum(1000) over(partition by deptno order by sal) as col2
  from emp)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(_0=[_2], _1=[_3])
  LogicalWindow(window#0=[window(partition {1} order by [0] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [SUM(_2), SUM(_3)])])
    LogicalProject(SAL=[_5], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(COL1=[SUM(100) OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], COL2=[SUM(1000) OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterWithRank">
        <Resource name="sql">
            <![CDATA[select e1.ename, r
from (
  select ename,   rank() over(partition by  deptno order by sal) as r   from emp) e1
where r < 2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_0], R=[_1])
  LogicalFilter(condition=[<(_1, 2)])
    LogicalProject(ENAME=[_1], R=[RANK() OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_0], R=[_1])
  LogicalFilter(condition=[<(_1, 2)])
    LogicalProject(ENAME=[_1], R=[RANK() OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterWithRankExpr">
        <Resource name="sql">
            <![CDATA[select e1.ename, r
from (
  select ename,
  rank() over(partition by  deptno order by sal) + 1 as r   from emp) e1
where r < 2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_0], R=[_1])
  LogicalFilter(condition=[<(_1, 2)])
    LogicalProject(ENAME=[_1], R=[+(RANK() OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_0], R=[_1])
  LogicalFilter(condition=[<(_1, 2)])
    LogicalProject(ENAME=[_1], R=[+(RANK() OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountWithoutGroupBy">
        <Resource name="sql">
            <![CDATA[select max(deptno), count(distinct ename)
from sales.emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[MAX(_0)], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[MIN(_1) FILTER _3], EXPR_1=[COUNT(_0) FILTER _2])
  LogicalProject(ENAME=[_0], EXPR_0=[_1], $g_0=[=(_2, 0)], $g_1=[=(_2, 1)])
    LogicalAggregate(group=[{1}], groups=[[{1}, {}]], EXPR_0=[MAX(_7)], $g=[GROUPING(_1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCount1">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct ename)
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[COUNT(_0)])
  LogicalAggregate(group=[{1, 7}])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCount2">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct ename), sum(sal)
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)], EXPR_2=[SUM(_2)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_1], EXPR_2=[CAST(_2):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], EXPR_1=[COUNT(_1) FILTER _3], EXPR_2=[MIN(_2) FILTER _4])
    LogicalProject(DEPTNO=[_0], ENAME=[_1], EXPR_2=[_2], $g_0=[=(_3, 0)], $g_1=[=(_3, 1)])
      LogicalProject(DEPTNO=[_1], ENAME=[_0], EXPR_2=[_2], $g=[_3])
        LogicalAggregate(group=[{1, 7}], groups=[[{1, 7}, {7}]], EXPR_2=[SUM(_5)], $g=[GROUPING(_7, _1)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountGroupingSets1">
        <Resource name="sql">
            <![CDATA[select deptno, job, count(distinct ename)
from sales.emp group by rollup(deptno,job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[COUNT(DISTINCT _2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], ENAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[COUNT(_2) FILTER _3])
  LogicalProject(DEPTNO=[_0], JOB=[_1], ENAME=[_2], $g_0=[=(_3, 0)])
    LogicalAggregate(group=[{0, 1, 2}], $g=[GROUPING(_0, _1, _2)])
      LogicalProject(DEPTNO=[_7], JOB=[_2], ENAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountGroupingSets2">
        <Resource name="sql">
            <![CDATA[select deptno, job, count(distinct ename), sum(sal)
from sales.emp group by rollup(deptno,job)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[COUNT(DISTINCT _2)], EXPR_3=[SUM(_3)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], ENAME=[_1], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], JOB=[_1], EXPR_2=[_2], EXPR_3=[CAST(_3):INTEGER NOT NULL])
  LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], EXPR_2=[COUNT(_2) FILTER _4], EXPR_3=[MIN(_3) FILTER _5])
    LogicalProject(DEPTNO=[_0], JOB=[_1], ENAME=[_2], EXPR_3=[_3], $g_0=[=(_4, 0)], $g_1=[=(_4, 1)])
      LogicalAggregate(group=[{0, 1, 2}], groups=[[{0, 1, 2}, {0, 1}]], EXPR_3=[SUM(_3)], $g=[GROUPING(_0, _1, _2)])
        LogicalProject(DEPTNO=[_7], JOB=[_2], ENAME=[_1], SAL=[_5])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testConvertMultiJoinRuleOuterJoins2">
        <Resource name="sql">
            <![CDATA[select * from A right join B on a = b join C on b = c]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(A=[_0], B=[_1], C=[_2])
  LogicalJoin(condition=[=(_1, _2)], joinType=[inner])
    LogicalJoin(condition=[=(_0, _1)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, A]])
      LogicalTableScan(table=[[CATALOG, SALES, B]])
    LogicalTableScan(table=[[CATALOG, SALES, C]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
MultiJoin(joinFilter=[=(_1, _2)], isFullOuterJoin=[false], joinTypes=[[INNER, INNER]], outerJoinConditions=[[NULL, NULL]], projFields=[[ALL, ALL]])
  MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[RIGHT, INNER]], outerJoinConditions=[[=(_0, _1), NULL]], projFields=[[ALL, ALL]])
    LogicalTableScan(table=[[CATALOG, SALES, A]])
    LogicalTableScan(table=[[CATALOG, SALES, B]])
  LogicalTableScan(table=[[CATALOG, SALES, C]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testConvertMultiJoinRuleOuterJoins3">
        <Resource name="sql">
            <![CDATA[select * from A join B on a = b left join C on b = c]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(A=[_0], B=[_1], C=[_2])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, A]])
      LogicalTableScan(table=[[CATALOG, SALES, B]])
    LogicalTableScan(table=[[CATALOG, SALES, C]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
MultiJoin(joinFilter=[=(_0, _1)], isFullOuterJoin=[false], joinTypes=[[INNER, INNER, LEFT]], outerJoinConditions=[[NULL, NULL, =(_1, _2)]], projFields=[[ALL, ALL, ALL]])
  LogicalTableScan(table=[[CATALOG, SALES, A]])
  LogicalTableScan(table=[[CATALOG, SALES, B]])
  LogicalTableScan(table=[[CATALOG, SALES, C]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testConvertMultiJoinRuleOuterJoins4">
        <Resource name="sql">
            <![CDATA[select * from A join B on a = b right join C on b = c]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(A=[_0], B=[_1], C=[_2])
  LogicalJoin(condition=[=(_1, _2)], joinType=[right])
    LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, A]])
      LogicalTableScan(table=[[CATALOG, SALES, B]])
    LogicalTableScan(table=[[CATALOG, SALES, C]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[RIGHT, INNER]], outerJoinConditions=[[=(_1, _2), NULL]], projFields=[[ALL, ALL]])
  MultiJoin(joinFilter=[=(_0, _1)], isFullOuterJoin=[false], joinTypes=[[INNER, INNER]], outerJoinConditions=[[NULL, NULL]], projFields=[[ALL, ALL]])
    LogicalTableScan(table=[[CATALOG, SALES, A]])
    LogicalTableScan(table=[[CATALOG, SALES, B]])
  LogicalTableScan(table=[[CATALOG, SALES, C]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastAggTwo">
        <Resource name="sql">
            <![CDATA[select dept1.c1 from (
select dept.name as c1, count(*) as c2
from dept where dept.name > 'b' group by dept.name) dept1
where dept1.c1 > 'c' and (dept1.c2 > 30 or dept1.c1 < 'z')]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(C1=[_0])
  LogicalFilter(condition=[AND(>(_0, 'c'), OR(>(_1, 30), <(_0, 'z')))])
    LogicalAggregate(group=[{0}], C2=[COUNT()])
      LogicalProject(C1=[_1])
        LogicalFilter(condition=[>(_1, 'b')])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(C1=[_0])
  LogicalFilter(condition=[OR(>(_1, 30), <(_0, 'z'))])
    LogicalAggregate(group=[{0}], C2=[COUNT()])
      LogicalFilter(condition=[>(_0, 'c')])
        LogicalProject(C1=[_1])
          LogicalFilter(condition=[>(_1, 'b')])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastProject">
        <Resource name="sql">
            <![CDATA[select a.name
from dept a
left join dept b on b.deptno > 10
right join dept c on b.deptno > 10
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalJoin(condition=[_4], joinType=[right])
    LogicalProject(DEPTNO=[_0], NAME=[_1], DEPTNO0=[_2], NAME0=[_3], _f4=[>(_2, 10)])
      LogicalJoin(condition=[_4], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[>(_0, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalJoin(condition=[true], joinType=[right])
    LogicalProject(DEPTNO=[_0], NAME=[_1], DEPTNO0=[_2], NAME0=[_3], _f4=[>(_2, 10)])
      LogicalProject(DEPTNO=[_0], NAME=[_1], DEPTNO0=[CAST(_2):INTEGER], NAME0=[CAST(_3):VARCHAR(10)], _f2=[CAST(_4):BOOLEAN])
        LogicalJoin(condition=[true], joinType=[inner])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
          LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[>(_0, 10)])
            LogicalFilter(condition=[>(_0, 10)])
              LogicalFilter(condition=[>(_0, 10)])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose1">
        <Resource name="sql">
            <![CDATA[select a.name
from dept a
left join dept b on b.deptno > 10
right join dept c on b.deptno > 10
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_0])
  LogicalJoin(condition=[_1], joinType=[right])
    LogicalProject(NAME=[_1], _f4=[_5])
      LogicalJoin(condition=[_4], joinType=[left])
        LogicalProject(DEPTNO=[_0], NAME=[_1])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[>(_0, 10)], >=[>(_0, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalJoin(condition=[>(_2, 10)], joinType=[right])
    LogicalJoin(condition=[>(_2, 10)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose2">
        <Resource name="sql">
            <![CDATA[select *
from dept a
left join (select name, 1 from dept) as b
on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose3">
        <Resource name="sql">
            <![CDATA[select *
from (select name, 1 from dept) as a
right join dept b
on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], DEPTNO=[_2], NAME0=[_3])
  LogicalJoin(condition=[=(_0, _3)], joinType=[right])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], DEPTNO=[_2], NAME0=[_3])
  LogicalJoin(condition=[=(_0, _3)], joinType=[right])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose4">
        <Resource name="sql">
            <![CDATA[select *
from dept a
left join (select x name, y is not null from
(values (2, cast(null as integer)), (2, 1)) as t(x, y)) b
on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_3], EXPR_1=[_4])
  LogicalJoin(condition=[=(_2, _3)], joinType=[left])
    LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[CAST(_1):INTEGER NOT NULL])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_0], EXPR_1=[IS NOT NULL(_1)])
      LogicalUnion(all=[true])
        LogicalProject(EXPR_0=[2], EXPR_1=[null:INTEGER])
          LogicalValues(tuples=[[{ 0 }]])
        LogicalProject(EXPR_0=[2], EXPR_1=[1])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_0], EXPR_1=[IS NOT NULL(_1)])
      LogicalUnion(all=[true])
        LogicalProject(EXPR_0=[2], EXPR_1=[null:INTEGER])
          LogicalValues(tuples=[[{ 0 }]])
        LogicalProject(EXPR_0=[2], EXPR_1=[1])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose5">
        <Resource name="sql">
            <![CDATA[select *
from dept a
left join (select name, 1 + 1 from dept) as b
on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[+(1, 1)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[+(1, 1)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose6">
        <Resource name="sql">
            <![CDATA[select *
from (select name, 1 from dept) a
full join (select name, 1 from dept) as b
on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], NAME0=[_2], EXPR_10=[_3])
  LogicalJoin(condition=[=(_0, _2)], joinType=[full])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], NAME0=[_2], EXPR_10=[_3])
  LogicalJoin(condition=[=(_0, _2)], joinType=[full])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose7">
        <Resource name="sql">
            <![CDATA[select *
from dept a
left join (select name from dept) as b
 on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2])
  LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_3])
    LogicalJoin(condition=[=(_1, _3)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinProjectTranspose8">
        <Resource name="sql">
            <![CDATA[select *
from dept a
left join (
  select name, deptno > 10 and cast(null as boolean)
  from dept) as b
on a.name = b.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalJoin(condition=[=(_1, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(NAME=[_1], EXPR_1=[AND(>(_0, 10), null)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_2], EXPR_1=[_3])
  LogicalProject(DEPTNO=[_0], NAME=[_1], NAME0=[_3], EXPR_1=[AND(>(_2, 10), null)])
    LogicalJoin(condition=[=(_1, _3)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeFilter">
        <Resource name="sql">
            <![CDATA[select name from (
  select *
  from dept
  where deptno = 10)
where deptno = 10
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalFilter(condition=[=(_0, 10)])
    LogicalProject(DEPTNO=[_0], NAME=[_1])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalProject(DEPTNO=[_0], NAME=[_1])
    LogicalFilter(condition=[=(_0, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMergeJoinFilter">
        <Resource name="sql">
            <![CDATA[select * from (
  select d.deptno, e.ename
  from emp as e
  join dept as d
  on e.deptno = d.deptno
  and d.deptno = 10)
where deptno = 10
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], ENAME=[_1])
  LogicalFilter(condition=[=(_0, 10)])
    LogicalProject(DEPTNO=[_9], ENAME=[_1])
      LogicalJoin(condition=[AND(=(_7, _9), =(_9, 10))], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], ENAME=[_1])
  LogicalProject(DEPTNO=[_9], ENAME=[_1])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCase">
        <Resource name="sql">
            <![CDATA[select
  case when false then cast(2.1 as float)
   else cast(1 as integer) end as newcol
from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NEWCOL=[CASE(false, 2.1:FLOAT, 1:FLOAT)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NEWCOL=[1E0:FLOAT])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCastTimeUnchanged">
        <Resource name="sql">
            <![CDATA[select cast(time '12:34:56' as timestamp) from emp as e]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(12:34:56):TIMESTAMP(0) NOT NULL])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCompositeInSubQuery">
        <Resource name="sql">
            <![CDATA[select *
from emp
where (empno, deptno) in (
  select empno, deptno from (
    select empno, deptno
    from emp
    group by empno, deptno))
or deptno < 40 + 60]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[OR(IN(_0, _7, {
LogicalProject(EMPNO=[_0], DEPTNO=[_1])
  LogicalAggregate(group=[{0, 1}])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), <(_7, +(40, 60)))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[OR(IN(_0, _7, {
LogicalProject(EMPNO=[_0], DEPTNO=[_1])
  LogicalAggregate(group=[{0, 1}])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), <(_7, 100))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsRequiresExecutor">
        <Resource name="sql">
            <![CDATA[select * from (values (1,2)) where 1 + 2 > 3 + CAST(NULL AS INTEGER)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
  LogicalFilter(condition=[>(+(1, 2), +(3, null))])
    LogicalValues(tuples=[[{ 1, 2 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_0], EXPR_1=[_1])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpressionInWindowFunction">
        <Resource name="sql">
            <![CDATA[select
 sum(deptno) over(partition by deptno order by sal) as sum1,
sum(deptno + sal) over(partition by deptno order by sal) as sum2
from emp]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(_0=[_3], _1=[_4])
  LogicalWindow(window#0=[window(partition {1} order by [0] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [SUM(_1), SUM(_2)])])
    LogicalProject(SAL=[_5], DEPTNO=[_7], _2=[+(_7, _5)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SUM1=[SUM(_7) OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], SUM2=[SUM(+(_7, _5)) OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoin1">
        <Resource name="sql">
            <![CDATA[select e.job,d.name
from (select * from sales.emp where ename = 'A') as e
join sales.dept as d on e.job = d.name
group by e.job,d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2, 10}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
  LogicalAggregate(group=[{2}])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalAggregate(group=[{1}])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoin2">
        <Resource name="sql">
            <![CDATA[select e.job,d.name
from (select * from sales.emp where ename = 'A') as e
join sales.dept as d on e.job = d.name
and e.deptno + e.empno = d.deptno + 5
group by e.job,d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{2, 11}])
  LogicalJoin(condition=[AND(=(_2, _11), =(_9, _12))], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 2}])
  LogicalJoin(condition=[AND(=(_0, _2), =(_1, _3))], joinType=[inner])
    LogicalAggregate(group=[{2, 9}])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_7, _0)])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1, 2}])
      LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 5)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoin3">
        <Resource name="sql">
            <![CDATA[select e.empno,d.deptno
from (select * from sales.emp where empno = 10) as e
join sales.dept as d on e.empno < d.deptno
group by e.empno,d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 9}])
  LogicalJoin(condition=[<(_0, _9)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 9}])
  LogicalJoin(condition=[<(_0, _9)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoin4">
        <Resource name="sql">
            <![CDATA[select e.deptno
from sales.emp as e join sales.dept as d on e.deptno = d.deptno
group by e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{7}])
  LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
    LogicalAggregate(group=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoin5">
        <Resource name="sql">
            <![CDATA[select e.deptno, d.deptno
from sales.emp as e join sales.dept as d on e.deptno = d.deptno
group by e.deptno, d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], DEPTNO0=[_1])
  LogicalAggregate(group=[{7, 9}])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], DEPTNO0=[_1])
  LogicalJoin(condition=[=(_0, _1)], joinType=[inner])
    LogicalAggregate(group=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoin6">
        <Resource name="sql">
            <![CDATA[select sum(B.sal)
from sales.emp as A
join (select distinct sal from sales.emp) as B
on A.sal=B.sal
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_9)])
  LogicalJoin(condition=[=(_5, _9)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{5}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_3)])
  LogicalProject(SAL=[_0], _f1=[_1], SAL0=[_2], _f3=[CAST(*(_1, _2)):INTEGER])
    LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
      LogicalAggregate(group=[{5}], agg#0=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{5}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoinWithUniqueInput">
        <Resource name="sql">
            <![CDATA[select A.job, B.mgr, A.deptno,
max(B.hiredate1) as hiredate1, sum(B.comm1) as comm1
from sales.emp as A
join (select mgr, sal, max(hiredate) as hiredate1,
    sum(comm) as comm1 from sales.emp group by mgr, sal) as B
on A.sal=B.sal
group by A.job, B.mgr, A.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(JOB=[_0], MGR0=[_2], DEPTNO=[_1], HIREDATE1=[_3], COMM1=[_4])
  LogicalAggregate(group=[{2, 7, 9}], HIREDATE1=[MAX(_11)], COMM1=[SUM(_12)])
    LogicalJoin(condition=[=(_5, _10)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{3, 5}], HIREDATE1=[MAX(_4)], COMM1=[SUM(_6)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_0], MGR0=[_2], DEPTNO=[_1], HIREDATE1=[_3], COMM1=[_4])
  LogicalAggregate(group=[{0, 2, 4}], HIREDATE1=[MAX(_6)], COMM1=[SUM(_8)])
    LogicalProject(JOB=[_0], SAL=[_1], DEPTNO=[_2], _f3=[_3], MGR=[_4], SAL0=[_5], HIREDATE1=[_6], COMM1=[_7], _f8=[CAST(*(_3, _7)):INTEGER NOT NULL])
      LogicalJoin(condition=[=(_1, _5)], joinType=[inner])
        LogicalAggregate(group=[{2, 5, 7}], agg#0=[COUNT()])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{3, 5}], HIREDATE1=[MAX(_4)], COMM1=[SUM(_6)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateSumThroughJoin">
        <Resource name="sql">
            <![CDATA[select e.job,sum(sal)
from (select * from sales.emp where ename = 'A') as e
join sales.dept as d on e.job = d.name
group by e.job,d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(JOB=[_0], EXPR_1=[_2])
  LogicalAggregate(group=[{2, 10}], EXPR_1=[SUM(_5)])
    LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalFilter(condition=[=(_1, 'A')])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_0], EXPR_1=[_2])
  LogicalProject(JOB=[_0], NAME=[_2], _f4=[CAST(*(_1, _3)):INTEGER NOT NULL])
    LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
      LogicalAggregate(group=[{2}], EXPR_1=[SUM(_5)])
        LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
          LogicalFilter(condition=[=(_1, 'A')])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{1}], agg#0=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateSumWithoutGroupKeyThroughJoin">
        <Resource name="sql">
            <![CDATA[select sum(sal)
from (select * from sales.emp where ename = 'A') as e
join sales.dept as d on e.job = d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_5)])
  LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_4)])
  LogicalProject(JOB=[_0], EXPR_0=[_1], NAME=[_2], _f1=[_3], _f4=[CAST(*(_1, _3)):INTEGER])
    LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
      LogicalAggregate(group=[{2}], EXPR_0=[SUM(_5)])
        LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
          LogicalFilter(condition=[=(_1, 'A')])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{1}], agg#0=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateSumThroughJoinAfterAggregateReduce">
        <Resource name="sql">
            <![CDATA[select sum(sal)
from (select * from sales.emp where ename = 'A') as e
join sales.dept as d on e.job = d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_5)])
  LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalFilter(condition=[=(_1, 'A')])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[CASE(=(_1, 0), null:INTEGER, _0)])
  LogicalAggregate(group=[{}], EXPR_0=[$SUM0(_5)], agg#1=[$SUM0(_6)])
    LogicalProject(JOB=[_0], EXPR_0=[_1], _f2=[_2], NAME=[_3], _f1=[_4], _f5=[CAST(*(_1, _4)):INTEGER NOT NULL], _f6=[*(_2, _4)])
      LogicalJoin(condition=[=(_0, _3)], joinType=[inner])
        LogicalAggregate(group=[{2}], EXPR_0=[$SUM0(_5)], agg#1=[COUNT()])
          LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
            LogicalFilter(condition=[=(_1, 'A')])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{1}], agg#0=[COUNT()])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCaseNullabilityChange">
        <Resource name="sql">
            <![CDATA[select case when empno = 1 then 1
when 1 IS NOT NULL then 2
else null end as qx from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(QX=[CASE(=(_0, 1), 1, IS NOT NULL(1), 2, null:INTEGER)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(QX=[CAST(CASE(=(_0, 1), 1, 2)):INTEGER])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceCastsNullable">
        <Resource name="sql">
            <![CDATA[insert into sales.dept(deptno, name)
select empno, cast(job as varchar(128)) from sales.empnullables]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalTableModify(table=[[CATALOG, SALES, DEPT]], operation=[INSERT], flattened=[false])
  LogicalProject(DEPTNO=[_0], NAME=[CAST(_2):VARCHAR(128)])
    LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalTableModify(table=[[CATALOG, SALES, DEPT]], operation=[INSERT], flattened=[false])
  LogicalCalc(expr#0..8=[{inputs}], expr#9=[CAST(_t2):VARCHAR(128)], expr#10=[CAST(_t9):VARCHAR(10) NOT NULL], DEPTNO=[_t0], NAME=[_t10])
    LogicalTableScan(table=[[CATALOG, SALES, EMPNULLABLES]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstants3">
        <Resource name="sql">
            <![CDATA[select e.mgr is not distinct from f.mgr from emp e join emp f on (e.mgr=f.mgr) where e.mgr is null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[OR(AND(IS NULL(_3), IS NULL(_12)), IS TRUE(=(_3, _12)))])
  LogicalFilter(condition=[IS NULL(_3)])
    LogicalJoin(condition=[=(_3, _12)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[IS NULL(_12)])
  LogicalFilter(condition=[IS NULL(_3)])
    LogicalJoin(condition=[=(_3, _12)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDynamicFunction">
        <Resource name="sql">
            <![CDATA[select sal, t
from (select sal, current_timestamp t from emp)
where t > TIMESTAMP '2018-01-01 00:00:00']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_0], T=[_1])
  LogicalFilter(condition=[>(_1, 2018-01-01 00:00:00)])
    LogicalProject(SAL=[_5], T=[CURRENT_TIMESTAMP])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_0], T=[_1])
  LogicalFilter(condition=[>(_1, 2018-01-01 00:00:00)])
    LogicalProject(SAL=[_5], T=[CURRENT_TIMESTAMP])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsIsNotNull">
        <Resource name="sql">
            <![CDATA[select empno from emp
where empno=10 and empno is not null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[AND(=(_0, 10), IS NOT NULL(_0))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[=(_0, 10)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsIsNull">
        <Resource name="sql">
            <![CDATA[select empno from emp where empno=10 and empno is null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[AND(=(_0, 10), IS NULL(_0))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsNegated">
        <Resource name="sql">
            <![CDATA[select empno from emp
where empno=10 and not(empno=10)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[AND(=(_0, 10), NOT(=(_0, 10)))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsNegatedInverted">
        <Resource name="sql">
            <![CDATA[select empno from emp where empno>10 and empno<=10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[AND(>(_0, 10), <=(_0, 10))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsNull">
        <Resource name="sql">
            <![CDATA[select * from (
  select *
  from (
    select cast(null as integer) as n
    from emp)
  where n is null and n is null)
where n is null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(N=[_0])
  LogicalFilter(condition=[IS NULL(_0)])
    LogicalProject(N=[_0])
      LogicalFilter(condition=[AND(IS NULL(_0), IS NULL(_0))])
        LogicalProject(N=[null:INTEGER])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(N=[_0])
  LogicalProject(N=[_0])
    LogicalProject(N=[null:INTEGER])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSwapOuterJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d left outer join sales.emp e
 on d.deptno = e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalJoin(condition=[=(_0, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[1])
  LogicalProject(DEPTNO=[_9], NAME=[_10], EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO0=[_7], SLACKER=[_8])
    LogicalJoin(condition=[=(_9, _7)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountMultipleViaJoin">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct ename), count(distinct job, ename),
count(distinct deptno, job), sum(sal)
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)], EXPR_2=[COUNT(DISTINCT _2, _1)], EXPR_3=[COUNT(DISTINCT _0, _2)], EXPR_4=[SUM(_3)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], JOB=[_2], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_3], EXPR_2=[_5], EXPR_3=[_7], EXPR_4=[_1])
  LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _6)], joinType=[inner])
    LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _4)], joinType=[inner])
      LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _2)], joinType=[inner])
        LogicalAggregate(group=[{7}], EXPR_4=[SUM(_5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{1}], EXPR_1=[COUNT(_0)])
          LogicalAggregate(group=[{1, 7}])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{2}], EXPR_2=[COUNT(_1, _0)])
        LogicalAggregate(group=[{1, 2, 7}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}], EXPR_3=[COUNT(_1, _0)])
      LogicalAggregate(group=[{2, 7}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountMultiple">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct ename), count(distinct job)
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)], EXPR_2=[COUNT(DISTINCT _2)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], JOB=[_2])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(_1) FILTER _3], EXPR_2=[COUNT(_2) FILTER _4])
  LogicalProject(DEPTNO=[_0], ENAME=[_1], JOB=[_2], $g_1=[=(_3, 1)], $g_2=[=(_3, 2)])
    LogicalProject(DEPTNO=[_2], ENAME=[_0], JOB=[_1], $g=[_3])
      LogicalAggregate(group=[{1, 2, 7}], groups=[[{1, 7}, {2, 7}]], $g=[GROUPING(_7, _1, _2)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountMultipleNoGroup">
        <Resource name="sql">
            <![CDATA[select count(distinct ename), count(distinct job)
from sales.emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT(DISTINCT _0)], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(ENAME=[_1], JOB=[_2])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT(_0) FILTER _2], EXPR_1=[COUNT(_1) FILTER _3])
  LogicalProject(ENAME=[_0], JOB=[_1], $g_1=[=(_2, 1)], $g_2=[=(_2, 2)])
    LogicalAggregate(group=[{1, 2}], groups=[[{1}, {2}]], $g=[GROUPING(_1, _2)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountMixed">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct deptno, job) as cddj, sum(sal) as s
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], CDDJ=[COUNT(DISTINCT _0, _1)], S=[SUM(_2)])
  LogicalProject(DEPTNO=[_7], JOB=[_2], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], CDDJ=[_1], S=[CAST(_2):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], CDDJ=[COUNT(_0, _1) FILTER _3], S=[MIN(_2) FILTER _4])
    LogicalProject(DEPTNO=[_0], JOB=[_1], S=[_2], $g_0=[=(_3, 0)], $g_1=[=(_3, 1)])
      LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}]], S=[SUM(_2)], $g=[GROUPING(_0, _1)])
        LogicalProject(DEPTNO=[_7], JOB=[_2], SAL=[_5])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountMixedJoin">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct ename), count(distinct job, ename),
count(distinct deptno, job), sum(sal)
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)], EXPR_2=[COUNT(DISTINCT _2, _1)], EXPR_3=[COUNT(DISTINCT _0, _2)], EXPR_4=[SUM(_3)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], JOB=[_2], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_3], EXPR_2=[_5], EXPR_3=[_7], EXPR_4=[_1])
  LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _6)], joinType=[inner])
    LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _4)], joinType=[inner])
      LogicalJoin(condition=[IS NOT DISTINCT FROM(_0, _2)], joinType=[inner])
        LogicalAggregate(group=[{7}], EXPR_4=[SUM(_5)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{1}], EXPR_1=[COUNT(_0)])
          LogicalAggregate(group=[{1, 7}])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{2}], EXPR_2=[COUNT(_1, _0)])
        LogicalAggregate(group=[{1, 2, 7}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}], EXPR_3=[COUNT(_1, _0)])
      LogicalAggregate(group=[{2, 7}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctCountMixed2">
        <Resource name="sql">
            <![CDATA[select deptno, count(distinct ename) as cde,
count(distinct job, ename) as cdje,
count(distinct deptno, job) as cddj,
sum(sal) as s
from sales.emp group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], CDE=[COUNT(DISTINCT _1)], CDJE=[COUNT(DISTINCT _2, _1)], CDDJ=[COUNT(DISTINCT _0, _2)], S=[SUM(_3)])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], JOB=[_2], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], CDE=[_1], CDJE=[_2], CDDJ=[_3], S=[CAST(_4):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], CDE=[COUNT(_1) FILTER _5], CDJE=[COUNT(_2, _1) FILTER _4], CDDJ=[COUNT(_0, _2) FILTER _6], S=[MIN(_3) FILTER _7])
    LogicalProject(DEPTNO=[_2], ENAME=[_0], JOB=[_1], S=[_3], $g_0=[=(_4, 0)], $g_1=[=(_4, 1)], $g_2=[=(_4, 2)], $g_3=[=(_4, 3)])
      LogicalAggregate(group=[{1, 2, 7}], groups=[[{1, 2, 7}, {1, 7}, {2, 7}, {7}]], S=[SUM(_5)], $g=[GROUPING(_7, _1, _2)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushJoinCondDownToProject">
        <Resource name="sql">
            <![CDATA[select d.deptno, e.deptno from sales.dept d, sales.emp e
 where d.deptno + 10 = e.deptno * 2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], DEPTNO0=[_9])
  LogicalFilter(condition=[=(+(_0, 10), *(_9, 2))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], DEPTNO0=[_9])
  LogicalProject(DEPTNO=[_0], NAME=[_1], EMPNO=[_3], ENAME=[_4], JOB=[_5], MGR=[_6], HIREDATE=[_7], SAL=[_8], COMM=[_9], DEPTNO0=[_10], SLACKER=[_11])
    LogicalJoin(condition=[=(_2, _12)], joinType=[inner])
      LogicalProject(DEPTNO=[_0], NAME=[_1], _f2=[+(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[*(_7, 2)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsNonDeterministicFunction">
        <Resource name="sql">
            <![CDATA[select sal, r
from (select sal, rand() as r from emp)
where r > 0.5]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalFilter(condition=[>(_1, 10)])
  LogicalProject(SAL=[_5], N=[NDC()])
    LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalFilter(condition=[>(_1, 10)])
  LogicalProject(SAL=[_5], N=[NDC()])
    LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsNullEqualsOne">
        <Resource name="sql">
            <![CDATA[select count(1) from emp where cast(null as integer) = 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[=(null, 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsCaseEquals">
        <Resource name="sql">
            <![CDATA[select count(1) from emp
where case deptno
  when 20 then 2
  when 10 then 1
  else 3 end = 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[=(CASE(=(_7, 20), 2, =(_7, 10), 1, 3), 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsCaseEquals2">
        <Resource name="sql">
            <![CDATA[select count(1) from emp
where case deptno
  when 20 then 2
  when 10 then 1
  else cast(null as integer) end = 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[=(CASE(=(_7, 20), 2, =(_7, 10), 1, null:INTEGER), 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[=(_7, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsCaseEquals3">
        <Resource name="sql">
            <![CDATA[select count(1) from emp
where case deptno
  when 30 then 1
  when 20 then 2
  when 10 then 1
  when 30 then 111
  else 0 end = 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[=(CASE(=(_7, 30), 1, =(_7, 20), 2, =(_7, 10), 1, =(_7, 30), 111, 0), 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalProject(_f0=[1])
    LogicalFilter(condition=[OR(=(_7, 30), =(_7, 10))])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSkipReduceConstantsCaseEquals">
        <Resource name="sql">
            <![CDATA[select * from emp e1, emp e2
where coalesce(e1.mgr, -1) = coalesce(e2.mgr, -1)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], EMPNO0=[_9], ENAME0=[_10], JOB0=[_11], MGR0=[_12], HIREDATE0=[_13], SAL0=[_14], COMM0=[_15], DEPTNO0=[_16], SLACKER0=[_17])
  LogicalFilter(condition=[=(CASE(IS NOT NULL(_3), _3, -1), CASE(IS NOT NULL(_12), _12, -1))])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], EMPNO0=[_9], ENAME0=[_10], JOB0=[_11], MGR0=[_12], HIREDATE0=[_13], SAL0=[_14], COMM0=[_15], DEPTNO0=[_16], SLACKER0=[_17])
  LogicalJoin(condition=[=(CASE(IS NOT NULL(_3), _3, -1), CASE(IS NOT NULL(_12), _12, -1))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterPastAggThree">
        <Resource name="sql">
            <![CDATA[select deptno from emp
group by deptno having count(*) > 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[>(_1, 1)])
    LogicalAggregate(group=[{0}], agg#0=[COUNT()])
      LogicalProject(DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[>(_1, 1)])
    LogicalAggregate(group=[{0}], agg#0=[COUNT()])
      LogicalProject(DEPTNO=[_7])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateFunctionsThroughJoin">
        <Resource name="sql">
            <![CDATA[select e.job,
  min(sal) as min_sal, min(e.deptno) as min_deptno,
  sum(sal) + 1 as sum_sal_plus, max(sal) as max_sal,
  sum(sal) as sum_sal_2, count(sal) as count_sal,
  count(mgr) as count_mgr
from sales.emp as e
join sales.dept as d on e.job = d.name
group by e.job,d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(JOB=[_0], MIN_SAL=[_2], MIN_DEPTNO=[_3], SUM_SAL_PLUS=[+(_4, 1)], MAX_SAL=[_5], SUM_SAL_2=[_4], COUNT_SAL=[_6], COUNT_MGR=[_7])
  LogicalAggregate(group=[{2, 10}], MIN_SAL=[MIN(_5)], MIN_DEPTNO=[MIN(_7)], SUM_SAL_2=[SUM(_5)], MAX_SAL=[MAX(_5)], COUNT_SAL=[COUNT()], COUNT_MGR=[COUNT(_3)])
    LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_0], MIN_SAL=[_2], MIN_DEPTNO=[_3], SUM_SAL_PLUS=[+(_4, 1)], MAX_SAL=[_5], SUM_SAL_2=[_4], COUNT_SAL=[_6], COUNT_MGR=[_7])
  LogicalProject(JOB=[_0], NAME=[_7], MIN_SAL=[_1], MIN_DEPTNO=[_2], _f9=[CAST(*(_3, _8)):INTEGER NOT NULL], MAX_SAL=[_4], _f10=[*(_5, _8)], _f11=[*(_6, _8)])
    LogicalJoin(condition=[=(_0, _7)], joinType=[inner])
      LogicalAggregate(group=[{2}], MIN_SAL=[MIN(_5)], MIN_DEPTNO=[MIN(_7)], SUM_SAL_2=[SUM(_5)], MAX_SAL=[MAX(_5)], COUNT_SAL=[COUNT()], COUNT_MGR=[COUNT(_3)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{1}], agg#0=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateSumNoGroup">
        <Resource name="sql">
            <![CDATA[select count(*) from sales.emp join sales.dept on job = name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT()])
  LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[$SUM0(_4)])
  LogicalProject(JOB=[_0], EXPR_0=[_1], NAME=[_2], EXPR_00=[_3], _f4=[*(_1, _3)])
    LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
      LogicalAggregate(group=[{2}], EXPR_0=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{1}], EXPR_0=[COUNT()])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoinOnEmptyLogicalValues">
        <Resource name="sql">
            <![CDATA[select count(*) volume, sum(C1.sal) C1_sum_sal from (select sal, ename from sales.emp where 1=2) C1 inner join (select ename from sales.emp) C2   on C1.ename = C2.ename ]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], VOLUME=[COUNT()], C1_SUM_SAL=[SUM(_0)])
  LogicalJoin(condition=[=(_1, _2)], joinType=[inner])
    LogicalProject(SAL=[_5], ENAME=[_1])
      LogicalValues(tuples=[[]])
    LogicalProject(ENAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], VOLUME=[$SUM0(_3)], C1_SUM_SAL=[SUM(_4)])
  LogicalProject(ENAME=[_0], SAL=[_1], ENAME0=[_2], VOLUME=[_3], _f4=[CAST(*(_1, _3)):INTEGER])
    LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
      LogicalProject(ENAME=[_1], SAL=[_0])
        LogicalProject(SAL=[_5], ENAME=[_1])
          LogicalValues(tuples=[[]])
      LogicalAggregate(group=[{0}], VOLUME=[COUNT()])
        LogicalProject(ENAME=[_1])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushDistinctAggregateIntoJoin">
        <Resource name="sql">
            <![CDATA[select count(distinct sal) from sales.emp join sales.dept on job = name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT(DISTINCT _0)])
  LogicalProject(SAL=[_5])
    LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[COUNT(DISTINCT _5)])
  LogicalJoin(condition=[=(_2, _10)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemoveRule1">
        <Resource name="sql">
            <![CDATA[select count(distinct sal) from sales.emp e
left outer join sales.dept d1 on e.job = d1.name
left outer join sales.dept d2 on e.job = d2.name
group by e.job
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(JOB=[_2], NAME0=[_12])
    LogicalJoin(condition=[=(_2, _12)], joinType=[left])
      LogicalJoin(condition=[=(_2, _10)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{2}], EXPR_1=[COUNT(DISTINCT _10)])
  LogicalJoin(condition=[=(_2, _10)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemoveRule2">
        <Resource name="sql">
            <![CDATA[select count(distinct sal) from sales.emp e
left outer join sales.dept d1 on e.job = d1.name
left outer join sales.dept d2 on e.job = d2.name
group by e.job
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalProject(JOB=[_2], NAME=[_12])
    LogicalJoin(condition=[=(_2, _12)], joinType=[left])
      LogicalJoin(condition=[=(_2, _10)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{2, 10}])
  LogicalJoin(condition=[=(_2, _10)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushAggregateThroughJoinDistinct">
        <Resource name="sql">
            <![CDATA[select d.name,
  sum(sal) as sum_sal, count(*) as c
from sales.emp as e
join (select distinct name from sales.dept) as d
  on e.job = d.name
group by d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{9}], SUM_SAL=[SUM(_5)], C=[COUNT()])
  LogicalJoin(condition=[=(_2, _9)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_3], SUM_SAL=[_1], C=[_2])
  LogicalJoin(condition=[=(_0, _3)], joinType=[inner])
    LogicalAggregate(group=[{2}], SUM_SAL=[SUM(_5)], C=[COUNT()])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{1}])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge1">
        <Resource name="sql">
            <![CDATA[select deptno c, min(y), max(z) z,
sum(r), sum(m) n, sum(x) sal from (
   select deptno, ename, sum(sal) x, max(sal) z,
      min(sal) y, count(hiredate) m, count(mgr) r
   from sales.emp group by deptno, ename) t
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[MIN(_4)], Z=[MAX(_3)], EXPR_3=[SUM(_6)], N=[SUM(_5)], SAL=[SUM(_2)])
  LogicalAggregate(group=[{1, 7}], X=[SUM(_5)], Z=[MAX(_5)], Y=[MIN(_5)], M=[COUNT()], R=[COUNT(_3)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}], EXPR_1=[MIN(_5)], Z=[MAX(_5)], EXPR_3=[COUNT(_3)], N=[COUNT()], SAL=[SUM(_5)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge2">
        <Resource name="sql">
            <![CDATA[select deptno, empno, sum(x), sum(y)
from (
  select ename, empno, deptno, sum(sal) x, count(mgr) y
    from sales.emp
  group by deptno, ename, empno) t
group by grouping sets(deptno, empno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_1], EMPNO=[_0], EXPR_2=[_2], EXPR_3=[_3])
  LogicalAggregate(group=[{0, 2}], groups=[[{0}, {2}]], EXPR_2=[SUM(_3)], EXPR_3=[SUM(_4)])
    LogicalAggregate(group=[{0, 1, 7}], X=[SUM(_5)], Y=[COUNT(_3)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_1], EMPNO=[_0], EXPR_2=[_2], EXPR_3=[_3])
  LogicalAggregate(group=[{0, 7}], groups=[[{0}, {7}]], EXPR_2=[SUM(_5)], EXPR_3=[COUNT(_3)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge3">
        <Resource name="sql">
            <![CDATA[select deptno, sum(x) from (
 select ename, deptno, sum(sal) x from
   sales.emp group by cube(deptno, ename)) t
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[SUM(_2)])
  LogicalAggregate(group=[{1, 7}], groups=[[{1, 7}, {1}, {7}, {}]], X=[SUM(_5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[SUM(_2)])
  LogicalAggregate(group=[{1, 7}], groups=[[{1, 7}, {1}, {7}, {}]], X=[SUM(_5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge4">
        <Resource name="sql">
            <![CDATA[select deptno, sum(x) from (
  select ename, deptno, count(distinct sal) x
    from sales.emp group by deptno, ename) t
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[SUM(_2)])
  LogicalAggregate(group=[{1, 7}], X=[COUNT(DISTINCT _5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[SUM(_2)])
  LogicalAggregate(group=[{1, 7}], X=[COUNT(DISTINCT _5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge5">
        <Resource name="sql">
            <![CDATA[select deptno, avg(x) from (
  select mgr, deptno, avg(sal) x from
    sales.emp group by deptno, mgr) t
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[AVG(_2)])
  LogicalAggregate(group=[{3, 7}], X=[AVG(_5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{1}], EXPR_1=[AVG(_2)])
  LogicalAggregate(group=[{3, 7}], X=[AVG(_5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge6">
        <Resource name="sql">
            <![CDATA[select sum(x) from (
select mgr, deptno, count(sal) x from
sales.emp group by deptno, mgr) t]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_2)])
  LogicalAggregate(group=[{3, 7}], X=[COUNT()])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_2)])
  LogicalAggregate(group=[{3, 7}], X=[COUNT()])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge7">
        <Resource name="sql">
            <![CDATA[select mgr, deptno, sum(x) from (
  select mgr, deptno, count(sal) x from
    sales.emp group by deptno, mgr) t
group by cube(mgr, deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {1}, {}]], EXPR_2=[SUM(_2)])
  LogicalAggregate(group=[{3, 7}], X=[COUNT()])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {1}, {}]], EXPR_2=[SUM(_2)])
  LogicalAggregate(group=[{3, 7}], X=[COUNT()])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateMerge8">
        <Resource name="sql">
            <![CDATA[select sum(x) x, min(y) z from (
  select sum(sal) x, min(sal) y from sales.emp)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], X=[SUM(_0)], Z=[MIN(_1)])
  LogicalAggregate(group=[{}], X=[SUM(_5)], Y=[MIN(_5)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], X=[SUM(_5)], Z=[MIN(_5)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove1">
        <Resource name="sql">
            <![CDATA[select empno, sum(sal), min(sal), max(sal), bit_and(distinct sal), bit_or(sal), count(distinct sal) from sales.emp group by empno, deptno
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_2], EXPR_2=[_3], EXPR_3=[_4], EXPR_4=[_5], EXPR_5=[_6], EXPR_6=[_7])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[SUM(_2)], EXPR_2=[MIN(_2)], EXPR_3=[MAX(_2)], EXPR_4=[BIT_AND(_2)], EXPR_5=[BIT_OR(_2)], EXPR_6=[COUNT(DISTINCT _2)])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_5], EXPR_2=[_5], EXPR_3=[_5], EXPR_4=[_5], EXPR_5=[_5], EXPR_6=[1:BIGINT])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove2">
        <Resource name="sql">
            <![CDATA[select distinct empno, deptno from sales.emp
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalProject(EMPNO=[_0], DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], DEPTNO=[_7])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove3">
        <Resource name="sql">
            <![CDATA[select empno, count(mgr) from sales.emp group by empno, deptno
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_2])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[COUNT(_2)])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], MGR=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[CASE(IS NOT NULL(_3), 1:BIGINT, 0:BIGINT)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove4">
        <Resource name="sql">
            <![CDATA[select empno, max(sal), avg(sal) from sales.emp group by empno, deptno
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_2], EXPR_2=[_3])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[MAX(_2)], EXPR_2=[AVG(_2)])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], EXPR_1=[_2], EXPR_2=[_3])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[MAX(_2)], EXPR_2=[AVG(_2)])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], SAL=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove5">
        <Resource name="sql">
            <![CDATA[select empno, deptno, sum(sal) from sales.emp group by cube(empno, deptno)
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {1}, {}]], EXPR_2=[SUM(_2)])
  LogicalProject(EMPNO=[_0], DEPTNO=[_7], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {1}, {}]], EXPR_2=[SUM(_2)])
  LogicalProject(EMPNO=[_0], DEPTNO=[_7], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove6">
        <Resource name="sql">
            <![CDATA[select deptno, max(sal) from sales.emp group by deptno
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_1)])
  LogicalProject(DEPTNO=[_7], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_1)])
  LogicalProject(DEPTNO=[_7], SAL=[_5])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateRemove7">
        <Resource name="sql">
            <![CDATA[select mgr, sum(sum_sal)
from
(select mgr, deptno, sum(sal) sum_sal
 from sales.emp
 group by mgr, deptno)
where deptno=100
group by mgr]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalProject(MGR=[_0], SUM_SAL=[_2])
    LogicalFilter(condition=[=(_1, 100)])
      LogicalAggregate(group=[{0, 1}], SUM_SAL=[SUM(_2)])
        LogicalProject(MGR=[_3], DEPTNO=[_7], SAL=[_5])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(MGR=[_0], SUM_SAL=[_2])
  LogicalFilter(condition=[=(_1, 100)])
    LogicalAggregate(group=[{0, 1}], SUM_SAL=[SUM(_2)])
      LogicalProject(MGR=[_3], DEPTNO=[_7], SAL=[_5])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove1">
        <Resource name="sql">
            <![CDATA[select distinct e.deptno from sales.emp e
left outer join sales.dept d on e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalProject(DEPTNO=[_7])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove2">
        <Resource name="sql">
            <![CDATA[select e.deptno, count(distinct e.job) from sales.emp e
left outer join sales.dept d on e.deptno = d.deptno
group by e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_7], JOB=[_2])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}], EXPR_1=[COUNT(DISTINCT _2)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove3">
        <Resource name="sql">
            <![CDATA[select e.deptno, count(distinct d.name) from sales.emp e
left outer join sales.dept d on e.deptno = d.deptno
group by e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_7], NAME=[_10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}], EXPR_1=[COUNT(DISTINCT _10)])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove4">
        <Resource name="sql">
            <![CDATA[select distinct d.deptno from sales.emp e
right outer join sales.dept d on e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalProject(DEPTNO=[_9])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove5">
        <Resource name="sql">
            <![CDATA[select d.deptno, count(distinct d.name) from sales.emp e
right outer join sales.dept d on e.deptno = d.deptno
group by d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_9], NAME=[_10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove6">
        <Resource name="sql">
            <![CDATA[select d.deptno, count(distinct e.job) from sales.emp e
right outer join sales.dept d on e.deptno = d.deptno
group by d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_9], JOB=[_2])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{9}], EXPR_1=[COUNT(DISTINCT _2)])
  LogicalJoin(condition=[=(_7, _9)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove7">
        <Resource name="sql">
            <![CDATA[SELECT distinct e.deptno
FROM sales.emp e
LEFT JOIN sales.dept d1 ON e.deptno = d1.deptno
LEFT JOIN sales.dept d2 ON e.deptno = d2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}])
  LogicalProject(DEPTNO=[_7])
    LogicalJoin(condition=[=(_7, _11)], joinType=[left])
      LogicalJoin(condition=[=(_7, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove8">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno, COUNT(DISTINCT d2.name)
FROM sales.emp e
LEFT JOIN sales.dept d1 ON e.deptno = d1.deptno
LEFT JOIN sales.dept d2 ON e.deptno = d2.deptno
GROUP BY e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1)])
  LogicalProject(DEPTNO=[_7], NAME0=[_12])
    LogicalJoin(condition=[=(_7, _11)], joinType=[left])
      LogicalJoin(condition=[=(_7, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}], EXPR_1=[COUNT(DISTINCT _10)])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove9">
        <Resource name="sql">
            <![CDATA[SELECT distinct e.deptno, d2.name
FROM sales.emp e
LEFT JOIN sales.dept d1 ON e.deptno = d1.deptno
LEFT JOIN sales.dept d2 ON e.deptno = d2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1}])
  LogicalProject(DEPTNO=[_7], NAME=[_12])
    LogicalJoin(condition=[=(_7, _11)], joinType=[left])
      LogicalJoin(condition=[=(_7, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7, 10}])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateJoinRemove10">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno, COUNT(DISTINCT d1.name, d2.name)
FROM sales.emp e
LEFT JOIN sales.dept d1 ON e.deptno = d1.deptno
LEFT JOIN sales.dept d2 ON e.deptno = d2.deptno
GROUP BY e.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT(DISTINCT _1, _2)])
  LogicalProject(DEPTNO=[_7], NAME=[_10], NAME0=[_12])
    LogicalJoin(condition=[=(_7, _11)], joinType=[left])
      LogicalJoin(condition=[=(_7, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{7}], EXPR_1=[COUNT(DISTINCT _10, _12)])
  LogicalJoin(condition=[=(_7, _11)], joinType=[left])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove1">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno, d2.deptno
FROM sales.emp e
LEFT JOIN sales.dept d1 ON e.deptno = d1.deptno
LEFT JOIN sales.dept d2 ON e.deptno = d2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7], DEPTNO0=[_11])
  LogicalJoin(condition=[=(_7, _11)], joinType=[left])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7], DEPTNO0=[_9])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove2">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno, d1.deptno
FROM sales.emp e
LEFT JOIN sales.dept d1 ON e.deptno = d1.deptno
LEFT JOIN sales.dept d2 ON e.deptno = d2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7], DEPTNO0=[_9])
  LogicalJoin(condition=[=(_7, _11)], joinType=[left])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7], DEPTNO0=[_9])
  LogicalJoin(condition=[=(_7, _11)], joinType=[left])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove3">
        <Resource name="sql">
            <![CDATA[SELECT e1.deptno, d.deptno
FROM sales.emp e1
LEFT JOIN sales.emp e2 ON e1.deptno = e2.deptno
LEFT JOIN sales.dept d ON e1.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7], DEPTNO0=[_18])
  LogicalJoin(condition=[=(_7, _18)], joinType=[left])
    LogicalJoin(condition=[=(_7, _16)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7], DEPTNO0=[_18])
  LogicalJoin(condition=[=(_7, _18)], joinType=[left])
    LogicalJoin(condition=[=(_7, _16)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove4">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno
FROM sales.emp e
LEFT JOIN sales.dept d ON e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove5">
        <Resource name="sql">
            <![CDATA[SELECT e1.deptno
FROM sales.emp e1
LEFT JOIN sales.emp e2 ON e1.deptno = e2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7])
  LogicalJoin(condition=[=(_7, _16)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7])
  LogicalJoin(condition=[=(_7, _16)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove6">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno, d.name
FROM sales.emp e
LEFT JOIN sales.dept d ON e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_7], NAME=[_10])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7], NAME=[_10])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove7">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno
FROM sales.dept d
RIGHT JOIN sales.emp e ON e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_9])
  LogicalJoin(condition=[=(_9, _0)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_7])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove8">
        <Resource name="sql">
            <![CDATA[SELECT e2.deptno
FROM sales.emp e1
RIGHT JOIN sales.emp e2 ON e1.deptno = e2.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_16])
  LogicalJoin(condition=[=(_7, _16)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_16])
  LogicalJoin(condition=[=(_7, _16)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinRemove9">
        <Resource name="sql">
            <![CDATA[SELECT e.deptno, d.name
FROM sales.dept d
RIGHT JOIN sales.emp e ON e.deptno = d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_9], NAME=[_1])
  LogicalJoin(condition=[=(_9, _0)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_9], NAME=[_1])
  LogicalJoin(condition=[=(_9, _0)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceNullableCase2">
        <Resource name="sql">
            <![CDATA[SELECT deptno, ename, CASE WHEN 1=2 THEN substring(ename, 1, cast(2 as int)) ELSE NULL end from emp group by deptno, ename, case when 1=2 then substring(ename,1, cast(2 as int))  else null end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1, 2}])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], EXPR_2=[null:VARCHAR(20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0, 1, 2}])
  LogicalProject(DEPTNO=[_7], ENAME=[_1], EXPR_2=[null])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceNullableToNotNull">
        <Resource name="sql">
            <![CDATA[select
  empno + case when 'a' = 'a' then 1 else null end as newcol
from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NEWCOL=[+(_0, CASE(=('a', 'a'), 1, null:INTEGER))])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NEWCOL=[+(_0, 1)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceNullableToNotNull2">
        <Resource name="sql">
            <![CDATA[select
  empno + case when 'a' = 'a' then 1 else null end as newcol
from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NEWCOL=[+(_0, CASE(=('a', 'a'), 1, null:INTEGER))])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NEWCOL=[+(_0, 1)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinRule">
        <Resource name="sql">
            <![CDATA[select dept.* from dept join (
  select distinct deptno from emp
  where sal > 100) using (deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1])
  LogicalJoin(condition=[=(_0, _2)], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0}])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_5, 100)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
  LogicalProject(DEPTNO=[_7])
    LogicalFilter(condition=[>(_5, 100)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinRuleFull">
        <Resource name="sql">
            <![CDATA[select dept.* from dept full join (
  select distinct deptno from emp
  where sal > 100) using (deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1])
  LogicalJoin(condition=[=(_0, _2)], joinType=[full])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0}])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_5, 100)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinRuleLeft">
        <Resource name="sql">
            <![CDATA[select name from dept left join (
  select distinct deptno from emp
  where sal > 100) using (deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalJoin(condition=[=(_0, _2)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0}])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_5, 100)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_1])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSemiJoinRuleRight">
        <Resource name="sql">
            <![CDATA[select dept.* from dept right join (
  select distinct deptno from emp
  where sal > 100) using (deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], NAME=[_1])
  LogicalJoin(condition=[=(_0, _2)], joinType=[right])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0}])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[>(_5, 100)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose1">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e left join (
  select * from sales.dept d) d on e.deptno = d.deptno
order by sal limit 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], dir0=[ASC], fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], dir0=[ASC], fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalSort(sort0=[_5], dir0=[ASC], fetch=[10])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandProjectScalar">
        <Resource name="sql">
            <![CDATA[select empno,
  (select deptno from sales.emp where empno < 20) as d
from sales.emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[$SCALAR_QUERY({
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[_9])
  LogicalJoin(condition=[true], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE(_0)])
      LogicalProject(DEPTNO=[_7])
        LogicalFilter(condition=[<(_0, 20)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSelectNotInCorrelated">
        <Resource name="sql">
            <![CDATA[select sal,
 empno NOT IN (
 select deptno from dept
   where emp.job=dept.name)
 from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5], EXPR_1=[NOT(IN(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[=(_cor0.JOB, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
}))])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(SAL=[_5], EXPR_1=[IS NULL(_10)])
  LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{2}])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalFilter(condition=[=(_cor0.EMPNO, _0)])
      LogicalProject(DEPTNO=[_0], i=[true])
        LogicalFilter(condition=[=(_cor0.JOB, _1)])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5], EXPR_1=[IS NULL(_10)])
  LogicalJoin(condition=[AND(=(_0, _9), =(_2, _11))], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], i=[true], NAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSome">
        <Resource name="sql">
            <![CDATA[select * from emp e1
  where e1.empno > SOME (select deptno from dept)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[> SOME(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(AND(IS TRUE(>(_0, _9)), <>(_10, 0)), AND(>(_10, _11), null, <>(_10, 0), IS NOT TRUE(>(_0, _9))), AND(>(_0, _9), <>(_10, 0), IS NOT TRUE(>(_0, _9)), <=(_10, _11)))])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{}], m=[MIN(_0)], c=[COUNT()], d=[COUNT(_0)])
          LogicalProject(DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(AND(IS TRUE(>(_0, _9)), <>(_10, 0)), AND(>(_10, _11), null, <>(_10, 0), IS NOT TRUE(>(_0, _9))), AND(>(_0, _9), <>(_10, 0), IS NOT TRUE(>(_0, _9)), <=(_10, _11)))])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{}], m=[MIN(_0)], c=[COUNT()], d=[COUNT(_0)])
          LogicalProject(DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose2">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e right join (
  select * from sales.dept d) d on e.deptno = d.deptno
order by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_10], dir0=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_10], dir0=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalSort(sort0=[_1], dir0=[ASC])
        LogicalProject(DEPTNO=[_0], NAME=[_1])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose3">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e left join (
  select * from sales.dept) d on e.deptno = d.deptno
order by sal, name limit 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], sort1=[_10], dir0=[ASC], dir1=[ASC], fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], sort1=[_10], dir0=[ASC], dir1=[ASC], fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose4">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e right join (
  select * from sales.dept d) d on e.deptno = d.deptno
order by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_10], dir0=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_10], dir0=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalSort(sort0=[_1], dir0=[ASC])
        LogicalProject(DEPTNO=[_0], NAME=[_1])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose5">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e right join (
  select * from sales.dept d) d on e.deptno = d.deptno
limit 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalSort(fetch=[10])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalSort(fetch=[10])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose6">
        <Resource name="sql">
            <![CDATA[select d.deptno, empno from sales.dept d
right join sales.emp e using (deptno) limit 10 offset 2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EMPNO=[_2])
  LogicalSort(offset=[2], fetch=[10])
    LogicalJoin(condition=[=(_0, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EMPNO=[_2])
  LogicalSort(offset=[2], fetch=[10])
    LogicalJoin(condition=[=(_0, _9)], joinType=[right])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalSort(offset=[2], fetch=[10])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinTranspose7">
        <Resource name="sql">
            <![CDATA[select d.deptno, empno from sales.dept d
left join sales.emp e using (deptno) order by d.deptno offset 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EMPNO=[_2])
  LogicalSort(sort0=[_0], dir0=[ASC], offset=[1])
    LogicalJoin(condition=[=(_0, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EMPNO=[_2])
  LogicalSort(sort0=[_0], dir0=[ASC], offset=[1])
    LogicalJoin(condition=[=(_0, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortProjectTranspose1">
        <Resource name="sql">
            <![CDATA[select d.deptno from sales.dept d
order by cast(d.deptno as integer) offset 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_1], dir0=[ASC], offset=[1])
  LogicalProject(DEPTNO=[_0], EXPR_1=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[_0])
  LogicalSort(sort0=[_0], dir0=[ASC], offset=[1])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortProjectTranspose2">
        <Resource name="sql">
            <![CDATA[select d.deptno from sales.dept d
order by cast(d.deptno as double) offset 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_1], dir0=[ASC], offset=[1])
  LogicalProject(DEPTNO=[_0], EXPR_1=[CAST(_0):DOUBLE NOT NULL])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(DEPTNO=[_0], EXPR_1=[CAST(_0):DOUBLE NOT NULL])
  LogicalSort(sort0=[_0], dir0=[ASC], offset=[1])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortProjectTranspose3">
        <Resource name="sql">
            <![CDATA[select d.deptno from sales.dept d
order by cast(d.deptno as varchar(10)) offset 1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_1], dir0=[ASC], offset=[1])
  LogicalProject(DEPTNO=[_0], EXPR_1=[CAST(_0):VARCHAR(10) NOT NULL])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_1], dir0=[ASC], offset=[1])
  LogicalProject(DEPTNO=[_0], EXPR_1=[CAST(_0):VARCHAR(10) NOT NULL])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortUnionTranspose">
        <Resource name="sql">
            <![CDATA[select a.name from dept a
union all
select b.name from dept b
order by name limit 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], fetch=[10])
  LogicalProject(NAME=[_0])
    LogicalUnion(all=[true])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], fetch=[10])
  LogicalUnion(all=[true])
    LogicalSort(sort0=[_0], dir0=[ASC], fetch=[10])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalSort(sort0=[_0], dir0=[ASC], fetch=[10])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandProjectIn">
        <Resource name="sql">
            <![CDATA[select empno,
  deptno in (select deptno from sales.emp where empno < 20) as d
from sales.emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[IN(_7, {
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[CASE(IS NOT NULL(_10), true, false)])
  LogicalJoin(condition=[=(_7, _9)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], i=[true])
        LogicalFilter(condition=[<(_0, 20)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterInComposite">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where (empno, deptno) in (
  select empno, deptno from sales.emp where empno < 20)
or emp.sal < 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(IN(_0, _7, {
LogicalProject(EMPNO=[_0], DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), <(_5, 100))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(IS NOT NULL(_11), <(_5, 100))])
      LogicalJoin(condition=[AND(=(_0, _9), =(_7, _10))], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(EMPNO=[_0], DEPTNO=[_7], i=[true])
          LogicalFilter(condition=[<(_0, 20)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandJoinIn">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp left join sales.dept
on emp.deptno in (select deptno from sales.emp where empno < 20)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[IN(_7, {
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
    LogicalJoin(condition=[true], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalJoin(condition=[=(_7, _11)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0}])
          LogicalProject(DEPTNO=[_7])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterIn">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where deptno in (select deptno from sales.emp where empno < 20)
or emp.sal < 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(IN(_7, {
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), <(_5, 100))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(IS NOT NULL(_10), <(_5, 100))])
      LogicalJoin(condition=[=(_7, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0, 1}])
          LogicalProject(DEPTNO=[_7], i=[true])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandJoinExists">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp left join sales.dept
on exists (select deptno from sales.emp where empno < 20)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[EXISTS({
LogicalFilter(condition=[<(_0, 20)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
    LogicalJoin(condition=[true], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0}])
          LogicalProject(i=[true])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandProjectExists">
        <Resource name="sql">
            <![CDATA[select empno,
  exists (select deptno from sales.emp where empno < 20) as d
from sales.emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[EXISTS({
LogicalFilter(condition=[<(_0, 20)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[IS NOT NULL(_9)])
  LogicalJoin(condition=[true], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0}])
      LogicalProject(i=[true])
        LogicalFilter(condition=[<(_0, 20)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandJoinScalar">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp left join sales.dept
on (select deptno from sales.emp where empno < 20)
 < (select deptno from sales.emp where empno > 100)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[<($SCALAR_QUERY({
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), $SCALAR_QUERY({
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[>(_0, 100)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}))], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10], _f0=[_11])
      LogicalJoin(condition=[<(_11, _12)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalJoin(condition=[true], joinType=[left])
          LogicalJoin(condition=[true], joinType=[left])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE(_0)])
              LogicalProject(DEPTNO=[_7])
                LogicalFilter(condition=[<(_0, 20)])
                  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE(_0)])
            LogicalProject(DEPTNO=[_7])
              LogicalFilter(condition=[>(_0, 100)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSelectAnyCorrelated">
        <Resource name="sql">
            <![CDATA[select empno > ANY (
  select deptno from dept where emp.job = dept.name)
from emp
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[> SOME(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[=(_cor0.JOB, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(OR(AND(IS TRUE(>(_0, _9)), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0)))), AND(IS TRUE(>(_10, _11)), null, IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9))), AND(>(_0, _9), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9)), IS NOT TRUE(>(_10, _11))))):BOOLEAN NOT NULL])
  LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{2}])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(m=[_0], c=[_1], d=[_2], trueLiteral=[true])
      LogicalAggregate(group=[{}], m=[MIN(_0)], c=[COUNT()], d=[COUNT(_0)])
        LogicalProject(DEPTNO=[_0])
          LogicalFilter(condition=[=(_cor0.JOB, _1)])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[CAST(OR(AND(IS TRUE(>(_0, _9)), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0)))), AND(IS TRUE(>(_10, _11)), null, IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9))), AND(>(_0, _9), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9)), IS NOT TRUE(>(_10, _11))))):BOOLEAN NOT NULL])
  LogicalJoin(condition=[=(_2, _13)], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(m=[_1], c=[_2], d=[_3], trueLiteral=[true], NAME=[_0])
      LogicalAggregate(group=[{0}], m=[MIN(_1)], c=[COUNT()], d=[COUNT(_1)])
        LogicalProject(NAME=[_1], DEPTNO=[_0])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSubQueryWithDynamicStarHang">
        <Resource name="sql">
            <![CDATA[select n.n_regionkey from (select * from
(select * from sales.customer) t) n where n.n_nationkey >1]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(N_REGIONKEY=[ITEM(_0, 'N_REGIONKEY')])
  LogicalFilter(condition=[>(ITEM(_0, 'N_NATIONKEY'), 1)])
    LogicalProject(**=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
EnumerableProject(N_REGIONKEY=[ITEM(_0, 'N_REGIONKEY')])
  EnumerableFilter(condition=[>(ITEM(_0, 'N_NATIONKEY'), 1)])
    EnumerableTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectFilterTransposeRuleOnEmptyRowType">
        <Resource name="planAfter">
            <![CDATA[
LogicalProject
  LogicalFilter(condition=[=(_0, 20)])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterExists">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where exists (select deptno from sales.emp where empno < 20)
or emp.sal < 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(EXISTS({
LogicalFilter(condition=[<(_0, 20)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), <(_5, 100))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(IS NOT NULL(_9), <(_5, 100))])
      LogicalJoin(condition=[true], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}])
          LogicalProject(i=[true])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandProjectInComposite">
        <Resource name="sql">
            <![CDATA[select empno, (empno, deptno) in (
    select empno, deptno from sales.emp where empno < 20) as d
from sales.emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[IN(_0, _7, {
LogicalProject(EMPNO=[_0], DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[CASE(IS NOT NULL(_11), true, false)])
  LogicalJoin(condition=[AND(=(_0, _9), =(_7, _10))], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], DEPTNO=[_7], i=[true])
      LogicalFilter(condition=[<(_0, 20)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandJoinInComposite">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp left join sales.dept
on (emp.empno, dept.deptno) in (
  select empno, deptno from sales.emp where empno < 20)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalJoin(condition=[IN(_0, _9, {
LogicalProject(EMPNO=[_0], DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], joinType=[left])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
    LogicalJoin(condition=[true], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalJoin(condition=[AND(=(_0, _11), =(_9, _12))], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0, 1}])
          LogicalProject(EMPNO=[_0], DEPTNO=[_7])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterScalar">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where (select deptno from sales.emp where empno < 20)
 < (select deptno from sales.emp where empno > 100)
or emp.sal < 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[OR(<($SCALAR_QUERY({
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), $SCALAR_QUERY({
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[>(_0, 100)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})), <(_5, 100))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(<(_9, _10), <(_5, 100))])
      LogicalJoin(condition=[true], joinType=[left])
        LogicalJoin(condition=[true], joinType=[left])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE(_0)])
            LogicalProject(DEPTNO=[_7])
              LogicalFilter(condition=[<(_0, 20)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE(_0)])
          LogicalProject(DEPTNO=[_7])
            LogicalFilter(condition=[>(_0, 100)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsDup2">
        <Resource name="sql">
            <![CDATA[select *
from emp
where deptno=7 and deptno=8
and empno = 10 and mgr is null and empno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[AND(=(_7, 7), =(_7, 8), =(_0, 10), IS NULL(_3), =(_0, 10))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[10], ENAME=[_1], JOB=[_2], MGR=[null:INTEGER], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalValues(tuples=[[]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPullNull">
        <Resource name="sql">
            <![CDATA[select *
from emp
where deptno=7
and empno = 10 and mgr is null and empno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[AND(=(_7, 7), =(_0, 10), IS NULL(_3), =(_0, 10))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[10], ENAME=[_1], JOB=[_2], MGR=[null:INTEGER], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[7], SLACKER=[_8])
  LogicalFilter(condition=[AND(=(_7, 7), =(_0, 10), IS NULL(_3))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSomeWithEquality">
        <Resource name="sql">
            <![CDATA[select * from emp e1
  where e1.deptno = SOME (select deptno from dept)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[IN(_7, {
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSomeWithEquality2">
        <Resource name="sql">
            <![CDATA[select * from emp e1
  where e1.ename= SOME (select name from dept)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[IN(_1, {
LogicalProject(NAME=[_1])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalJoin(condition=[=(_1, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}])
        LogicalProject(NAME=[_1])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalJoin(condition=[=(_1, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}])
        LogicalProject(NAME=[_1])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinCopyInnerJoinOrderBy">
        <Resource name="sql">
            <![CDATA[select * from sales.emp join sales.dept on
sales.emp.deptno = sales.dept.deptno order by sal]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], dir0=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], dir0=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalSort(sort0=[_5], dir0=[ASC])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinCopyInnerJoinOrderByLimit">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e join (
  select * from sales.dept d) d on e.deptno = d.deptno
order by sal limit 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], dir0=[ASC], fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], dir0=[ASC], fetch=[10])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalSort(sort0=[_5], dir0=[ASC])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(DEPTNO=[_0], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinCopyInnerJoinOrderByTwoFields">
        <Resource name="sql">
            <![CDATA[select * from sales.emp e join  sales.dept d on
 e.deptno = d.deptno order by e.sal,d.name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], sort1=[_10], dir0=[ASC], dir1=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  LogicalSort(sort0=[_5], sort1=[_10], dir0=[ASC], dir1=[ASC])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalSort(sort0=[_5], dir0=[ASC])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalSort(sort0=[_1], dir0=[ASC])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinCopySemiJoinOrderBy">
        <Resource name="sql">
            <![CDATA[select * from sales.dept d where d.deptno in
 (select e.deptno from sales.emp e) order by d.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalSort(sort0=[_0], dir0=[ASC])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinCopySemiJoinOrderByLimitOffset">
        <Resource name="sql">
            <![CDATA[select * from sales.dept d where d.deptno in
 (select e.deptno from sales.emp e) order by d.deptno limit 10 offset 2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], offset=[2], fetch=[10])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], offset=[2], fetch=[10])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalSort(sort0=[_0], dir0=[ASC])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortJoinCopySemiJoinOrderByOffset">
        <Resource name="sql">
            <![CDATA[select * from sales.dept d where d.deptno in (select e.deptno from sales.emp e) order by d.deptno offset 2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], offset=[2])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], offset=[2])
  LogicalJoin(condition=[=(_0, _2)], joinType=[semi])
    LogicalSort(sort0=[_0], dir0=[ASC])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortRemovalAllKeysConstant">
        <Resource name="sql">
            <![CDATA[select count(*) as c
from sales.emp
where deptno = 10
group by deptno, sal
order by deptno desc nulls last]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_1], dir0=[DESC-nulls-last])
  LogicalProject(C=[_2], DEPTNO=[_0])
    LogicalAggregate(group=[{0, 1}], C=[COUNT()])
      LogicalProject(DEPTNO=[_7], SAL=[_5])
        LogicalFilter(condition=[=(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(C=[_2], DEPTNO=[_0])
  LogicalAggregate(group=[{0, 1}], C=[COUNT()])
    LogicalProject(DEPTNO=[_7], SAL=[_5])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortRemovalOneKeyConstant">
        <Resource name="sql">
            <![CDATA[select count(*) as c
from sales.emp
where deptno = 10
group by deptno, sal
order by deptno, sal desc nulls first]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_1], sort1=[_2], dir0=[ASC], dir1=[DESC])
  LogicalProject(C=[_2], DEPTNO=[_0], SAL=[_1])
    LogicalAggregate(group=[{0, 1}], C=[COUNT()])
      LogicalProject(DEPTNO=[_7], SAL=[_5])
        LogicalFilter(condition=[=(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_2], dir0=[DESC])
  LogicalProject(C=[_2], DEPTNO=[_0], SAL=[_1])
    LogicalAggregate(group=[{0, 1}], C=[COUNT()])
      LogicalProject(DEPTNO=[_7], SAL=[_5])
        LogicalFilter(condition=[=(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortUnionTranspose2">
        <Resource name="sql">
            <![CDATA[select a.name from dept a
union all
select b.name from dept b
order by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC])
  LogicalProject(NAME=[_0])
    LogicalUnion(all=[true])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC])
  LogicalUnion(all=[true])
    LogicalSort(sort0=[_0], dir0=[ASC])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalSort(sort0=[_0], dir0=[ASC])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSortUnionTranspose3">
        <Resource name="sql">
            <![CDATA[select a.name from dept a
union all
select b.name from dept b
order by name limit 0]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], fetch=[0])
  LogicalProject(NAME=[_0])
    LogicalUnion(all=[true])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC], fetch=[0])
  LogicalUnion(all=[true])
    LogicalSort(sort0=[_0], dir0=[ASC], fetch=[0])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalSort(sort0=[_0], dir0=[ASC], fetch=[0])
      LogicalProject(NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateConstantKeyRule">
        <Resource name="sql">
            <![CDATA[select count(*) as c
from sales.emp
where deptno = 10
group by deptno, sal]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(C=[_2])
  LogicalAggregate(group=[{0, 1}], C=[COUNT()])
    LogicalProject(DEPTNO=[_7], SAL=[_5])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(C=[_2])
  LogicalProject(DEPTNO=[10], SAL=[_0], C=[_1])
    LogicalAggregate(group=[{1}], C=[COUNT()])
      LogicalProject(DEPTNO=[_7], SAL=[_5])
        LogicalFilter(condition=[=(_7, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateConstantKeyRule2">
        <Resource name="sql">
            <![CDATA[select count(*) as c
from sales.emp
where deptno = 10
group by deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(C=[_1])
  LogicalAggregate(group=[{0}], C=[COUNT()])
    LogicalProject(DEPTNO=[_7])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(C=[_1])
  LogicalAggregate(group=[{0}], C=[COUNT()])
    LogicalProject(DEPTNO=[_7])
      LogicalFilter(condition=[=(_7, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateConstantKeyRule3">
        <Resource name="sql">
            <![CDATA[select job
from sales.emp
where sal is null and job = 'Clerk'
group by sal, job
having count(*) > 3]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(JOB=[_1])
  LogicalFilter(condition=[>(_2, 3)])
    LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
      LogicalProject(SAL=[_5], JOB=[_2])
        LogicalFilter(condition=[AND(IS NULL(_5), =(_2, 'Clerk'))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_1])
  LogicalFilter(condition=[>(_2, 3)])
    LogicalProject(SAL=[_0], JOB=['Clerk':VARCHAR(10)], _f2=[_1])
      LogicalAggregate(group=[{0}], agg#0=[COUNT()])
        LogicalProject(SAL=[_5], JOB=[_2])
          LogicalFilter(condition=[AND(IS NULL(_5), =(_2, 'Clerk'))])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateDynamicFunction">
        <Resource name="sql">
            <![CDATA[select hiredate
from sales.emp
where sal is null and hiredate = current_timestamp
group by sal, hiredate
having count(*) > 3]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(HIREDATE=[_1])
  LogicalFilter(condition=[>(_2, 3)])
    LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
      LogicalProject(SAL=[_5], HIREDATE=[_4])
        LogicalFilter(condition=[AND(IS NULL(_5), =(_4, CURRENT_TIMESTAMP))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(HIREDATE=[_1])
  LogicalFilter(condition=[>(_2, 3)])
    LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
      LogicalProject(SAL=[_5], HIREDATE=[_4])
        LogicalFilter(condition=[AND(IS NULL(_5), =(_4, CURRENT_TIMESTAMP))])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandProjectInNullable">
        <Resource name="sql">
            <![CDATA[with e2 as (
  select empno, case when true then deptno else null end as deptno
  from sales.emp)
select empno,
  deptno in (select deptno from e2 where empno < 20) as d
from e2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[IN(CASE(true, CAST(_7):INTEGER, null:INTEGER), {
LogicalProject(DEPTNO=[_1])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalProject(EMPNO=[_0], DEPTNO=[CASE(true, CAST(_7):INTEGER, null:INTEGER)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], D=[CASE(=(_9, 0), false, IS NULL(CASE(true, CAST(_7):INTEGER, null:INTEGER)), null:BOOLEAN, IS NOT NULL(_12), true, <(_10, _9), null:BOOLEAN, false)])
  LogicalJoin(condition=[=(CASE(true, CAST(_7):INTEGER, null:INTEGER), _11)], joinType=[left])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
        LogicalProject(DEPTNO=[_1])
          LogicalFilter(condition=[<(_0, 20)])
            LogicalProject(EMPNO=[_0], DEPTNO=[CASE(true, CAST(_7):INTEGER, null:INTEGER)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_1], i=[true])
        LogicalFilter(condition=[<(_0, 20)])
          LogicalProject(EMPNO=[_0], DEPTNO=[CASE(true, CAST(_7):INTEGER, null:INTEGER)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterIn3Value">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where empno
 < case deptno in (select case when true then deptno else null end
                   from sales.emp where empno < 20)
   when true then 10
   when false then 20
   else 30
   end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[<(_0, CASE(=(IN(_7, {
LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null:INTEGER)])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), true), 10, =(IN(_7, {
LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null:INTEGER)])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), false), 20, 30))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[<(_0, CASE(OR(AND(IS NOT NULL(_12), <>(_9, 0)), AND(<(_10, _9), null, <>(_9, 0), IS NULL(_12))), 10, AND(OR(IS NULL(_12), =(_9, 0)), OR(>=(_10, _9), =(_9, 0), IS NOT NULL(_12))), 20, 30))])
      LogicalJoin(condition=[=(_7, _11)], joinType=[left])
        LogicalJoin(condition=[true], joinType=[inner])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
            LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null:INTEGER)])
              LogicalFilter(condition=[<(_0, 20)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0, 1}])
          LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null:INTEGER)], i=[true])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterExists3Value">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where empno
  < case exists (select deptno from sales.emp where empno < 20)
    when true then 10 when false then 20 else 30 end]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[<(_0, CASE(=(IN(_7, {
LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null)])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), true), 10, =(IN(_7, {
LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null)])
  LogicalFilter(condition=[<(_0, 20)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), false), 20, 30))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[<(_0, CASE(=(CASE(=(_9, 0), false, IS NOT NULL(_12), true, <(_10, _9), null, false), true), 10, =(CASE(=(_9, 0), false, IS NOT NULL(_12), true, <(_10, _9), null, false), false), 20, 30))])
      LogicalJoin(condition=[=(_7, _11)], joinType=[left])
        LogicalJoin(condition=[true], joinType=[inner])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
            LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null)])
              LogicalFilter(condition=[<(_0, 20)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0, 1}])
          LogicalProject(EXPR_0=[_0], i=[true])
            LogicalProject(EXPR_0=[CASE(true, CAST(_7):INTEGER, null)])
              LogicalFilter(condition=[<(_0, 20)])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterExistsSimple">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where exists (select deptno from sales.emp where empno < 20)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[EXISTS({
LogicalFilter(condition=[<(_0, 20)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{0}])
        LogicalProject(i=[true])
          LogicalFilter(condition=[<(_0, 20)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExpandFilterExistsSimpleAnd">
        <Resource name="sql">
            <![CDATA[select empno
from sales.emp
where exists (select deptno from sales.emp where empno < 20)
and emp.sal < 100]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[AND(EXISTS({
LogicalFilter(condition=[<(_0, 20)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}), <(_5, 100))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[<(_5, 100)])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}])
          LogicalProject(i=[true])
            LogicalFilter(condition=[<(_0, 20)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereInCorrelated">
        <Resource name="sql">
            <![CDATA[select sal from emp where empno IN (
  select deptno from dept where emp.job = dept.name)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[IN(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[=(_cor0.JOB, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[=(_0, _9)])
      LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{2}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_0])
          LogicalFilter(condition=[=(_cor0.JOB, _1)])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalJoin(condition=[AND(=(_2, _10), =(_0, _9))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(DEPTNO=[_0], NAME=[_1])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereInJoinCorrelated">
        <Resource name="sql">
            <![CDATA[select empno from emp as e
join dept as d using (deptno)
where e.sal in (
  select e2.sal from emp as e2 where e2.deptno > e.deptno)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IN(_5, {
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[>(_7, _cor0.DEPTNO)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], variablesSet=[[_cor0]])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
    LogicalFilter(condition=[=(_5, _11)])
      LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{7}])
        LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0}])
          LogicalProject(SAL=[_5])
            LogicalFilter(condition=[>(_7, _cor0.DEPTNO)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDistinctNonDistinctAggregates">
        <Resource name="sql">
            <![CDATA[select emp.empno, count(*), avg(distinct dept.deptno)
from sales.emp emp inner join sales.dept dept
on emp.deptno = dept.deptno
group by emp.empno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[COUNT()], EXPR_2=[AVG(DISTINCT _1)])
  LogicalProject(EMPNO=[_0], DEPTNO0=[_9])
    LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[$SUM0(_2)], EXPR_2=[AVG(_1)])
  LogicalAggregate(group=[{0, 1}], EXPR_1=[COUNT()])
    LogicalProject(EMPNO=[_0], DEPTNO0=[_9])
      LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testCastInAggregateExpandDistinctAggregatesRule">
        <Resource name="sql">
            <![CDATA[select name, sum(distinct cn), sum(distinct sm)
from (
  select name, count(dept.deptno) as cn,sum(dept.deptno) as sm
  from sales.dept group by name)
group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(DISTINCT _1)], EXPR_2=[SUM(DISTINCT _2)])
  LogicalAggregate(group=[{0}], CN=[COUNT()], SM=[SUM(_1)])
    LogicalProject(NAME=[_1], DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[CAST(_1):BIGINT NOT NULL], EXPR_2=[CAST(_2):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1) FILTER _3], EXPR_2=[SUM(_2) FILTER _4])
    LogicalProject(NAME=[_0], CN=[_1], SM=[_2], $g_1=[=(_3, 1)], $g_2=[=(_3, 2)])
      LogicalAggregate(group=[{0, 1, 2}], groups=[[{0, 1}, {0, 2}]], $g=[GROUPING(_0, _1, _2)])
        LogicalAggregate(group=[{0}], CN=[COUNT()], SM=[SUM(_1)])
          LogicalProject(NAME=[_1], DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceExpressionsNot">
        <Resource name="sql">
            <![CDATA[select * from (values (false),(true)) as q (col1) where not(col1)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(COL1=[_0])
  LogicalFilter(condition=[NOT(_0)])
    LogicalValues(tuples=[[{ false }, { true }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(COL1=[_0])
  LogicalFilter(condition=[NOT(_0)])
    LogicalValues(tuples=[[{ false }, { true }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateProjectPullUpConstants">
        <Resource name="sql">
            <![CDATA[select job, empno, sal, sum(sal) as s
from emp where empno = 10
group by job, empno, sal]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0, 1, 2}], S=[SUM(_2)])
  LogicalProject(JOB=[_2], EMPNO=[_0], SAL=[_5])
    LogicalFilter(condition=[=(_0, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_0], EMPNO=[10], SAL=[_1], S=[_2])
  LogicalAggregate(group=[{0, 2}], S=[SUM(_2)])
    LogicalProject(JOB=[_2], EMPNO=[_0], SAL=[_5])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggregateProjectPullUpConstants2">
        <Resource name="sql">
            <![CDATA[select ename, sal
from (select '1', ename, sal from emp where ename = 'John') subq
group by ename, sal]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{1, 5}])
  LogicalFilter(condition=[=(_1, 'John')])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=['John':VARCHAR(20)], SAL=[_0])
  LogicalAggregate(group=[{5}])
    LogicalFilter(condition=[=(_1, 'John')])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereExpressionInCorrelated">
        <Resource name="sql">
            <![CDATA[select ename from (
  select ename, deptno, sal + 1 as salPlus from emp) as e
where deptno in (
  select deptno from emp where sal + 1 = e.salPlus)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_0])
  LogicalFilter(condition=[IN(_1, {
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[=(+(_5, 1), _cor0.SALPLUS)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], variablesSet=[[_cor0]])
    LogicalProject(ENAME=[_1], DEPTNO=[_7], SALPLUS=[+(_5, 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(ENAME=[_0])
  LogicalProject(ENAME=[_0], DEPTNO=[_1], SALPLUS=[_2])
    LogicalFilter(condition=[=(_1, _3)])
      LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{2}])
        LogicalProject(ENAME=[_1], DEPTNO=[_7], SALPLUS=[+(_5, 1)])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}])
          LogicalProject(DEPTNO=[_7])
            LogicalFilter(condition=[=(+(_5, 1), _cor0.SALPLUS)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_0])
  LogicalJoin(condition=[AND(=(_2, _4), =(_1, _3))], joinType=[inner])
    LogicalProject(ENAME=[_1], DEPTNO=[_7], SALPLUS=[+(_5, 1)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], _f9=[_9])
        LogicalFilter(condition=[=(+(_5, 1), _9)])
          LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_5, 1)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereExpressionInCorrelated2">
        <Resource name="sql">
            <![CDATA[select name from (
  select name, deptno, deptno - 10 as deptnoMinus from dept) as d
where deptno in (
  select deptno from emp where sal + 1 = d.deptnoMinus)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_0])
  LogicalFilter(condition=[IN(_1, {
LogicalProject(DEPTNO=[_7])
  LogicalFilter(condition=[=(+(_5, 1), _cor0.DEPTNOMINUS)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
})], variablesSet=[[_cor0]])
    LogicalProject(NAME=[_1], DEPTNO=[_0], DEPTNOMINUS=[-(_0, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(NAME=[_0])
  LogicalProject(NAME=[_0], DEPTNO=[_1], DEPTNOMINUS=[_2])
    LogicalFilter(condition=[=(_1, _3)])
      LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{2}])
        LogicalProject(NAME=[_1], DEPTNO=[_0], DEPTNOMINUS=[-(_0, 10)])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0}])
          LogicalProject(DEPTNO=[_7])
            LogicalFilter(condition=[=(+(_5, 1), _cor0.DEPTNOMINUS)])
              LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0])
  LogicalJoin(condition=[AND(=(_2, _4), =(_1, _3))], joinType=[inner])
    LogicalProject(NAME=[_1], DEPTNO=[_0], DEPTNOMINUS=[-(_0, 10)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
    LogicalAggregate(group=[{0, 1}])
      LogicalProject(DEPTNO=[_7], _f9=[_9])
        LogicalFilter(condition=[=(+(_5, 1), _9)])
          LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[+(_5, 1)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereNotInCorrelated">
        <Resource name="sql">
            <![CDATA[select sal from emp
where empno NOT IN (
  select deptno from dept
  where emp.job = dept.name)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[NOT(IN(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[=(_cor0.JOB, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
}))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalFilter(condition=[OR(=(_10, 0), IS NOT TRUE(OR(IS NOT NULL(_13), <(_11, _10))))])
    LogicalJoin(condition=[AND(=(_0, _12), =(_2, _14))], joinType=[left])
      LogicalJoin(condition=[=(_2, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}], c=[COUNT()], ck=[COUNT(_1)])
          LogicalProject(NAME=[_1], DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
      LogicalProject(DEPTNO=[_0], i=[true], NAME=[_1])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(SAL=[_5])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(=(_9, 0), IS NOT TRUE(OR(IS NOT NULL(_12), <(_10, _9))))])
      LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{2}])
        LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{2}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
            LogicalProject(DEPTNO=[_0])
              LogicalFilter(condition=[=(_cor0.JOB, _1)])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalFilter(condition=[=(_cor0.EMPNO, _0)])
          LogicalProject(DEPTNO=[_0], i=[true])
            LogicalFilter(condition=[=(_cor0.JOB, _1)])
              LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereOrSubQuery">
        <Resource name="sql">
            <![CDATA[select * from emp
where sal = 4
or empno NOT IN (select deptno from dept)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[OR(=(_5, 4), NOT(IN(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(=(_5, 4), IS NULL(_10))])
      LogicalJoin(condition=[=(_0, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_0], i=[true])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(=(_5, 4), IS NULL(_10))])
      LogicalJoin(condition=[=(_0, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(DEPTNO=[_0], i=[true])
          LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereNotInCorrelated2">
        <Resource name="sql">
            <![CDATA[select * from emp e1
  where e1.empno NOT IN
   (select empno from (select ename, empno, sal as r from emp) e2
    where r > 2 and e1.ename= e2.ename)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[NOT(IN(_0, {
LogicalProject(EMPNO=[_1])
  LogicalFilter(condition=[AND(>(_2, 2), =(_cor0.ENAME, _0))])
    LogicalProject(ENAME=[_1], EMPNO=[_0], R=[_5])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
}))], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(=(_9, 0), IS NOT TRUE(OR(IS NOT NULL(_12), <(_10, _9))))])
      LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{1}])
        LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{1}])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalAggregate(group=[{}], c=[COUNT()], ck=[COUNT(_0)])
            LogicalProject(EMPNO=[_1])
              LogicalFilter(condition=[AND(>(_2, 2), =(_cor0.ENAME, _0))])
                LogicalProject(ENAME=[_1], EMPNO=[_0], R=[_5])
                  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalFilter(condition=[=(_cor0.EMPNO, _0)])
          LogicalProject(EMPNO=[_1], i=[true])
            LogicalFilter(condition=[AND(>(_2, 2), =(_cor0.ENAME, _0))])
              LogicalProject(ENAME=[_1], EMPNO=[_0], R=[_5])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[OR(=(_10, 0), IS NOT TRUE(OR(IS NOT NULL(_13), <(_11, _10))))])
    LogicalJoin(condition=[AND(=(_0, _12), =(_1, _14))], joinType=[left])
      LogicalJoin(condition=[=(_1, _9)], joinType=[left])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalAggregate(group=[{0}], c=[COUNT()], ck=[COUNT(_1)])
          LogicalProject(ENAME=[_0], EMPNO=[_1])
            LogicalFilter(condition=[>(_2, 2)])
              LogicalProject(ENAME=[_1], EMPNO=[_0], R=[_5])
                LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(EMPNO=[_1], i=[true], ENAME=[_0])
        LogicalFilter(condition=[>(_2, 2)])
          LogicalProject(ENAME=[_1], EMPNO=[_0], R=[_5])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTransposeWithExprCond">
        <Resource name="sql">
            <![CDATA[select t1.name, t2.ename
from DEPT_NESTED as t1,
unnest(t1.employees) as t2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_1], ENAME=[_5])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{3}])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT_NESTED]])
    Uncollect
      LogicalProject(EMPLOYEES=[_cor0.EMPLOYEES])
        LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], ENAME=[_2])
  LogicalCorrelate(correlation=[_cor1], joinType=[inner], requiredColumns=[{1}])
    LogicalProject(NAME=[_1], EMPLOYEES=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT_NESTED]])
    LogicalProject(ENAME=[_1])
      Uncollect
        LogicalProject(EMPLOYEES=[_cor1.EMPLOYEES])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectSetOpTranspose">
        <Resource name="sql">
            <![CDATA[select job, sum(sal + 100) over (partition by deptno) from
(select * from emp e1 union all select * from emp e2)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(JOB=[_2], EXPR_1=[SUM(+(_5, 100)) OVER (PARTITION BY _7 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalUnion(all=[true])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(JOB=[_0], EXPR_1=[SUM(_2) OVER (PARTITION BY _1 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalUnion(all=[true])
    LogicalProject(JOB=[_2], DEPTNO=[_7], +=[+(_5, 100)])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(JOB=[_2], DEPTNO=[_7], +=[+(_5, 100)])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTransposeDynamic">
        <Resource name="sql">
            <![CDATA[select t1.c_nationkey, t2.a as fake_col2 from SALES.CUSTOMER as t1, unnest(t1.fake_col) as t2(a)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(C_NATIONKEY=[_1], FAKE_COL2=[_2])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{0}])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
    LogicalProject(A=[_0])
      Uncollect
        LogicalProject(FAKE_COL=[_cor0.FAKE_COL])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(C_NATIONKEY=[_1], FAKE_COL2=[_2])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{0}])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
    LogicalProject(A=[_0])
      Uncollect
        LogicalProject(FAKE_COL=[_cor0.FAKE_COL])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTranspose">
        <Resource name="sql">
            <![CDATA[select t1.name, t2.ename
from DEPT_NESTED as t1,
unnest(t1.employees) as t2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(NAME=[_1], ENAME=[_5])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{3}])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT_NESTED]])
    Uncollect
      LogicalProject(EMPLOYEES=[_cor0.EMPLOYEES])
        LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], ENAME=[_2])
  LogicalCorrelate(correlation=[_cor1], joinType=[inner], requiredColumns=[{1}])
    LogicalProject(NAME=[_1], EMPLOYEES=[_3])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT_NESTED]])
    LogicalProject(ENAME=[_1])
      Uncollect
        LogicalProject(EMPLOYEES=[_cor1.EMPLOYEES])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTransposeWithOver">
        <Resource name="sql">
            <![CDATA[select sum(t1.deptno + 1) over (partition by t1.name),
count(t2.empno) over ()
from DEPT_NESTED as t1,
unnest(t1.employees) as t2]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[SUM(+(_0, 1)) OVER (PARTITION BY _1 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], EXPR_1=[COUNT(_4) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalCorrelate(correlation=[_cor0], joinType=[inner], requiredColumns=[{3}])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT_NESTED]])
    Uncollect
      LogicalProject(EMPLOYEES=[_cor0.EMPLOYEES])
        LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[SUM(_2) OVER (PARTITION BY _0 RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)], EXPR_1=[COUNT(_3) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
  LogicalCorrelate(correlation=[_cor1], joinType=[inner], requiredColumns=[{1}])
    LogicalProject(NAME=[_1], EMPLOYEES=[_3], +=[+(_0, 1)])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT_NESTED]])
    LogicalProject(EMPNO=[_0])
      Uncollect
        LogicalProject(EMPLOYEES=[_cor1.EMPLOYEES])
          LogicalValues(tuples=[[{ 0 }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTransposeRuleLeftCorrelate">
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_9)])
    LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{7}])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalAggregate(group=[{}], agg#0=[MIN(_0)])
        LogicalProject(_f0=[true])
          LogicalFilter(condition=[=(_cor0.DEPTNO, _0)])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0])
  LogicalFilter(condition=[IS NOT NULL(_1)])
    LogicalProject(EMPNO=[_0], _f0=[_2])
      LogicalCorrelate(correlation=[_cor2], joinType=[left], requiredColumns=[{1}])
        LogicalProject(EMPNO=[_0], DEPTNO=[_7])
          LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(_f0=[_0])
          LogicalAggregate(group=[{}], agg#0=[MIN(_0)])
            LogicalProject(_f0=[true])
              LogicalFilter(condition=[=(_cor2.DEPTNO, _0)])
                LogicalProject(DEPTNO=[_0])
                  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="sql">
            <![CDATA[SELECT e1.empno
FROM emp e1 where exists (select empno, deptno from dept d2 where e1.deptno = d2.deptno)]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTransposeRuleSemiCorrelate">
        <Resource name="planAfter">
            <![CDATA[
LogicalCorrelate(correlation=[_cor0], joinType=[semi], requiredColumns=[{0}])
  LogicalProject(f=[_0])
    LogicalValues(tuples=[[{ '1', '2' }]])
  LogicalProject
    LogicalProject(f3=[_0], _f1=[_cor0.f])
      LogicalValues(tuples=[[{ '1', '2' }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectCorrelateTransposeRuleAntiCorrelate">
        <Resource name="planAfter">
            <![CDATA[
LogicalCorrelate(correlation=[_cor0], joinType=[anti], requiredColumns=[{0}])
  LogicalProject(f=[_0])
    LogicalValues(tuples=[[{ '1', '2' }]])
  LogicalProject
    LogicalProject(f3=[_0], _f1=[_cor0.f])
      LogicalValues(tuples=[[{ '1', '2' }]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testOversimplifiedCaseStatement">
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[AND(>(_3, 0), >(CASE(>(_3, 0), /(_7, _3), null:INTEGER), 1))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[AND(>(_3, 0), CASE(>(_3, 0), >(/(_7, _3), 1), false))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="sql">
            <![CDATA[select * from emp where MGR > 0 and case when MGR > 0 then deptno / MGR else null end > 1]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceConstantsWindow">
        <Resource name="sql">
            <![CDATA[select col1, col2, col3
from (
  select empno,
    sum(100) over (partition by deptno, sal order by sal) as col1,
    sum(100) over (partition by sal order by deptno) as col2,
    sum(sal) over (partition by deptno order by sal) as col3
  from emp where sal = 5000)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(_0=[_2], _1=[_3], _2=[_4])
  LogicalWindow(window#0=[window(partition {1} order by [] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [SUM(_2)])], window#1=[window(partition {} order by [1] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [SUM(_2)])], window#2=[window(partition {1} order by [] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [SUM(5000)])])
    LogicalProject(SAL=[_5], DEPTNO=[_7])
      LogicalFilter(condition=[=(_5, 5000)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(COL1=[SUM(100) OVER (PARTITION BY _7, _5 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], COL2=[SUM(100) OVER (PARTITION BY _5 ORDER BY _7 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)], COL3=[SUM(_5) OVER (PARTITION BY _7 ORDER BY _5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])
  LogicalFilter(condition=[=(_5, 5000)])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExchangeRemoveConstantKeysRule">
        <Resource name="planBefore">
            <![CDATA[
LogicalSortExchange(distribution=[hash[0, 1]], collation=[[0, 1]])
  LogicalProject(EMPNO=[_0], ENAME=[_1])
    LogicalExchange(distribution=[hash[0]])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSortExchange(distribution=[hash[1]], collation=[[1]])
  LogicalProject(EMPNO=[_0], ENAME=[_1])
    LogicalExchange(distribution=[single])
      LogicalFilter(condition=[=(_0, 10)])
        LogicalTableScan(table=[[scott, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceAverageWithNoReduceSum">
        <Resource name="sql">
            <![CDATA[select name, max(name), avg(deptno), min(name)
from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_0)], EXPR_2=[AVG(_1)], EXPR_3=[MIN(_0)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], EXPR_2=[CAST(/(_2, _3)):INTEGER NOT NULL], EXPR_3=[_4])
  LogicalAggregate(group=[{0}], EXPR_1=[MAX(_0)], agg#1=[SUM(_1)], agg#2=[COUNT()], EXPR_3=[MIN(_0)])
    LogicalProject(NAME=[_1], DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testNoReduceAverage">
        <Resource name="sql">
            <![CDATA[select name, max(name), avg(deptno), min(name) from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_0)], EXPR_2=[AVG(_1)], EXPR_3=[MIN(_0)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[MAX(_0)], EXPR_2=[AVG(_1)], EXPR_3=[MIN(_0)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testNoReduceSum">
        <Resource name="sql">
            <![CDATA[select name, sum(deptno) from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[SUM(_1)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceAverageAndVarWithNoReduceStddev">
        <Resource name="sql">
            <![CDATA[select name, stddev_pop(deptno), avg(deptno), var_pop(deptno)
from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[STDDEV_POP(_1)], EXPR_2=[AVG(_1)], EXPR_3=[VAR_POP(_1)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], EXPR_2=[CAST(/(_2, _3)):INTEGER NOT NULL], EXPR_3=[CAST(/(-(_4, /(*(_2, _2), _3)), _3)):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], EXPR_1=[STDDEV_POP(_1)], agg#1=[SUM(_1)], agg#2=[COUNT()], agg#3=[SUM(_2)])
    LogicalProject(NAME=[_0], DEPTNO=[_1], _f2=[*(_1, _1)])
      LogicalProject(NAME=[_1], DEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceAverageAndSumWithNoReduceStddevAndVar">
        <Resource name="sql">
            <![CDATA[select name, stddev_pop(deptno), avg(deptno), var_pop(deptno)
from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[STDDEV_POP(_1)], EXPR_2=[AVG(_1)], EXPR_3=[VAR_POP(_1)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[_1], EXPR_2=[CAST(/(_2, _3)):INTEGER NOT NULL], EXPR_3=[_4])
  LogicalAggregate(group=[{0}], EXPR_1=[STDDEV_POP(_1)], agg#1=[$SUM0(_1)], agg#2=[COUNT()], EXPR_3=[VAR_POP(_1)])
    LogicalProject(NAME=[_1], DEPTNO=[_0])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceAllAggregateFunctions">
        <Resource name="sql">
            <![CDATA[select name, stddev_pop(deptno), avg(deptno), stddev_samp(deptno), var_pop(deptno), var_samp(deptno)
from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{0}], EXPR_1=[STDDEV_POP(_1)], EXPR_2=[AVG(_1)], EXPR_3=[STDDEV_SAMP(_1)], EXPR_4=[VAR_POP(_1)], EXPR_5=[VAR_SAMP(_1)])
  LogicalProject(NAME=[_1], DEPTNO=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(NAME=[_0], EXPR_1=[CAST(POWER(/(-(_1, /(*(_2, _2), _3)), _3), 0.5:DECIMAL(2, 1))):INTEGER NOT NULL], EXPR_2=[CAST(/(_2, _3)):INTEGER NOT NULL], EXPR_3=[CAST(POWER(/(-(_1, /(*(_2, _2), _3)), CASE(=(_3, 1), null:BIGINT, -(_3, 1))), 0.5:DECIMAL(2, 1))):INTEGER NOT NULL], EXPR_4=[CAST(/(-(_1, /(*(_2, _2), _3)), _3)):INTEGER NOT NULL], EXPR_5=[CAST(/(-(_1, /(*(_2, _2), _3)), CASE(=(_3, 1), null:BIGINT, -(_3, 1)))):INTEGER NOT NULL])
  LogicalAggregate(group=[{0}], agg#0=[$SUM0(_2)], agg#1=[$SUM0(_1)], agg#2=[COUNT()])
    LogicalProject(NAME=[_0], DEPTNO=[_1], _f2=[*(_1, _1)])
      LogicalProject(NAME=[_1], DEPTNO=[_0])
        LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushProjectWithIsNotDistinctFromPastJoin">
        <Resource name="sql">
            <![CDATA[select e.sal + b.comm from emp e inner join bonus b
on (e.ename || e.job) IS NOT DISTINCT FROM (b.ename || b.job) and e.deptno = 10]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[+(_5, _13)])
  LogicalJoin(condition=[AND(IS NOT DISTINCT FROM(_9, _14), =(_7, 10))], joinType=[inner])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[||(_1, _2)])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(ENAME=[_0], JOB=[_1], SAL=[_2], COMM=[_3], _f4=[||(_0, _1)])
      LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[+(_0, _3)])
  LogicalJoin(condition=[AND(IS NOT DISTINCT FROM(_1, _4), _2)], joinType=[inner])
    LogicalProject(SAL=[_5], _f9=[_9], ==[=(_7, 10)])
      LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], _f9=[||(_1, _2)])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalProject(COMM=[_3], _f4=[_4])
      LogicalProject(ENAME=[_0], JOB=[_1], SAL=[_2], COMM=[_3], _f4=[||(_0, _1)])
        LogicalTableScan(table=[[CATALOG, SALES, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDynamicStarWithUnion">
        <Resource name="sql">
            <![CDATA[(select n_nationkey from SALES.CUSTOMER) union all (select n_name from CUSTOMER_MODIFIABLEVIEW)]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalUnion(all=[true])
  LogicalProject(N_NATIONKEY=[_0])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
  LogicalProject(N_NAME=[_1])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
EnumerableUnion(all=[true])
  EnumerableProject(N_NATIONKEY=[_0])
    EnumerableTableScan(table=[[CATALOG, SALES, CUSTOMER]])
  EnumerableProject(N_NAME=[_1])
    EnumerableTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testFilterAndProjectWithMultiJoin">
        <Resource name="sql">
            <![CDATA[select * from emp e1 left outer join dept d on e1.deptno = d.deptno where d.deptno > 3]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
MyProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10])
  MyFilter(condition=[>(_9, 3)])
    LogicalJoin(condition=[=(_7, _9)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
MultiJoin(joinFilter=[true], isFullOuterJoin=[false], joinTypes=[[INNER, LEFT]], outerJoinConditions=[[NULL, =(_7, _9)]], projFields=[[{0, 1, 2, 3, 4, 5, 6, 7, 8}, {0, 1}]], postJoinFilter=[>(_9, 3)])
  LogicalTableScan(table=[[CATALOG, SALES, EMP]])
  LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testWhereAnyCorrelatedInSelect">
        <Resource name="sql">
            <![CDATA[select * from emp where empno > ANY (
  select deptno from dept where emp.job = dept.name)
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[> SOME(_0, {
LogicalProject(DEPTNO=[_0])
  LogicalFilter(condition=[=(_cor0.JOB, _1)])
    LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
})], variablesSet=[[_cor0]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planMid">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
    LogicalFilter(condition=[OR(AND(IS TRUE(>(_0, _9)), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0)))), AND(IS TRUE(>(_10, _11)), null, IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9))), AND(>(_0, _9), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9)), IS NOT TRUE(>(_10, _11))))])
      LogicalCorrelate(correlation=[_cor0], joinType=[left], requiredColumns=[{2}])
        LogicalTableScan(table=[[CATALOG, SALES, EMP]])
        LogicalProject(m=[_0], c=[_1], d=[_2], trueLiteral=[true])
          LogicalAggregate(group=[{}], m=[MIN(_0)], c=[COUNT()], d=[COUNT(_0)])
            LogicalProject(DEPTNO=[_0])
              LogicalFilter(condition=[=(_cor0.JOB, _1)])
                LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8])
  LogicalFilter(condition=[OR(AND(>(_0, _9), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0)))), AND(>(_0, _9), IS NOT TRUE(OR(IS NULL(_12), =(_10, 0))), IS NOT TRUE(>(_0, _9)), IS NOT TRUE(>(_10, _11))))])
    LogicalJoin(condition=[=(_2, _13)], joinType=[left])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalProject(m=[_1], c=[_2], d=[_3], trueLiteral=[true], NAME=[_0])
        LogicalAggregate(group=[{0}], m=[MIN(_1)], c=[COUNT()], d=[COUNT(_1)])
          LogicalProject(NAME=[_1], DEPTNO=[_0])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFiltertWithIsNotDistinctFromPastJoin">
        <Resource name="sql">
            <![CDATA[SELECT * FROM emp t1 INNER JOIN emp t2 ON t1.deptno = t2.deptno WHERE t1.ename is not distinct from t2.ename]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], EMPNO0=[_9], ENAME0=[_10], JOB0=[_11], MGR0=[_12], HIREDATE0=[_13], SAL0=[_14], COMM0=[_15], DEPTNO0=[_16], SLACKER0=[_17])
  LogicalFilter(condition=[OR(AND(IS NULL(_1), IS NULL(_10)), IS TRUE(=(_1, _10)))])
    LogicalJoin(condition=[=(_7, _16)], joinType=[inner])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], EMPNO0=[_9], ENAME0=[_10], JOB0=[_11], MGR0=[_12], HIREDATE0=[_13], SAL0=[_14], COMM0=[_15], DEPTNO0=[_16], SLACKER0=[_17])
  LogicalJoin(condition=[AND(=(_7, _16), IS NOT DISTINCT FROM(_1, _10))], joinType=[inner])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinToMultiJoinDoesNotMatchSemiJoin">
        <Resource name="sql">
            <![CDATA[select * from
(select * from emp join dept ON emp.deptno = emp.deptno) t
where emp.job in (select job from bonus))]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalJoin(condition=[=(_2, _12)], joinType=[semi])
  MultiJoin(joinFilter=[=(_7, _8)], isFullOuterJoin=[false], joinTypes=[[INNER, INNER]], outerJoinConditions=[[NULL, NULL]], projFields=[[ALL, ALL]])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalTableScan(table=[[scott, DEPT]])
  LogicalTableScan(table=[[scott, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testJoinToMultiJoinDoesNotMatchAntiJoin">
        <Resource name="sql">
            <![CDATA[select * from
(select * from emp join dept ON emp.deptno = emp.deptno) t
where not exists (select job from bonus where emp.job = bonus.job)]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalJoin(condition=[=(_2, _12)], joinType=[anti])
  MultiJoin(joinFilter=[=(_7, _8)], isFullOuterJoin=[false], joinTypes=[[INNER, INNER]], outerJoinConditions=[[NULL, NULL]], projFields=[[ALL, ALL]])
    LogicalTableScan(table=[[scott, EMP]])
    LogicalTableScan(table=[[scott, DEPT]])
  LogicalTableScan(table=[[scott, BONUS]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testDecorrelationWithSort">
        <Resource name="sql">
            <![CDATA[SELECT e1.empno
FROM emp e1, dept d1 where e1.deptno = d1.deptno
and e1.deptno < 10 and d1.deptno < 15
and e1.sal > (select avg(sal) from emp e2 where e1.empno = e2.empno)
order by e1.empno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC])
  LogicalProject(EMPNO=[_0])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10], EMPNO0=[CAST(_11):INTEGER], EXPR_0=[CAST(_12):INTEGER])
      LogicalJoin(condition=[AND(=(_0, _11), >(_5, _12))], joinType=[inner])
        LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
          LogicalFilter(condition=[<(_7, 10)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalFilter(condition=[<(_0, 15)])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0}], EXPR_0=[AVG(_1)])
          LogicalProject(EMPNO=[_0], SAL=[_5])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalSort(sort0=[_0], dir0=[ASC])
  LogicalProject(EMPNO=[_0])
    LogicalProject(EMPNO=[_0], ENAME=[_1], JOB=[_2], MGR=[_3], HIREDATE=[_4], SAL=[_5], COMM=[_6], DEPTNO=[_7], SLACKER=[_8], DEPTNO0=[_9], NAME=[_10], EMPNO0=[CAST(_11):INTEGER], EXPR_0=[CAST(_12):INTEGER])
      LogicalJoin(condition=[AND(=(_0, _11), >(_5, _12))], joinType=[inner])
        LogicalJoin(condition=[=(_7, _9)], joinType=[inner])
          LogicalFilter(condition=[<(_7, 10)])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
          LogicalFilter(condition=[<(_0, 15)])
            LogicalTableScan(table=[[CATALOG, SALES, DEPT]])
        LogicalAggregate(group=[{0}], EXPR_0=[AVG(_1)])
          LogicalProject(EMPNO=[_0], SAL=[_5])
            LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceDecimal">
        <Resource name="sql">
            <![CDATA[select ename from emp where sal > cast (100.0 as decimal(4, 1))]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalFilter(condition=[>(_5, 100.0:DECIMAL(4, 1))])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(ENAME=[_1])
  LogicalCalc(expr#0..8=[{inputs}], expr#9=[10:BIGINT], expr#10=[*(_t5, _t9)], expr#11=[100.0:DECIMAL(4, 1)], expr#12=[Reinterpret(_t11)], expr#13=[>(_t10, _t12)], proj#0..8=[{exprs}], _condition=[_t13])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testEnumerableCalcRule">
        <Resource name="sql">
            <![CDATA[select ename from emp where sal > 10.0]]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(FNAME=[_1], LNAME=[_2])
  LogicalFilter(condition=[>(_0, 10)])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
EnumerableProject(FNAME=[_1], LNAME=[_2])
  EnumerableCalc(expr#0..2=[{inputs}], expr#3=[10], expr#4=[>(_t0, _t3)], proj#0..2=[{exprs}], _condition=[_t4])
    EnumerableTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMaxReuseDistinctAttrWithMixedOptionality">
        <Resource name="sql">
            <![CDATA[select sum(distinct deptno), count(distinct deptno), max(deptno) from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(DISTINCT _0)], EXPR_1=[COUNT(DISTINCT _0)], EXPR_2=[MAX(_0)])
  LogicalProject(DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)], EXPR_1=[COUNT(_0)], EXPR_2=[MAX(_0)])
  LogicalAggregate(group=[{0}])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testMinReuseDistinctAttrWithMixedOptionality">
        <Resource name="sql">
            <![CDATA[select sum(distinct deptno), count(distinct deptno), min(deptno) from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(DISTINCT _0)], EXPR_1=[COUNT(DISTINCT _0)], EXPR_2=[MIN(_0)])
  LogicalProject(DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)], EXPR_1=[COUNT(_0)], EXPR_2=[MIN(_0)])
  LogicalAggregate(group=[{0}])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testBitAndReuseDistinctAttrWithMixedOptionality">
        <Resource name="sql">
            <![CDATA[select sum(distinct deptno), count(distinct deptno), bit_and(deptno) from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(DISTINCT _0)], EXPR_1=[COUNT(DISTINCT _0)], EXPR_2=[BIT_AND(_0)])
  LogicalProject(DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)], EXPR_1=[COUNT(_0)], EXPR_2=[BIT_AND(_0)])
  LogicalAggregate(group=[{0}])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testBitOrReuseDistinctAttrWithMixedOptionality">
        <Resource name="sql">
            <![CDATA[select sum(distinct deptno), count(distinct deptno), bit_or(deptno) from emp]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(DISTINCT _0)], EXPR_1=[COUNT(DISTINCT _0)], EXPR_2=[BIT_OR(_0)])
  LogicalProject(DEPTNO=[_7])
    LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalAggregate(group=[{}], EXPR_0=[SUM(_0)], EXPR_1=[COUNT(_0)], EXPR_2=[BIT_OR(_0)])
  LogicalAggregate(group=[{0}])
    LogicalProject(DEPTNO=[_7])
      LogicalTableScan(table=[[CATALOG, SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testProjectJoinTransposeItem">
        <Resource name="sql">
            <![CDATA[select t1.c_nationkey[0], t2.c_nationkey[0] from sales.customer as t1 left outer join sales.customer as t2 on t1.c_nationkey[0] = t2.c_nationkey[0]]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(EXPR_0=[ITEM(_0, 0)], EXPR_1=[ITEM(_2, 0)])
  LogicalJoin(condition=[=(_1, _3)], joinType=[left])
    LogicalProject(C_NATIONKEY=[_0], _f1=[ITEM(_0, 0)])
      LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
    LogicalProject(C_NATIONKEY=[_0], _f1=[ITEM(_0, 0)])
      LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
LogicalProject(EXPR_0=[_1], EXPR_1=[_3])
  LogicalJoin(condition=[=(_0, _2)], joinType=[left])
    LogicalProject(_f1=[_1], ITEM=[ITEM(_0, 0)])
      LogicalProject(C_NATIONKEY=[_0], _f1=[ITEM(_0, 0)])
        LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
    LogicalProject(_f1=[_1], ITEM=[ITEM(_0, 0)])
      LogicalProject(C_NATIONKEY=[_0], _f1=[ITEM(_0, 0)])
        LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSimplifyItemIsNotNull">
        <Resource name="sql">
            <![CDATA[select * from sales.customer as t1 where t1.c_nationkey[0] is not null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(**=[_1])
  LogicalFilter(condition=[IS NOT NULL(ITEM(_0, 0))])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testSimplifyItemIsNull">
        <Resource name="sql">
            <![CDATA[select * from sales.customer as t1 where t1.c_nationkey[0] is null]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
LogicalProject(**=[_1])
  LogicalFilter(condition=[IS NULL(ITEM(_0, 0))])
    LogicalTableScan(table=[[CATALOG, SALES, CUSTOMER]])
]]>
        </Resource>
    </TestCase>
</Root>
